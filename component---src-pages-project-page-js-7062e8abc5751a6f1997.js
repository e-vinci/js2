"use strict";(self.webpackChunkmyjscourse=self.webpackChunkmyjscourse||[]).push([[5204],{2248:function(e,t,n){var r=n(6540),a=n(6067),c=n.n(a);t.A=e=>{let{className:t,isBeingEdited:n,onChange:a,startContent:o,id:i,isInline:s,children:d}=e;let l,u;return n?l=o?c().decode(o):"":d?l=d:o&&(l=o?c().decode(o):""),u=t||"",n&&(u+=" index__card__content__description--is-being-edited"),s&&(u+=" index__card__content__description--is-inline"),r.createElement("div",{className:u,contentEditable:!!n,onInput:e=>{const t={};t[i]=e.currentTarget.textContent,a(t)},suppressContentEditableWarning:!0},l)}},8604:function(e,t,n){n.d(t,{B:function(){return d},z:function(){return s}});var r=n(6540),a=n(6845),c=n(1262),o=n(3787);const i=r.createContext([{},()=>{},{},()=>{},{},()=>{},{},()=>{}]),s=e=>{let{children:t}=e;const{0:n,1:a}=(0,r.useState)(void 0),{0:c,1:o}=(0,r.useState)(void 0),{0:s,1:d}=(0,r.useState)(void 0),{0:l,1:u}=(0,r.useState)(!1);return r.createElement(i.Provider,{value:[n,a,c,o,s,d,l,u]},t)},d=()=>{const{instance:e,accounts:t}=(0,c.dk)(),{0:n,1:s,2:d,3:l,4:u,5:m,6:_,7:p}=(0,r.useContext)(i);return{projectGroupData:n,updateProjectGroupData:async n=>{try{const r=await(0,o.J)(t,e),c=await(0,a.A)(`projectgroups/${n}`,"get",r,void 0);return s(c),c}catch(r){console.error("useProjectData:error:",r)}},userData:d,updateUserData:async n=>{try{const r=await(0,o.J)(t,e),c=await(0,a.A)(`users/role/?projectgroupname=${n}`,"get",r,void 0);return l(c),c}catch(r){console.error("useProjectData:updateUserData:error:",r)}},projectData:u,updateProjectData:async n=>{try{const r=await(0,o.J)(t,e);p(!1);let c=await(0,a.A)("projects/projectgroups/"+n,"get",r,void 0);return m(c),p(!0),c}catch(r){console.error("useProjectData:updateProjectDataerror:",r)}},addOneProject:async n=>{try{const r=await(0,o.J)(t,e);return await(0,a.A)("projects","post",r,{projectGroupName:n})}catch(r){console.error("useProjectData:addOneProject:error:",r)}},deleteOneProject:async n=>{try{const r=await(0,o.J)(t,e);return await(0,a.A)("projects/"+n._id,"DELETE",r,void 0)}catch(r){console.error("useProjectData:deleteOneProject:error:",r)}},addMemberToProject:async n=>{try{const r=await(0,o.J)(t,e);return await(0,a.A)("projects/"+n._id+"/member","POST",r,void 0)}catch(r){console.error("useProjectData:addMemberToProject:error:",r)}},deleteMemberFromProject:async n=>{try{const r=await(0,o.J)(t,e);return await(0,a.A)("projects/"+n._id+"/member","DELETE",r,void 0)}catch(r){console.error("useProjectData:deleteMemberFromProject:error:",r)}},updateProject:async(n,r)=>{try{const c=await(0,o.J)(t,e);return await(0,a.A)("projects/"+r,"PATCH",c,n)}catch(c){console.error("useProjectData:updateProject:error:",c)}},isLoaded:_,setIsLoaded:p}}},4698:function(e,t,n){var r=n(6540),a=n(4810);t.A=e=>{let{children:t,name:n,...c}=e;const o=(0,a.useStaticQuery)("3028011774");if(n&&n.toLowerCase().includes("http://")||n&&n.toLowerCase().includes("https://"))return r.createElement("a",Object.assign({href:n},c),t);const i=o.allFile.edges.find((e=>e.node.base===n));return i?r.createElement("a",Object.assign({href:i.node.publicURL},c),t):r.createElement("div",null,r.createElement("h3",{style:{color:"red"}},"The file ",n," does not exist !"),t)}},1838:function(e,t,n){var r=n(6540),a=n(6784),c=n(2630);t.A=()=>r.createElement("div",{className:"spinner"},r.createElement("div",{className:"spinner__overlay"}),r.createElement("div",{className:"spinner__animation"},r.createElement(a.g,{icon:c.z1G,className:"fa-3x fa-spin"})))},4617:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var r=n(6540),a=n(4810),c=n(2662),o=n(3528),i=n(8604),s=n(4902),d=(n(6067),n(6784)),l=n(2630),u=n(4781),m=n(2248);var _=e=>{let{project:t,setFilteredContents:n}=e;const{0:a,1:c}=(0,r.useState)(!1),{0:o,1:_}=(0,r.useState)(t.isPublic),{0:p,1:E}=(0,r.useState)({}),{deleteOneProject:j,updateProjectData:v,addMemberToProject:h,deleteMemberFromProject:g,updateProject:f,userData:b,projectGroupData:w,projectData:C}=(0,i.B)(),N=e=>{E((t=>({...t,...e})))};return t?r.createElement("div",{className:"index__card"+(a?" index__card--is-being-edited":""),key:t.shortId,id:t.shortId},r.createElement("div",{className:"index__card__header"},r.createElement("span",null,"Projet N° "+t.shortId+" : "),r.createElement(m.A,{isBeingEdited:a,id:"name",onChange:N,startContent:t.name,isInline:!0})),r.createElement("div",{className:"index__card__description"},b.isAdmin&&r.createElement(d.g,{icon:l.BeE,onClick:async()=>{await j(t),await v(t.projectGroupName),n(void 0)}}),(b.isAdmin||t.projectMembers.includes(b.userName)&&"end"!==w.status)&&!a?r.createElement(d.g,{icon:l.MT7,onClick:()=>{c(!0)}}):"","init"===w.status&&!C.find((e=>e.projectMembers.includes(b.userName)))&&t.projectMembers.length<w.maximumProjectMembers&&r.createElement(d.g,{icon:l.nWR,onClick:async()=>{await h(t);v&&(await v(t.projectGroupName),n(void 0))}}),"init"===w.status&&t.projectMembers.includes(b.userName)&&r.createElement(d.g,{icon:l.XK8,onClick:async()=>{await g(t);v&&(await v(t.projectGroupName),n(void 0))}}),a&&r.createElement(d.g,{icon:l.hSh,onClick:async()=>{if(p){const e=await f(p,t._id);E({}),c(!1),e&&(await v(t.projectGroupName),n(void 0))}}}),a&&r.createElement(d.g,{icon:l.GRI,onClick:()=>{c(!1),E({})}})),r.createElement("div",{className:"index__card__content"},void 0!==t.description?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Description"),r.createElement(m.A,{className:"index__card__content__description",isBeingEdited:a,id:"description",startContent:t.description,onChange:N})):""),r.createElement("div",{className:"index__card__content"},void 0!==t.presentationUrl?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Vidéo de présentation"),r.createElement(m.A,{className:"index__card__content__description",isBeingEdited:a,id:"presentationUrl",startContent:t.presentationUrl,onChange:N},r.createElement(s.A,{src:t.presentationUrl}))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.frontendProductionUrl?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"URL du site"),r.createElement(m.A,{className:"index__card__content__description",isBeingEdited:a,id:"frontendProductionUrl",startContent:t.frontendProductionUrl,onChange:N},r.createElement("a",{href:t.frontendProductionUrl,target:"_blank"},t.frontendProductionUrl))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.frontendRepo?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Repo frontend"),r.createElement(m.A,{className:"index__card__content__description",isBeingEdited:a,id:"frontendRepo",startContent:t.frontendRepo,onChange:N},r.createElement("a",{href:t.frontendRepo,target:"_blank"},t.frontendRepo))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.backendRepo?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Repo backend"),r.createElement(m.A,{className:"index__card__content__description",isBeingEdited:a,id:"backendRepo",startContent:t.backendRepo,onChange:N},r.createElement("a",{href:t.backendRepo,target:"_blank"},t.backendRepo))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.projectMembers&&t.projectMembers.length>0?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Membres du projet"),r.createElement("div",{className:"index__card__content__description"},t.projectMembers.map((e=>(0,u.J)(e))).join(", "))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.isPublic?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Public ?"),r.createElement("div",{className:"index__card__content__description"},r.createElement("input",{type:"checkbox",checked:o,disabled:!a,onClick:e=>{_(!o),E({...p,isPublic:!o})}}))):"")):null};var p=e=>{let{projects:t,setFilteredContents:n}=e;return!t||t.length<=0?null:r.createElement(r.Fragment,null,t.map((e=>r.createElement(_,{project:e,setFilteredContents:n}))))},E=n(1838),j=n(4698);var v=e=>{let{associatedProjectGroupName:t,projectDocument:n}=e;const{projectGroupData:a,updateProjectGroupData:c,userData:o,updateUserData:s,isLoaded:d,projectData:l,addOneProject:u,updateProjectData:m}=(0,i.B)(),{0:_,1:v}=(0,r.useState)(void 0),{0:h,1:g}=(0,r.useState)("");(0,r.useEffect)((()=>{f()}),[]);const f=async()=>{try{const e=await c(t);await s(t),await m(e._id)}catch(e){console.error("getData:error",e)}};return r.createElement(r.Fragment,null,!d&&r.createElement(E.A,null),void 0===a?"":r.createElement("div",{className:"pl-3 pt-3 pb-3 pr-3"},r.createElement("h3",{className:""},"Projets des groupes de ",null==a?void 0:a._id),n&&r.createElement(j.A,{name:n},"Consignes & template du projet"),r.createElement("div",{className:"index"},r.createElement("input",{type:"text","aria-label":"Search",placeholder:"Filtrez les contenus...",onChange:e=>{const t=e.target.value;g(e.target.value);const n=l.filter((e=>{const{shortId:n,name:r,description:a}=e;return r.toLowerCase().includes(t.toLowerCase())||a.toLowerCase().includes(t.toLowerCase())||t.length>0&&parseInt(t)===n}));n&&n.length>0?v(n):v(void 0)},className:"index__search"}),_&&_.length>0?r.createElement(p,{projects:_,setFilteredContents:v}):r.createElement(p,{projects:l,setFilteredContents:v})),void 0!==o&&o.isAdmin?r.createElement("button",{className:"index__button",onClick:async()=>{await u(a._id);await m(a._id);v(void 0)}},"Ajouter projet"):""))};var h=(0,o.Z)((()=>{const e=(0,a.useStaticQuery)("641954533"),{defaultAssociatedProjectGroupName:t,projectDocument:n}=null==e?void 0:e.site.siteMetadata;return r.createElement(i.z,null,r.createElement(c.A,null,r.createElement(v,{associatedProjectGroupName:t,projectDocument:n})))}))},6845:function(e,t,n){async function r(e,t,n,r){void 0===t&&(t="get");let a=new Headers,c={};if(c.method=t,n){const e=`Bearer ${n}`;a.append("Authorization",e)}r&&(c.body=JSON.stringify(r)),"post"!==t.toLowerCase()&&"patch"!==t.toLowerCase()&&"put"!==t.toLowerCase()||a.append("Content-Type","application/json"),c.headers=a;const o="https://e-vinci-course-api.azurewebsites.net/api/"+e;try{const e=await fetch(o,c);if(!e.ok){let t=" Error code : "+e.status+" : "+e.statusText+"/nMessage : ";throw t+=await e.text(),console.error("fetch() error",t),t.search("expired"),new Error(t)}return await e.json()}catch(i){throw i}}n.d(t,{A:function(){return r}})},3787:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(6097);async function a(e,t){if(e.length>0){const a={scopes:["openid"],account:e[0]};try{return(await t.acquireTokenSilent(a)).idToken}catch(n){if(n instanceof r.CB){return(await t.acquireTokenRedirect(a)).idToken}}}}},4781:function(e,t,n){n.d(t,{J:function(){return r}});const r=e=>{let t=e.substring(0,e.indexOf("@")),n=t.substring(0,t.indexOf(".")),r=t.substring(t.indexOf(".")+1);return n=n.charAt(0).toUpperCase()+n.slice(1),r=r.charAt(0).toUpperCase()+r.slice(1),r.indexOf(".")>=0&&(r=r.substring(r.indexOf(".")+1),r=r.charAt(0).toUpperCase()+r.slice(1)),n+" "+r}}}]);
//# sourceMappingURL=component---src-pages-project-page-js-7062e8abc5751a6f1997.js.map