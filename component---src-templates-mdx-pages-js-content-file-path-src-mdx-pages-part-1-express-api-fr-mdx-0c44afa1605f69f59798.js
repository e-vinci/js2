"use strict";(self.webpackChunkmyjscourse=self.webpackChunkmyjscourse||[]).push([[3162],{2768:function(e,n,t){t.r(n),t.d(n,{default:function(){return I}});var l=t(5680),r=t(6540);function a(e){const n=Object.assign({h1:"h1",h2:"h2",p:"p",strong:"strong",br:"br",ul:"ul",li:"li",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",code:"code",a:"a",pre:"pre",h4:"h4"},(0,l.RP)(),e.components),{InternalPageMenu:t,PathViewer:a,PathViewerItem:u,InternalPageMenuItem:s,InternalPageTitle:c,YoutubeImage:i,ScrollableImage:d}=n;return t||o("InternalPageMenu",!0),s||o("InternalPageMenuItem",!0),c||o("InternalPageTitle",!0),a||o("PathViewer",!0),u||o("PathViewerItem",!0),d||o("ScrollableImage",!0),i||o("YoutubeImage",!0),r.createElement(r.Fragment,null,r.createElement(n.h1,null,"a) Introduction aux RESTful API"),"\n",r.createElement(t,null,r.createElement(a,null,r.createElement(u,{to:"/"}," web2course "),r.createElement(u,{to:"/part1"}," Partie 1 "),r.createElement(u,{selected:!0}," a) RESTful API ")),r.createElement(s,null," Introduction aux RESTful API & conventions "),r.createElement(s,null," D√©marrage d'une RESTful API en Express & TS "),r.createElement(s,null," Les fonctions middleware en Express "),r.createElement(s,null," D√©finition d'une route en Express "),r.createElement(s,null," Op√©rations de lecture "),r.createElement(s,null," Exercice 1.1 : lecture de toutes les ressources "),r.createElement(s,null," Exercice 1.2 : middleware s'ex√©cutant sur toutes les routes "),r.createElement(s,null," Utilisation du linter et du formatter pour TS "),r.createElement(s,null," Param√®tres de route "),r.createElement(s,null," Param√®tres de requ√™te "),r.createElement(s,null," Op√©ration de cr√©ation & parsing du body "),r.createElement(s,null," Client REST "),r.createElement(s,null," Utilisation du debugger"),r.createElement(s,null," Exercice 1.3 : lectures sp√©cifiques, cr√©ation & REST Client "),r.createElement(s,null," üç¨ Exercice 1.4 : Gestion de la pagination, du tri et du filtrage "),r.createElement(s,null," Codes de statut HTTP associ√©s aux r√©ponses "),r.createElement(s,null," Exercice 1.5 : codes de statut HTTP "),r.createElement(s,null," Op√©rations de suppression & de modification "),r.createElement(s,null," Exercice 1.6 : suppression & modification de ressources ")),"\n",r.createElement(n.h1,null,r.createElement(c,null," Introduction aux RESTful API & conventions ")),"\n",r.createElement(n.h2,null,"C'est quoi une application REST ?"),"\n",r.createElement("div",{className:"card card__simple-youtube-container"},r.createElement(i,{src:"https://youtu.be/EIESrlEV-CQ"})),"\n",r.createElement(n.p,null,r.createElement(n.strong,null,"REST")," vient de ",r.createElement(n.strong,null,"RE"),"presentational ",r.createElement(n.strong,null,"S"),"tate ",r.createElement(n.strong,null,"T"),"ransfer : c'est un style architectural pour construire des applications web extensibles, o√π les client et serveurs sont s√©par√©s."),"\n",r.createElement(n.p,null,"Dans une application REST, une ",r.createElement(n.strong,null,"interface uniforme")," (ou API) est d√©finie afin de permettre √† des applications de coop√©rer."),"\n",r.createElement(n.p,null,"Toute application REST se doit d'√™tre ",r.createElement(n.strong,null,"stateless")," : il n'y a pas d'enregistrement du contexte d'une session sur le serveur pour comprendre une requ√™te d'un client.",r.createElement(n.br),"\n","Ainsi, les requ√™tes clientes ne d√©pendent pas d'un historique de requ√™tes, chaque requ√™te contient tout l'information n√©cessaire au serveur."),"\n",r.createElement(n.p,null,"Une RESTful API met √† disposition des ",r.createElement(n.strong,null,"op√©rations")," sur des ",r.createElement(n.strong,null,"ressources")," via :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"des ",r.createElement(n.strong,null,"URI")," ; il y a donc une adresse unique pur chaque ressource ;"),"\n",r.createElement(n.li,null,"des ",r.createElement(n.strong,null,"m√©thodes HTTP")," (GET, POST, DELETE, PATCH, PUT) repr√©sentant les op√©rations possibles ; on parle souvent d'op√©rations ",r.createElement(n.strong,null,"CRUD"),", des op√©rations de type ",r.createElement(n.strong,null,"C"),"reate, ",r.createElement(n.strong,null,"R"),"ead, ",r.createElement(n.strong,null,"U"),"pdate ou ",r.createElement(n.strong,null,"D"),"elete) ;"),"\n",r.createElement(n.li,null,"des ",r.createElement(n.strong,null,"repr√©sentations"),' des ressources compr√©hensibles tant par les clients que les serveurs ; les ressources sont repr√©sent√©es par leur "Media type" : ',r.createElement(n.strong,null,"JSON"),", ",r.createElement(n.strong,null,"XML"),", ",r.createElement(n.strong,null,"HTML"),", ",r.createElement(n.strong,null,"TXT"),", ",r.createElement(n.strong,null,"JPEG"),"... ; dans le cadre de ce cours, les ressources seront quasi toujours repr√©sent√©es via du ",r.createElement(n.strong,null,"JSON"),"."),"\n"),"\n",r.createElement(n.h2,null,"Conventions REST"),"\n",r.createElement(n.p,null,"Le type d'op√©ration CRUD sur une ressource est d√©fini via la ",r.createElement(n.strong,null,"m√©thode http")," de la requ√™te.",r.createElement(n.br),"\n","Les op√©rations possibles sont :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"GET = Read"),"\n",r.createElement(n.li,null,"POST = Create"),"\n",r.createElement(n.li,null,"DELETE = Delete üòâ"),"\n",r.createElement(n.li,null,"PATCH / PUT = Update","\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"PATCH = Update d'une ou plusieurs propri√©t√©(s) de la ressources"),"\n",r.createElement(n.li,null,"PUT = Update de toutes les propri√©t√©s de la ressources, ou cr√©ation si la ressource n'existe pas"),"\n"),"\n"),"\n"),"\n",r.createElement(n.p,null,"Voici un exemple d'application de ces conventions REST dans le cadre d'une RESTful API permettant de g√©rer des ",r.createElement(n.strong,null,"posts")," :"),"\n",r.createElement(n.table,null,r.createElement(n.thead,null,r.createElement(n.tr,null,r.createElement(n.th,null,"URI"),r.createElement(n.th,null,"M√©thode HTTP"),r.createElement(n.th,null,"Op√©ration"))),r.createElement(n.tbody,null,r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"posts"))),r.createElement(n.td,null,"GET"),r.createElement(n.td,null,"READ ALL : Lire toutes les ressources de la collection")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"posts?userId=value"))),r.createElement(n.td,null,"GET"),r.createElement(n.td,null,"READ ALL FILTERED : Lire toutes les ressources de la collection selon le filtre donn√©")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"posts/{id}"))),r.createElement(n.td,null,"GET"),r.createElement(n.td,null,"READ ONE : Lire la ressource identifi√©e")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"posts"))),r.createElement(n.td,null,"POST"),r.createElement(n.td,null,"CREATE ONE : Cr√©er une ressource bas√©e sur les donn√©es de la requ√™te")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"posts/{id}"))),r.createElement(n.td,null,"DELETE"),r.createElement(n.td,null,"DELETE ONE : Effacer la ressource identifi√©e")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"posts/{id}"))),r.createElement(n.td,null,"PUT"),r.createElement(n.td,null,"UPDATE ONE : Remplacer l'enti√®ret√© de la ressource par les donn√©es de la requ√™te")))),"\n",r.createElement("br"),"\n",r.createElement(n.p,null,"Lors de l'ajout d'un post, si cette API est h√©berg√©e √† l'URL racine ",r.createElement(n.strong,null,r.createElement(n.a,{href:"https://jsonplaceholder.typicode.com/"},"https://jsonplaceholder.typicode.com/")),", alors nous pourrions identifier une ressource de type ",r.createElement(n.strong,null,"posts")," de cette fa√ßon : ",r.createElement(n.strong,null,r.createElement(n.a,{href:"https://jsonplaceholder.typicode.com/posts/10"},"https://jsonplaceholder.typicode.com/posts/10")),"."),"\n",r.createElement(n.p,null,"Pour lire cette ressource, il faudrait faire une requ√™te http de type ",r.createElement(n.strong,null,"GET")," sur cette ",r.createElement(n.strong,null,"URL")," : ",r.createElement(n.strong,null,r.createElement(n.a,{href:"https://jsonplaceholder.typicode.com/posts/10"},"https://jsonplaceholder.typicode.com/posts/10")),"."),"\n",r.createElement(n.h1,null,r.createElement(c,null," D√©marrage d'une RESTful API en Express & TS  ")),"\n",r.createElement(n.h2,null,"Cr√©ation d'un projet √† partir d'un boilerplate"),"\n",r.createElement(n.p,null,'Nous allons maintenant d√©couvrir notre toute premi√®re RESTful API permettant de g√©rer les donn√©es associ√©es √† une pizzeria, afin de b√©n√©ficier d\'op√©rations sur des ressources de type "pizzas" et de type "drinks".'),"\n",r.createElement(n.p,null,"Dans votre repo ",r.createElement(n.strong,null,"web2"),", veuillez cr√©er le r√©pertoire ",r.createElement(n.strong,null,r.createElement(n.code,null,"/tutorials/back/api")),"."),"\n",r.createElement(n.p,null,"Veuillez ouvrir un terminal au niveau de ce r√©pertoire."),"\n",r.createElement(n.p,null,"Dans ce r√©pertoire, veuillez g√©n√©rer une application express nomm√©e ",r.createElement(n.strong,null,"basic")," sur base du boilerplate : ",r.createElement(n.a,{href:"https://github.com/e-vinci/basic-ts-api-boilerplate"},"basic-ts-api-boilerplate")," ",r.createElement(n.a,{href:"/js2/references/#r51"},"[R.51]"),".",r.createElement(n.br),"\n","Pour ce faire :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"git clone https://github.com/e-vinci/basic-ts-api-boilerplate basic\n")),"\n",r.createElement(n.p,null,"Veuillez installer les d√©pendances :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"cd basic\r\nnpm i\n")),"\n",r.createElement(n.p,null,"‚ö° Comme vous avez fait un clone du boilerplate, attention au Git dans le Git, n'oubliez pas de supprimer le dossier ",r.createElement(n.strong,null,r.createElement(n.code,null,".git"))," pr√©sent dans votre nouveau projet."),"\n",r.createElement(n.p,null,"Veuillez jeter un oeil √† la structure du projet ",r.createElement(n.strong,null,r.createElement(n.code,null,"basic")),"."),"\n",r.createElement(n.p,null,"Nous d√©veloppons des RESTful API qui ne poss√®dent pas de serveur de fichiers statiques.",r.createElement(n.br),"\n","On n'a donc pas besoin d'avoir un r√©pertoire ",r.createElement(n.strong,null,r.createElement(n.code,null,"/public"))," ni d'un serveur statique (",r.createElement(n.code,null,"express.static"),")."),"\n",r.createElement(n.h2,null,"Fonctionnement d'une application Express"),"\n",r.createElement(n.p,null,"Nous allons maintenant nous attarder √† comprendre les concepts associ√©s √† l'utilisation d'Express, mais en focalisant sur ceux utiles aux applications REST.",r.createElement(n.br),"\n","Voici comment une requ√™te faite √† une application Express est trait√©e :"),"\n",r.createElement(d,{name:"express-flow.png",minWidth:"800px",maxWidth:"800px"}),"\n",r.createElement("figcaption",null,"Flux d'une requ√™te vers une application Express [R.51]"),"\n",r.createElement(n.p,null,"Dans ce flux de traitement d'une requ√™te, la responsabilit√© des d√©veloppeurs est de s'occuper de la partie \"Middleware\"."),"\n",r.createElement(n.p,null,'La grande majorit√© du code √©crit sera du "routing middleware" : notre code s\'occupera de r√©pondre √† des requ√™tes clientes pour diff√©rentes URLs et m√©thodes HTTP (GET, POST...).'),"\n",r.createElement(n.p,null,"On l'a d√©j√† vu, la configuration d'une application Express, comme toutes applications Node.js, est faite au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"package.json")),"."),"\n",r.createElement(n.p,null,"En fonction de comment est configur√© l'application, on la d√©marrera via ",r.createElement(n.strong,null,r.createElement(n.code,null,"npm start")),", ",r.createElement(n.strong,null,r.createElement(n.code,null,"npm run dev")),", ",r.createElement(n.strong,null,r.createElement(n.code,null,"npm run build")),"..."),"\n",r.createElement(n.p,null,"Un ",r.createElement(n.strong,null,"serveur web int√©gr√©")," √† nos applications Express est d√©marr√© au sein du fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,"bin/www.ts")),"."),"\n",r.createElement(n.p,null,"C'est ce fichier que vous devez mettre √† jour si par exemple vous souhaitez que votre application fonctionne sur un port diff√©rent que le port par d√©faut ",r.createElement(n.strong,null,r.createElement(n.code,null,"3000")),"."),"\n",r.createElement(n.p,null,"Un serveur int√©gr√© est diff√©rent d'une application web offerte par un serveur standalone comme Apache, Tomcat... C'est un serveur tr√®s l√©ger d√©di√© √† votre application."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Les fonctions middleware en Express ")),"\n",r.createElement(n.h2,null,"C'est quoi une fonction middleware ?"),"\n",r.createElement(n.p,null,"Les fonctions middleware s'occupent du traitement des requ√™tes des clients et de la pr√©paration des r√©ponses :"),"\n",r.createElement(d,{name:"middlewares.jpg",minWidth:"638px",maxWidth:"638px"}),"\n",r.createElement("figcaption",null,"Les fonctions Middleware et Express [R.52]"),"\n",r.createElement(n.p,null,"Une fonction middleware a acc√®s aux objets de la requ√™te et de la r√©ponse et peut utiliser la requ√™te et la r√©ponse pour ajouter, par exemple, un log, pour autoriser un utilisateur, pour parser des donn√©es Json vers des objets TS/JS, pour servir des fichiers statiques, pour faire un traitement pour une route bien sp√©cifique..."),"\n",r.createElement(n.p,null,"Par exemple, lors d'une op√©ration d'ajout d'une pizza, si une fonction middleware ne termine pas le cycle de requ√™te-r√©ponse, elle doit appeler ",r.createElement(n.strong,null,r.createElement(n.code,null,"next()"))," pour permettre √† d'autres fonctions qui sont dans la queue de pouvoir √™tre ex√©cut√©es."),"\n",r.createElement(n.p,null,"Voici les √©l√©ments associ√©s √† l'appel d'une fonction middleware :"),"\n",r.createElement(d,{name:"middleware-function.png",minWidth:"944px",maxWidth:"944px"}),"\n",r.createElement("figcaption",null,"Une fonction middleware [R.53]"),"\n",r.createElement(n.p,null,"Il existe diff√©rents types de fonctions middleware ayant diff√©rents cas d'utilisation :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,r.createElement(n.strong,null,"Application-level middleware")," : la fonction middleware est li√©e √† l'objet ",r.createElement(n.strong,null,r.createElement(n.code,null,"app"))," et peut s'appliquer √† toutes les requ√™tes."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,"Router-level middleware")," : la fonction middleware est li√©e √† un objet de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"express.router()"))," et est tr√®s similaire au \"application-level middleware\", mais ne s'applique qu'√† un groupe de requ√™tes."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,"Error-handling middleware")," : fonction de gestion des erreurs qui se d√©finit comme les fonctions ci-dessus (au niveau ",r.createElement(n.strong,null,r.createElement(n.code,null,"app"))," ou ",r.createElement(n.strong,null,r.createElement(n.code,null,"router")),"), mais qui contient un quatri√®me param√®tre nomm√© ",r.createElement(n.strong,null,r.createElement(n.code,null,"error")),"."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,"Built-in middleware")," : fonctions middleware mises √† disposition par Express directement. En voici quelques exemples :","\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"express.static"))," : pour servir des assets statiques ;"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"express.json"))," : pour parser le body de requ√™tes en JSON vers des objets JS ;"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"express.urlencoded")),' : pour parser des requ√™tes dont le body est de type "urlencoded" (type par d√©faut des formulaires) vers des objets TS/JS.'),"\n"),"\n"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,"Third-party middleware")," : fonctions mises √† disposition par la communaut√© et installables via npm, comme par exemple la fonction middleware ",r.createElement(n.strong,null,r.createElement(n.code,null,"cookieParser")),"."),"\n"),"\n",r.createElement(n.p,null,"La suite fournit quelques exemples de fonctions middleware qui seront soit plus tard rencontr√©es dans notre code, soit sont extraites de la documentation d'Express : ",r.createElement(n.a,{href:"https://expressjs.com/en/guide/using-middleware.html"},"Using middleware")," ",r.createElement(n.a,{href:"/js2/references/#r54"},"[R.54]"),"."),"\n",r.createElement(n.h2,null,"Application-level middleware : exemple"),"\n",r.createElement(n.p,null,"Voici une fonction middleware qui sera ex√©cut√©e √† chaque fois qu'il y a une requ√™te, quelque soit le chemin (ou path) associ√© √† la requ√™te :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-js"},'import express from "express";\r\n\r\nconst app = express();\r\n\r\napp.use((_req, _res, next) => {\r\n  console.log(\r\n    "Time:",\r\n    new Date().toLocaleString("fr-FR", { timeZone: "Europe/Brussels" })\r\n  );\r\n  next();\r\n});\n')),"\n",r.createElement(n.h2,null,"Router-level middleware : exemple"),"\n",r.createElement(n.p,null,"Voici une partie du code qui pourrait se trouver au sein d'un router de pizzas, dans un fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/pizzas.ts"))," :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-js"},'import { Router } from "express";\r\nconst router = Router();\r\n\r\nrouter.use((_req, _res, next) => {\r\n  console.log(\r\n    "Time:",\r\n    new Date().toLocaleString("fr-FR", { timeZone: "Europe/Brussels" })\r\n  );\r\n  next();\r\n});\r\n\r\nrouter.get("/", (req, res) => {\r\n  return res.json(pizzas);\r\n});\n')),"\n",r.createElement(n.p,null,"La premi√®re fonction middleware ne contient pas de m√©thode HTTP, ni de chemin, elle s'appliquerait donc √† toutes les routes associ√©es au router de pizzas.",r.createElement(n.br),"\n","Voici le code qui permettrait, dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/app.ts")),", d'appeler le router de pizzas :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-js"},"import pizzaRouter from \"./routes/pizzas\";\r\napp.use('/pizzas', pizzaRouter);\n")),"\n",r.createElement(n.p,null,"Lors de l'op√©ration de lecture de toutes les pizzas, si le router est utilis√© de cette fa√ßon, en relisant l'avant-dernier snippet, on voit que :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"la premi√®re fonction (o√π il y a un ",r.createElement(n.code,null,"console.log"),") s'applique donc √† toutes les routes qui commencent par ",r.createElement(n.strong,null,r.createElement(n.code,null,"/pizzas"))," ;"),"\n",r.createElement(n.li,null,"la deuxi√®me fonction middleware s'appliquent seulement aux requ√™tes de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"GET"))," sur la route (ou le chemin) ",r.createElement(n.strong,null,r.createElement(n.code,null,"/pizzas"))," (√©quivalent de la route ",r.createElement(n.strong,null,r.createElement(n.code,null,"/pizzas/")),")."),"\n"),"\n",r.createElement(n.h2,null,"Error-handling middleware : exemple"),"\n",r.createElement(n.p,null,"Ce type de middleware est √† d√©finir apr√®s tous les middlewares pouvant g√©n√©rer une erreur et est appel√© via ",r.createElement(n.strong,null,r.createElement(n.code,null,"throw"))," ou via ",r.createElement(n.strong,null,r.createElement(n.code,null,"next(err)"))," dans une fonction middleware o√π un souci est d√©tect√©."),"\n",r.createElement(n.p,null,"Voici la d√©finition d'un gestionnaire d'erreurs :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-js"},'const errorHandler: ErrorRequestHandler = (err, _req, res, _next) => {\r\n  console.error(err.stack);\r\n  return res.status(500).send("Something broke!");\r\n};\r\n\r\napp.use(errorHandler);\n')),"\n",r.createElement(n.p,null,"Veuillez l'ajouter dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/app.ts"))," juste avant l'export d'",r.createElement(n.strong,null,r.createElement(n.code,null,"app")),".\r\nN'oubliez pas d'importer ",r.createElement(n.strong,null,r.createElement(n.code,null,"ErrorRequestHandler"))," depuis ",r.createElement(n.strong,null,r.createElement(n.code,null,"express")),"."),"\n",r.createElement(n.p,null,"Attention, il y a bien 4 param√®tres au lieu des 3 habituels pour les autres types de fonctions middleware."),"\n",r.createElement(n.p,null,"Veuillez d√©marrer l'API (par d√©faut elle est configur√©e sur le port 3000 au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"bin/www.ts")),") :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"npm run dev\n")),"\n",r.createElement(n.p,null,"Nous allons maintenant simuler une erreur dans notre application pour v√©rifier que notre gestionnaire d'erreurs fonctionne."),"\n",r.createElement(n.p,null,"Veuillez ajouter le code suivant dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/pizzas.ts")),", comme premi√®re route, juste apr√®s ",r.createElement(n.code,null,"defaultPizzas")," :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},'router.get("/error", (_req, _res, _next) => {\r\n  throw new Error("This is an error");\r\n  // equivalent of next(new Error("This is an error"));\r\n});\n')),"\n",r.createElement(n.p,null,"Pour red√©marrer l'API, cela se fait automatiquement pour vous √† chaque sauvegarde d'un fichier :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"üëç Nous vous conseillons de mettre l'auto-save dans VS Code : ",r.createElement(n.strong,null,r.createElement(n.code,null,"File"))," > ",r.createElement(n.strong,null,r.createElement(n.code,null,"Auto Save")),"."),"\n",r.createElement(n.li,null,"Sinon, vous devez penser √† faire des sauvegardes manuelles : ",r.createElement(n.strong,null,r.createElement(n.code,null,"CTRL s"))," √† chaque modification de fichier."),"\n"),"\n",r.createElement(n.p,null,"Pour faire une requ√™te √† cette route, veuillez taper dans votre navigateur (ou cliquez sur ce lien) : ",r.createElement(n.a,{href:"http://localhost:3000/pizzas/error"},"http://localhost:3000/pizzas/error"),"."),"\n",r.createElement(n.p,null,"Regardez le message d'erreur tant dans le terminal de VS Code que ce qui est affich√© dans votre browser."),"\n",r.createElement(n.h2,null,"Built-in middleware & third-party middleware : exemple"),"\n",r.createElement(n.p,null,"Dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"app.ts")),", on peut trouver pas mal d'exemples de ces types de middleware. Ils sont comment√©s ci-dessous dans le code :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-js"},"const app = express();\r\n\r\napp.use(logger('dev')); //¬†HTTP request logger linked to morgan package\r\napp.use(express.json()); //¬†Parse requests with JSON payloads\r\napp.use(express.urlencoded({ extended: false })); //¬†Parse requests with URL-\r\n                                                  // encoded payload \r\napp.use(cookieParser()); //¬†Parse cookie header (req.cookies)\r\napp.use(express.static(path.join(__dirname, 'public'))); //¬†Serve static assets\n")),"\n",r.createElement(n.h1,null,r.createElement(c,null," D√©finition d'une route en Express ")),"\n",r.createElement(n.h2,null,"D√©finition d'une route"),"\n",r.createElement(n.p,null,"Le routing, ou routage, contr√¥le la r√©ponse √† une requ√™te client pour un chemin et une m√©thode HTTP. Le chemin est aussi appel√© ",r.createElement(n.strong,null,"endpoint")," ou ",r.createElement(n.strong,null,"URI")," ou ",r.createElement(n.strong,null,"PATH"),"."),"\n",r.createElement(n.p,null,"On va d√©finir une route soit sur l'objet ",r.createElement(n.strong,null,r.createElement(n.code,null,"app")),", soit sur un ",r.createElement(n.strong,null,r.createElement(n.code,null,"router")),".",r.createElement(n.br),"\n","Un objet de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"router"))," permet de regrouper toutes les routes associ√©es √† un type de ressources."),"\n",r.createElement(n.p,null,"On d√©finit une route de cette fa√ßon : ",r.createElement(n.strong,null,r.createElement(n.code,null,"app."))," ou ",r.createElement(n.strong,null,r.createElement(n.code,null,"router.")),"  ",r.createElement(n.strong,null,r.createElement(n.code,null,"METHOD(PATH, MIDDLEWARE_FUNCTION)")),"."),"\n",r.createElement(n.p,null,"üëç Dans notre cours, nous vous recommandons d'organiser vos routes par type de ressources et donc de mettre en place des routers."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Op√©rations de lecture ")),"\n",r.createElement(n.p,null,'Nous souhaitons d√©couvrir comment mettre en place une op√©ration permettant de lire toutes les ressources de type "drinks".'),"\n",r.createElement(n.p,null,"Pour cela, il nous faut cr√©er un router pour traiter des ressources ",r.createElement(n.strong,null,r.createElement(n.code,null,"/drinks"))," au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts")),"."),"\n",r.createElement(n.p,null,"Pour √™tre s√ªr de ne pas avoir de probl√®me de compilation avec TypeScript, il est recommand√© de toujours ouvrir votre projet en tant que ",r.createElement(n.strong,null,r.createElement(n.code,null,"workspace"))," dans VS Code (",r.createElement(n.code,null,"File")," > ",r.createElement(n.code,null,"Open Folder...")," et s√©lection de votre r√©pertoire ",r.createElement(n.code,null,"basic"),")."),"\n",r.createElement(n.p,null,"Pour l'op√©ration de lecture de toutes les boissons, selon les conventions REST, il faut faire une requ√™te de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"GET /drinks")),". Le router de ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," doit donc offrir une route renvoyant toutes les boissons qui existent."),"\n",r.createElement(n.p,null,"Pour d√©marrer, nous souhaitons une application basique qui ne g√®re pas la persistance des donn√©es. Le menu sera donc un array d'objets, chaque objet repr√©sentant une boisson."),"\n",r.createElement(n.p,null,"Notre op√©ration de lecture de boissons va renvoyer du JSON au client, c'est √† dire une repr√©sentation textuelle d'un array d'objets. Nous verrons plus tard ce qu'est r√©ellement le JSON. A ce stade-ci, il est suffisant de conna√Ætre la fonction d'Express qui permet √† un objet TS/JS de circuler sur le r√©seau : ",r.createElement(n.strong,null,r.createElement(n.code,null,"res.json()")),"."),"\n",r.createElement(n.p,null,"Voici le code du router ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},'import { Router } from "express";\r\nimport { Drink } from "../types";\r\n\r\nconst drinks: Drink[] = [\r\n  {\r\n    id: 1,\r\n    title: "Coca-Cola",\r\n    image:\r\n      "https://media.istockphoto.com/id/1289738725/fr/photo/bouteille-en-plastique-de-coke-avec-la-conception-et-le-chapeau-rouges-d%C3%A9tiquette.jpg?s=1024x1024&w=is&k=20&c=HBWfROrGDTIgD6fuvTlUq6SrwWqIC35-gceDSJ8TTP8=",\r\n    volume: 0.33,\r\n    price: 2.5,\r\n  },\r\n  {\r\n    id: 2,\r\n    title: "Pepsi",\r\n    image:\r\n      "https://media.istockphoto.com/id/185268840/fr/photo/bouteille-de-cola-sur-un-fond-blanc.jpg?s=1024x1024&w=is&k=20&c=xdsxwb4bLjzuQbkT_XvVLyBZyW36GD97T1PCW0MZ4vg=",\r\n    volume: 0.33,\r\n    price: 2.5,\r\n  },\r\n  {\r\n    id: 3,\r\n    title: "Eau Min√©rale",\r\n    image:\r\n      "https://media.istockphoto.com/id/1397515626/fr/photo/verre-deau-gazeuse-%C3%A0-boire-isol%C3%A9.jpg?s=1024x1024&w=is&k=20&c=iEjq6OL86Li4eDG5YGO59d1O3Ga1iMVc_Kj5oeIfAqk=",\r\n    volume: 0.5,\r\n    price: 1.5,\r\n  },\r\n  {\r\n    id: 4,\r\n    title: "Jus d\'Orange",\r\n    image:\r\n      "https://images.unsplash.com/photo-1600271886742-f049cd451bba?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",\r\n    volume: 0.25,\r\n    price: 4.5,\r\n  },\r\n  {\r\n    id: 5,\r\n    title: "Limonade",\r\n    image:\r\n      "https://images.unsplash.com/photo-1583064313642-a7c149480c7e?q=80&w=1430&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",\r\n    volume: 0.33,\r\n    price: 5,\r\n  },\r\n];\r\n\r\nconst router = Router();\r\n\r\nrouter.get("/", (_req, res) => {\r\n  return res.json(drinks);\r\n});\r\n\r\nexport default router;\n')),"\n",r.createElement(n.p,null,"Ici, on a d√©fini un array de boissons, chaque boisson √©tant un objet de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"Drink")),". TS aurait pu nous aider √† d√©finir automatiquement le type de chaque objet gr√¢ce √† l'inf√©rence de type : (le 1er objet contient un ",r.createElement(n.code,null,"id")," qui est un ",r.createElement(n.code,null,"number"),", un ",r.createElement(n.code,null,"title")," qui est une string, ",r.createElement(n.code,null,"image")," qui est une string, ...)."),"\n",r.createElement(n.p,null,"N√©anmoins, il est bien plus clair de pr√©ciser le type de chaque objet comme √©tant de type ",r.createElement(n.code,null,"Drink"),". Une bonne pratique est de d√©finir les types de donn√©es dans un fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,"/types.ts"))," ; veuillez mettre √† jour ce fichier avec le type ",r.createElement(n.strong,null,r.createElement(n.code,null,"Drink"))," :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},"interface Drink {\r\n  id: number;\r\n  title: string;\r\n  image: string;\r\n  volume: number;\r\n  price: number;\r\n}\r\n\r\nexport type { Pizza, NewPizza, PizzaToUpdate, Drink };\n")),"\n",r.createElement(n.p,null,"Et voici le code de ",r.createElement(n.strong,null,r.createElement(n.code,null,"app.ts"))," (les parties modifi√©es sont surlign√©es) :"),"\n",r.createElement(n.pre,{numbered:!0,highlighting:"5,22"},r.createElement(n.code,{className:"language-js"},'import express, { ErrorRequestHandler } from "express";\r\n\r\nimport usersRouter from "./routes/users";\r\nimport pizzaRouter from "./routes/pizzas";\r\nimport drinkRouter from "./routes/drinks";\r\n\r\nconst app = express();\r\n\r\napp.use((_req, _res, next) => {\r\n  console.log(\r\n    "Time:",\r\n    new Date().toLocaleString("fr-FR", { timeZone: "Europe/Brussels" })\r\n  );\r\n  next();\r\n});\r\n\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: false }));\r\n\r\napp.use("/users", usersRouter);\r\napp.use("/pizzas", pizzaRouter);\r\napp.use("/drinks", drinkRouter);\r\n\r\nconst errorHandler: ErrorRequestHandler = (err, _req, res, _next) => {\r\n  console.error(err.stack);\r\n  return res.status(500).send("Something broke!");\r\n};\r\n\r\napp.use(errorHandler);\r\nexport default app;\n')),"\n",r.createElement(n.p,null,'Pour consommer l\'op√©ration de lecture via un browser, nous pouvons lire toutes les ressources de type "drinks" ici : ',r.createElement(n.a,{href:"http://localhost:3000/drinks"},"http://localhost:3000/drinks")),"\n",r.createElement(n.h1,null,r.createElement(c,null," Exercice 1.1 : lecture de toutes les ressources ")),"\n",r.createElement(n.p,null,"Vous allez cr√©er la premi√®re version de la RESTful API de ",r.createElement(n.strong,null,"myMovies"),", un site qui permettra de pr√©senter des films. Vous devez, sous Express, mettre √† disposition cette op√©ration :"),"\n",r.createElement(n.table,null,r.createElement(n.thead,null,r.createElement(n.tr,null,r.createElement(n.th,null,"URI"),r.createElement(n.th,null,"M√©thode HTTP"),r.createElement(n.th,null,"Op√©ration"))),r.createElement(n.tbody,null,r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"films"))),r.createElement(n.td,null,"GET"),r.createElement(n.td,null,"READ ALL : Lire toutes les ressources de la collection")))),"\n",r.createElement("br"),"\n",r.createElement(n.p,null,"Une ressource de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"films"))," doit contenir les propri√©t√©s suivantes :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"id"))," : un entier"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"title"))," : titre du film (String)"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"director"))," : le r√©alisateur du film (String)"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"duration"))," : dur√©e du film en minutes ; elle doit √™tre un nombre positif (pas une string !)."),"\n"),"\n",r.createElement(n.p,null,"Un film pourra avoir des propri√©t√©s suppl√©mentaires (elles sont optionnelles) :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"budget"))," : pour informer du co√ªt qu'a cout√© la production du film, en millions ; le budget doit √™tre un nombre positif (pas une string !)."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"description"))," : pour donner une URL vers une image du film."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"imageUrl"))," : pour donner une URL vers une image du film."),"\n"),"\n",r.createElement(n.p,null,'Veuillez donc "hardcoder" au moins trois ressources, parmi vos films pr√©f√©r√©s, dans un array au sein de votre RESTful API. Et si vous voulez aller tr√®s vite, demander √† une IA de g√©n√©rez des films contenant les propri√©t√©s demand√©es.'),"\n",r.createElement(n.p,null,"Le code de votre application doit se trouver dans votre repo git au sein du r√©pertoire ",r.createElement(n.strong,null,r.createElement(n.code,null,"/exercises/1.1")),". Vous allez donc cr√©er un nouveau projet sur base d'un clone du boilerplate : ",r.createElement(n.a,{href:"https://github.com/e-vinci/basic-ts-api-boilerplate"},"basic-ts-api-boilerplate"),"."),"\n",r.createElement(n.p,null,"Veuillez supprimer tout le code du boilerplate qui n'est pas n√©cessaire pour cet exercice."),"\n",r.createElement(n.p,null,"Une fois tout fonctionnel, veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"new: ex1.1")),"."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Exercice 1.2 : middleware s'ex√©cutant sur toutes les routes ")),"\n",r.createElement(n.h2,null,"Application middleware de base"),"\n",r.createElement(n.p,null,"Veuillez cr√©er un middleware qui permette d'enregistrer et d'afficher dans la console des statistiques sur les requ√™tes faites √† votre API."),"\n",r.createElement(n.p,null,"Vous devez enregistrer, depuis le d√©marrage du serveur, le nombre de requ√™tes ",r.createElement(n.strong,null,r.createElement(n.code,null,"GET"))," faites √† votre API."),"\n",r.createElement(n.p,null,"Veuillez repartir du code de la solution de votre Exercice 1.1 en cr√©ant un nouveau projet dans votre repo git dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/exercises/1.2")),"."),"\n",r.createElement(n.p,null,"Voici un example de ce qui devrait √™tre affich√© dans la console √† chaque requ√™te vers votre API :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"GET counter : 2\n")),"\n",r.createElement(n.p,null,"Veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"new: ex1.2")),"."),"\n",r.createElement(n.h4,null,"ü§ù Tips"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"Comment r√©cup√©rer la m√©thode HTTP ? ",r.createElement(n.strong,null,r.createElement(n.code,null,"req.method"))," ..."),"\n",r.createElement(n.li,null,"Comment appliquer un middleware √† toutes les routes ? revoir les ",r.createElement(n.strong,null,"application-level middleware"),"..."),"\n"),"\n",r.createElement(n.h2,null,"üç¨ Challenge optionnel : et si on allait un peu plus loin ?"),"\n",r.createElement(n.p,null,"S'il vous reste du temps et que vous souhaitez travailler les structures de donn√©es, vous pourriez maintenant cat√©goriser le nombre d'appels par ",r.createElement(n.strong,null,r.createElement(n.code,null,"PATH"))," et par ",r.createElement(n.strong,null,r.createElement(n.code,null,"m√©thode HTTP")),"."),"\n",r.createElement(n.p,null,"Voici un example de ce qui pourrait √™tre affich√© dans la console √† chaque requ√™te vers votre API :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"Request counter :\r\n- GET / : 10\r\n- GET /pizzas : 2\r\n- POST /pizzas : 5\r\n- DELETE /pizzas : 2\n")),"\n",r.createElement(n.h1,null,r.createElement(c,null," Utilisation du linter et du formatter pour TS ")),"\n",r.createElement(n.h2,null,"Le linter"),"\n",r.createElement(n.p,null,"Un linter est un outil qui analyse le code source pour signaler des erreurs de programmation, des bogues, des erreurs stylistiques et des constructions suspectes."),"\n",r.createElement(n.p,null,"Pour b√©n√©ficier de feedback sur votre code lors de son √©criture, vous devez avoir install√© l'extension ",r.createElement(n.strong,null,"ESLint")," au sein de VS Code."),"\n",r.createElement(n.p,null,"Vous devez aussi avoir ouvert le projet comme Workspace dans VS Code : ",r.createElement(n.code,null,"File"),", ",r.createElement(n.code,null,"Open Folder..."),". Le fichier de configuration de TypeScript (qui sp√©cifie les options de compilation pour le compilateur TypeScript ",r.createElement(n.code,null,"tsc"),") doit se trouver √† la racine de votre Workspace."),"\n",r.createElement(n.p,null,"Pour info, la configuration des r√®gles de ",r.createElement(n.strong,null,"ESLint")," se fait dans le fichier ",r.createElement(n.code,null,".eslintrc")," devant se trouver √† la racine d'un projet et offert au sein du boilerplate."),"\n",r.createElement(n.p,null,"Il est possible de b√©n√©ficier d'un check du projet par le linter et de voir tous les avertissement ou erreurs en tapant cette commande dans votre projet :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"npm run lint\n")),"\n",r.createElement(n.h2,null,"Le formatter"),"\n",r.createElement(n.p,null,"Un formateur de code est un outil qui permet de formater le code source de mani√®re automatique et coh√©rente. Cela permet de rendre le code plus lisible et de suivre des conventions de codage."),"\n",r.createElement(n.p,null,"Pour formatter votre code, vous devez avoir install√© l'extension ",r.createElement(n.strong,null,"prettier")," au sein de VS Code."),"\n",r.createElement(n.p,null,"Vous pouvez facilement formatter votre code :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"soit en tapant ",r.createElement(n.code,null,"Alt Shift F "),"(",r.createElement(n.code,null,"Option Shift F")," sous MacOS);"),"\n",r.createElement(n.li,null,"soit en faisant un clic droit sur votre script, ",r.createElement(n.code,null,"Format Document")," ; la premi√®re fois, il se peut que vous deviez s√©lectionner ",r.createElement(n.strong,null,"prettier")," comme formater : dans un fichier ",r.createElement(n.code,null,".ts"),", clic droit, ",r.createElement(n.code,null,"Format Document With..."),", ",r.createElement(n.code,null,"Configure Default Formatter"),"."),"\n"),"\n",r.createElement(n.h1,null,r.createElement(c,null," Param√®tres de route ")),"\n",r.createElement(n.p,null,"Les ",r.createElement(n.strong,null,"route parameters")," sont des segments d'une URL qui sont utilis√©s pour capturer une valeur sp√©cifi√©e √† leur position dans l'URL. On r√©cup√®re ces param√®tres via l'objet ",r.createElement(n.strong,null,r.createElement(n.code,null,"req.params")),"."),"\n",r.createElement(n.p,null,"Pour notre pizzeria, nous souhaitons pouvoir lire une boisson identifi√©e par son ",r.createElement(n.strong,null,"id"),"."),"\n",r.createElement(n.p,null,"Nous allons donc ajouter le param√®tre de route ",r.createElement(n.strong,null,r.createElement(n.code,null,"id")),".",r.createElement(n.br),"\n","En respect des conventions REST, un client devra faire ce genre de requ√™te pour appeler cette op√©ration : ",r.createElement(n.strong,null,r.createElement(n.code,null,"GET /drinks/2")),"."),"\n",r.createElement(n.p,null,"Pour continuer le tutoriel que nous avons initi√© dans le r√©pertoire ",r.createElement(n.strong,null,r.createElement(n.code,null,"/tutorials/pizzeria/api/basic")),",  voici la nouvelle route √† ajouter dans le router ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},'router.get("/:id", (req, res) => {\r\n  const id = Number(req.params.id);\r\n  const drink = drinks.find((drink) => drink.id === id);\r\n  if (!drink) {\r\n    return res.sendStatus(404);\r\n  }\r\n  return res.json(drink);\r\n});\n')),"\n",r.createElement(n.p,null,'Pour consommer cette nouvelle op√©ration via un browser, nous pouvons lire la ressource de type "drinks" identifi√©e par ',r.createElement(n.strong,null,"2")," dans le menu ainsi :\r\n",r.createElement(n.a,{href:"http://localhost:3000/drinks/2"},"http://localhost:3000/drinks/2")),"\n",r.createElement(n.p,null,"Le browser fait bien une requ√™te du genre : ",r.createElement(n.strong,null,r.createElement(n.code,null,"GET /drinks/2")),".",r.createElement(n.br),"\n",'Le param√®tre de la route "2" est r√©cup√©r√© dans l\'URL de la route par Express et est offert via ',r.createElement(n.strong,null,r.createElement(n.code,null,"req.params.id")),"."),"\n",r.createElement(n.p,null,"N'h√©sitez pas √† faire une requ√™te pour un identifiant n'existant pas dans les boissons : ",r.createElement(n.a,{href:"http://localhost:3000/drinks/666"},"http://localhost:3000/drinks/666"),"."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Param√®tres de requ√™te ")),"\n",r.createElement(n.p,null,"Les ",r.createElement(n.strong,null,"query parameters")," sont des param√®tres qui peuvent √™tre ajout√©s √† une URL.",r.createElement(n.br),"\n","On r√©cup√®re ces param√®tres via l'objet ",r.createElement(n.strong,null,r.createElement(n.code,null,"req.query")),"."),"\n",r.createElement(n.p,null,"Pour notre pizzeria, nous souhaitons pouvoir filtrer toutes les ressources de type \"boissons\" n'√©tant pas plus cher qu'un certain budget."),"\n",r.createElement(n.p,null,"En respect des conventions REST, un client devra faire ce genre de requ√™tes : ",r.createElement(n.strong,null,r.createElement(n.code,null,"GET /drinks/?budget-max=price"))," ;"),"\n",r.createElement(n.p,null,"Il n'y a donc pas de nouvelle route √† ajouter ici. En effet, √ßa reste une requ√™te de type GET sur la route ",r.createElement(n.strong,null,r.createElement(n.code,null,"/drinks")),"."),"\n",r.createElement(n.p,null,"Veuillez donc mettre √† jour ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," pour la lecture de toutes les boissons en filtrant selon le budget maximum :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},'router.get("/", (req, res) => {\r\n  if (!req.query["budget-max"]) {\r\n    // Cannot call req.query.budget-max as "-" is an operator\r\n    return res.json(drinks);\r\n  }\r\n  const budgetMax = Number(req.query["budget-max"]);\r\n  const filteredDrinks = drinks.filter((drink) => {\r\n    return drink.price <= budgetMax;\r\n  });\r\n  return res.json(filteredDrinks);\r\n});\n')),"\n",r.createElement(n.p,null,'Pour consommer cette nouvelle op√©ration via un browser, nous pouvons lire toutes les ressources de type "drinks" tri√©es par leur titre de mani√®re descendante :\r\n',r.createElement(n.a,{href:"http://localhost:3000/drinks/?budget-max=3"},"http://localhost:3000/drinks/?budget-max=3")),"\n",r.createElement(n.p,null,"N'h√©sitez pas √† tester d'autres filtres."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Op√©ration de cr√©ation & parsing du body ")),"\n",r.createElement(n.p,null,'Nous souhaitons d√©velopper une op√©ration permettant de cr√©er une ressource de type "drinks".',r.createElement(n.br),"\n","Selon les conventions REST, il faut faire une requ√™te de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"POST /drinks"))," qui offre une repr√©sentation de la ressource √† cr√©er. La repr√©sentation utilis√©e est le JSON que nous verrons plus en d√©tails plus tard.",r.createElement(n.br),"\n","Lors de l'ajout d'une boisson, si nous souhaitons cr√©er une ressource dont le titre est \"Virgin Tonic\", l'image est \"",r.createElement(n.a,{href:"https://plus.unsplash.com/premium_photo-1668771899398-1cdd763f745e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"},"https://plus.unsplash.com/premium_photo-1668771899398-1cdd763f745e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"),'", le volume est de 25cl et le prix est de 4,5‚Ç¨, alors la repr√©sentation de la ressource √† cr√©er sera la suivante :'),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-json"},'{\r\n    "title":"Virgin Tonic",\r\n    "image":"https://plus.unsplash.com/premium_photo-1668771899398-1cdd763f745e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",\r\n    "volume":0.25,\r\n    "price":4.5\r\n}\n')),"\n",r.createElement(n.p,null,"Selon les conventions REST, une requ√™te de cr√©ation est de type ",r.createElement(n.strong,null,"POST")," et contient ses ",r.createElement(n.strong,null,"param√®tres au sein du body")," de la requ√™te."),"\n",r.createElement(n.p,null,r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," doit offrir une nouvelle route permettant d'ajouter une nouvelle boisson (au menu des boissons), qui est un array d'objets. Une nouvelle boisson doit donc √™tre ajout√©e √† une variable, un array, qui est contenu dans la m√©moire vive de notre machine.",r.createElement(n.br),"\n","Lorsque l'ajout d'une boisson a r√©ussi, nous souhaitons renvoyer la repr√©sentation de la nouvelle ressource au client."),"\n",r.createElement(n.p,null,"Ainsi, le client aura souvent acc√®s √† une nouvelle propri√©t√©, l'",r.createElement(n.strong,null,"id")," de la ressource cr√©√©e par l'API."),"\n",r.createElement(n.p,null,"Voici une premi√®re version du code du router ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," pour la nouvelle op√©ration. Rajoutons-le dans notre application :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},'router.post("/", (req, res) => {\r\n  const { title, image, volume, price } = req.body;\r\n  if (!title || !image || !volume || !price) {\r\n    return res.sendStatus(400);\r\n  }\r\n\r\n  const nextId =\r\n    drinks.reduce((maxId, drink) => (drink.id > maxId ? drink.id : maxId), 0) +\r\n    1;\r\n\r\n  const newDrink: Drink = {\r\n    id: nextId,\r\n    title,\r\n    image,\r\n    volume,\r\n    price,\r\n  };\r\n\r\n  drinks.push(newDrink);\r\n  return res.json(newDrink);\r\n});\n')),"\n",r.createElement(n.p,null,"Ici, le linter ESLint nous avertit que ",r.createElement(n.strong,null,r.createElement(n.code,null,"req.body"))," n'est pas d√©fini, nous avons une allocation de valeurs de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"any"))," ins√©curitaire. En effet, ",r.createElement(n.code,null,"title"),", ",r.createElement(n.code,null,"image"),", ",r.createElement(n.code,null,"volume")," et ",r.createElement(n.code,null,"price")," peuvent √™tre de n'importe quel type (",r.createElement(n.strong,null,r.createElement(n.code,null,"any")),").\r\nNotre compilateur interdit ce genre de pratique, il est donc important de d√©finir le type de ",r.createElement(n.strong,null,r.createElement(n.code,null,"req.body")),"."),"\n",r.createElement(n.p,null,"Pour cela, nous devons d√©finir une interface qui repr√©sente la repr√©sentation de la ressource √† cr√©er."),"\n",r.createElement(n.p,null,"Voici le code de ",r.createElement(n.strong,null,r.createElement(n.code,null,"/types.ts"))," mis √† jour :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},'type NewDrink = Omit<Drink, "id">;\r\n\r\nexport type { Pizza, NewPizza, PizzaToUpdate, Drink, NewDrink };\n')),"\n",r.createElement(n.p,null,"Gr√¢ce √† ",r.createElement(n.code,null,"Omit"),", nous avons cr√©√© un nouveau type ",r.createElement(n.strong,null,r.createElement(n.code,null,"NewDrink"))," qui est le type ",r.createElement(n.strong,null,r.createElement(n.code,null,"Drink"))," sans la propri√©t√© ",r.createElement(n.strong,null,r.createElement(n.code,null,"id")),"."),"\n",r.createElement(n.p,null,"Concernant ",r.createElement(n.code,null,"req.body"),", il faut faire ce que l'on appelle de la ",r.createElement(n.strong,null,"r√©duction de type")," (ou ",r.createElement(n.strong,null,"type narrowing"),"). Cela consiste √† v√©rifier que les propri√©t√©s sont bien d√©finies et qu'elles sont du bon type, g√©n√©ralement √† l'aide d'op√©rateurs (comme ",r.createElement(n.strong,null,r.createElement(n.code,null,"typeof"))," ou ",r.createElement(n.strong,null,r.createElement(n.code,null,"instanceof")),", les op√©rateurs d'√©galit√©, l'op√©rateur ",r.createElement(n.strong,null,r.createElement(n.code,null,"in"))," ) qui r√©duisent dynamiquement le type de la variable."),"\n",r.createElement(n.p,null,"Et voici le code de ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," mis √† jour en suivant les bonnes pratiques identifi√©es dans l'intro au TS de ce cours :"),"\n",r.createElement(n.pre,{numbered:!0,highlighting:"2-20,22"},r.createElement(n.code,{className:"language-ts"},'router.post("/", (req, res) => {\r\n  const body: unknown = req.body;\r\n  if (\r\n    !body ||\r\n    typeof body !== "object" ||\r\n    !("title" in body) ||\r\n    !("image" in body) ||\r\n    !("volume" in body) ||\r\n    !("price" in body) ||\r\n    typeof body.title !== "string" ||\r\n    typeof body.image !== "string" ||\r\n    typeof body.volume !== "number" ||\r\n    typeof body.price !== "number" ||\r\n    !body.title.trim() ||\r\n    !body.image.trim() ||\r\n    body.volume <= 0 ||\r\n    body.price <= 0\r\n  ) {\r\n    return res.sendStatus(400);\r\n  }\r\n\r\n  const { title, image, volume, price } = body as NewDrink;\r\n\r\n  const nextId =\r\n    drinks.reduce((maxId, drink) => (drink.id > maxId ? drink.id : maxId), 0) +\r\n    1;\r\n\r\n  const newDrink: Drink = {\r\n    id: nextId,\r\n    title,\r\n    image,\r\n    volume,\r\n    price,\r\n  };\r\n\r\n  drinks.push(newDrink);\r\n  return res.json(newDrink);\r\n});\n')),"\n",r.createElement(n.p,null,"Nous avons finalement ajout√© une ",r.createElement(n.strong,null,"assertion de type")," : gr√¢ce √† ",r.createElement(n.strong,null,r.createElement(n.code,null,"as NewDrink")),", nous avons indiqu√© √† TypeScript que ",r.createElement(n.strong,null,r.createElement(n.code,null,"body"))," est de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"NewDrink"))," car nous en sommes certains (suite aux v√©rifications de type)."),"\n",r.createElement(n.p,null,"Il est √† noter que la repr√©sentation de la ressource √† cr√©er est pars√©e dans l'objet ",r.createElement(n.strong,null,r.createElement(n.code,null,"req.body"))," gr√¢ce √† la fonction middleware ",r.createElement(n.strong,null,r.createElement(n.code,null,"express.json()"))," appel√©e dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/app.ts"))," :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-js"},"app.use(express.json());\n")),"\n",r.createElement(n.p,null,"Il est donc important de ne pas oublier cette ligne lorsque l'on cr√©e une RESTful API."),"\n",r.createElement(n.p,null,"Bien, on se rend compte que la validation des donn√©es est tr√®s importante, mais elle est souvent r√©p√©titive. C'est pourquoi il peut √™tre int√©ressant d'utiliser des librairies de validation de donn√©es comme ",r.createElement(n.strong,null,r.createElement(n.code,null,"Joi"))," ou ",r.createElement(n.strong,null,r.createElement(n.code,null,"Yup")),"."),"\n",r.createElement(n.p,null,"OK, c'est bien, mais comment tester ce nouveau code ?"),"\n",r.createElement(n.p,null,"Le browser permet de facilement cr√©er des requ√™tes de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"GET")),", mais pas des requ√™tes de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"POST")),"...",r.createElement(n.br),"\n","Nous avons donc besoin d'un client l√©ger permettant de faire des requ√™tes HTTP."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Client REST ")),"\n",r.createElement(n.h2,null,"Introduction"),"\n",r.createElement(n.p,null,"Dans le cadre de ce cours, tout comme g√©n√©ralement dans un environnement professionnel, nous souhaitons pouvoir d√©velopper une API ind√©pendamment du d√©veloppement d'une IHM (Interface Homme Machine, ce sont les √©crans permettant d'interagir avec l'application web)."),"\n",r.createElement(n.p,null,"En effet, cela prendrait trop de temps de devoir d√©velopper un frontend pour tester nos API."),"\n",r.createElement(n.p,null,"Nous allons donc utiliser un client l√©ger permettant de faire des requ√™tes √† nos API.",r.createElement(n.br),"\n","Il en existe de nombreux, comme ",r.createElement(n.a,{href:"https://marketplace.visualstudio.com/items?itemName=humao.rest-client"},"REST Client")," ",r.createElement(n.a,{href:"/js2/references/#r55"},"[R.55]")," ou ",r.createElement(n.a,{href:"https://www.postman.com/"},"Postman")," ",r.createElement(n.a,{href:"/js2/references/#r56"},"[R.56]"),"."),"\n",r.createElement(n.h2,null,"REST Client"),"\n",r.createElement(n.p,null,"Dans le cadre de ce cours, nous utilisons ",r.createElement(n.a,{href:"https://marketplace.visualstudio.com/items?itemName=humao.rest-client"},"REST Client")," ",r.createElement(n.a,{href:"/js2/references/#r55"},"[R.55]")," de Visual Studio Code pour tester nos API."),"\n",r.createElement(n.p,null,"Pour installer REST Client au sein de VS Code, veuillez cliquer sur l'onglet ",r.createElement(n.strong,null,r.createElement(n.code,null,"Extensions")),"."),"\n",r.createElement(n.p,null,"Recherchez l'extension ",r.createElement(n.strong,null,r.createElement(n.code,null,"REST Client"))," et cliquez sur ",r.createElement(n.strong,null,r.createElement(n.code,null,"Install")),"."),"\n",r.createElement(n.p,null,"Quelques notions pour utiliser REST Client :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"Il faut cr√©er un fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,".http"))," (ou ",r.createElement(n.strong,null,r.createElement(n.code,null,".rest")),") contenant les requ√™tes vers vos RESTful APIs.",r.createElement(n.br),"\n","NB : Il est appropri√© de cr√©er un fichier par type de ressources."),"\n",r.createElement(n.li,null,"Chaque requ√™te est introduite par ",r.createElement(n.strong,null,r.createElement(n.code,null,"###")),' (3 "',r.createElement(n.strong,null,r.createElement(n.code,null,"#")),'"" ou plus) ; voici la requ√™te permettant de lire toutes les boissons :'),"\n"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},"### Read all drinks\r\nGET http://localhost:3000/drinks\n")),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"Pour ex√©cuter une requ√™te, il suffit de cliquer sur ",r.createElement(n.strong,null,r.createElement(n.code,null,"Send Request")),"."),"\n",r.createElement(n.li,null,"Lorsqu'on envoie des donn√©es au format JSON, il est important d'avoir un espace avant les accolades (avant le \"",r.createElement(n.strong,null,r.createElement(n.code,null,"{")),'" ).'),"\n",r.createElement(n.li,null,"On peut d√©finir des ",r.createElement(n.strong,null,"File variables")," via ce genre de syntaxe : ",r.createElement(n.strong,null,r.createElement(n.code,null,"@baseUrl = http://localhost:3000")),"."),"\n",r.createElement(n.li,null,"Pour utiliser la variable ",r.createElement(n.strong,null,r.createElement(n.code,null,"baseUrl")),", il suffit de la mettre entre double accolades. Par exemple, voici la requ√™te permettant de lire toutes les boissons :"),"\n"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},"### Read all drinks with File variable\r\n@baseUrl = http://localhost:3000\r\nGET {{baseUrl}}/drinks\n")),"\n",r.createElement(n.p,null,"Nous allons maintenant tester l'API de la pizzeria que nous avons cr√©√©e pour toutes ses op√©rations."),"\n",r.createElement(n.p,null,"Au sein de VS Code, dans votre projet ",r.createElement(n.strong,null,r.createElement(n.code,null,"/tutorials/pizzeria/api/basic")),", veuillez cr√©er un r√©pertoire nomm√© ",r.createElement(n.strong,null,r.createElement(n.code,null,"REST Client")),". Dans ce r√©pertoire, veuillez cr√©er un fichier nomm√© ",r.createElement(n.strong,null,r.createElement(n.code,null,"drinks.http")),"."),"\n",r.createElement(n.p,null,"Dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"drinks.http")),", veuillez ajouter cette requ√™te pour la lecture de toutes les boissons et ex√©cutez la :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},"### Read all drinks with File variable\r\n@baseUrl = http://localhost:3000\r\nGET {{baseUrl}}/drinks\n")),"\n",r.createElement(n.p,null,"Est-ce que cela fonctionne bien ?  Avez vous bien d√©marr√© votre API ?",r.createElement(n.br),"\n","Vous devriez obtenir le m√™me r√©sultat que si vous acc√©diez √† votre API √† l'aide du browser."),"\n",r.createElement(n.p,null,"Au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"drinks.http")),", veuillez ajouter ces deux requ√™tes pour la lecture d'une seule boission ou pour la lecture de toutes les boissons en les filtrant selon le budget maximum :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},"### Read a single drink\r\nGET {{baseUrl}}/drinks/3\r\n\r\n### Read all drinks cheaper or equal to 3 ‚Ç¨\r\nGET {{baseUrl}}/drinks/?budget-max=3\n")),"\n",r.createElement(n.p,null,"Veuillez ex√©cuter ces deux requ√™tes."),"\n",r.createElement(n.p,null,"Nous sommes pr√™ts pour ajouter une requ√™te appelant l'op√©ration de cr√©ation d'une boisson."),"\n",r.createElement(n.p,null,"Au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"drinks.http")),", veuillez ajouter cette requ√™te pour la cr√©ation d'une boisson :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},'### Create a drink\r\nPOST {{baseUrl}}/drinks\r\nContent-Type: application/json\r\n\r\n{\r\n    "title":"Virgin Tonic",\r\n    "image":"https://plus.unsplash.com/premium_photo-1668771899398-1cdd763f745e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",\r\n    "volume":0.25,\r\n    "price":4.5    \r\n}\n')),"\n",r.createElement(n.p,null,"On remarque qu'il est important de mettre une ligne vide avant les accolades repr√©sentant le body de la requ√™te."),"\n",r.createElement(n.p,null,"üí≠ Comment tester que le bon fonctionnement de l'op√©ration de cr√©ation ?"),"\n",r.createElement(n.p,null,"Il suffit d'ex√©cuter l'op√©ration de lecture de toutes les boissons üòé !\r\nLors de l'ajout d'une boisson, si la nouvelle ressource appara√Æt, c'est qu'elle a bien √©t√© cr√©√©e !",r.createElement(n.br),"\n","Faites le test !"),"\n",r.createElement(n.h1,null,r.createElement(c,null," Utilisation du debugger ")),"\n",r.createElement(n.h2,null,"Introduction"),"\n",r.createElement(n.p,null,"üí≠ Qui est votre meilleur ami ?"),"\n",r.createElement(n.p,null,"Il est possible qu'√† ce stade-ci, vous ignorez une des bonnes r√©ponses, car pour les d√©veloppeurs, le debugger est leur meilleur ami !"),"\n",r.createElement(n.p,null,"Le debugger est toujours l√† pour vous, pr√™t √† vous faire voyager pas √† pas dans votre code, √† vous donner des pistes dans les moments difficiles, sans imposer de solutions, il vous offre une libert√© totale ! Et il acceptera toujours votre code tel qu'il est, sous r√©serve bien s√ªr que celui-ci compile.\r\nC'est exactement ce que l'on attend d'un ami üòÅ."),"\n",r.createElement(n.h2,null,"Utilisation de la configuration de debug offerte"),"\n",r.createElement(n.p,null,"Nous vous offrons une configuration de Debug permettant de facilement d√©boguer plusieurs applications au sein d'un m√™me folder de VS Code. Cette configuration se trouve dans le fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,".vscode/launch.json")),".",r.createElement(n.br),"\n","Cette configuration est active au sein de VS Code que si elle se trouve √† la racine du folder ouverte dans VS Code. Vous devez donc vous assurer que le dossier ",r.createElement(n.strong,null,r.createElement(n.code,null,".vscode"))," et son fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,"launch.json"))," se trouvent au bon endroit. Voici deux sc√©narios :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"Si vous ouvrez un seul projet au sein de VS Code, c'est-√†-dire que le folder ouvert de VS Code est le clone du boilerplate d'une API : vous ne devez pas d√©placer le r√©pertoire ",r.createElement(n.strong,null,r.createElement(n.code,null,".vscode")),", tout est bien configur√©."),"\n",r.createElement(n.li,null,"Si vous ouvrez ou folder de VS Code contenant plusieurs projets, comme par exemple un repository contenant plusieurs API : vous devez d√©placer ",r.createElement(n.strong,null,r.createElement(n.code,null,".vscode"))," √† la racine du folder ouvert dans VS Code."),"\n"),"\n",r.createElement(n.p,null,"Si vous avez plusieurs applications au sein d'un folder de VS Code, pour d√©boguer une application en particulier, nous vous conseillons cette approche :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"Ouvrez le fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,"package.json"))," de l'application √† d√©boguer ;"),"\n",r.createElement(n.li,null,"Cliquez sur l'ic√¥ne ",r.createElement(n.strong,null,r.createElement(n.code,null,"Run and Debug"))," √† gauche de l'Explorer, puis cliquez sur ",r.createElement(n.strong,null,r.createElement(n.code,null,"Start Debugging"))," (ou cliquez juste sur ",r.createElement(n.strong,null,r.createElement(n.code,null,"F5")),") en v√©rifiant que la configuration de debugging s√©lectionn√©e est bien nomm√©e ",r.createElement(n.strong,null,r.createElement(n.code,null,"Launch via NPM")),"."),"\n"),"\n",r.createElement(n.p,null,"Notons que le nom de la configuration de debugging peut facilement √™tre modifi√©e en changeant la valeur de l'attribut ",r.createElement(n.strong,null,r.createElement(n.code,null,"name"))," dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/.vscode/launch.json")),"."),"\n",r.createElement(n.h2,null,"Utilisation du debugger TS"),"\n",r.createElement(n.p,null,"Il existe un autre moyen de d√©boguer son application au sein de VS Code :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"Vous pouvez installer l'extension ",r.createElement(n.strong,null,r.createElement(n.code,null,"TypeScript Debugger"))," au sein de VS Code;"),"\n",r.createElement(n.li,null,"Ensuite, il vous suffit de cr√©er une configuration de Debug : ",r.createElement(n.strong,null,r.createElement(n.code,null,"Add Configuration...")),", ",r.createElement(n.strong,null,r.createElement(n.code,null,"TS Debug"))," ; sinon, vous pouvez s√©lectionner la configuration existante et nomm√©e ",r.createElement(n.strong,null,r.createElement(n.code,null,"ts-node"))," dans le boilerplate d'une API. Une fois que votre configuration est ouverte apr√®s avoir cliqu√© sur l'onglet de Debug, vous √™tes pr√™t √† d√©boguer."),"\n",r.createElement(n.li,null,"Ouvrez le script d'entr√©e de votre application : ",r.createElement(n.strong,null,r.createElement(n.code,null,"/bin/www.ts")),"."),"\n",r.createElement(n.li,null,"Cliquez sur ",r.createElement(n.strong,null,r.createElement(n.code,null,"Start Debugging"))," ou sur ",r.createElement(n.strong,null,r.createElement(n.code,null,"F5"))," en v√©rifiant que la configuration de debugging s√©lectionn√©e est bien nomm√©e ",r.createElement(n.strong,null,r.createElement(n.code,null,"ts-node"))," (ou le nom que vous auriez choisi pour la configuration de votre debugger pour TS)."),"\n"),"\n",r.createElement(n.h1,null,r.createElement(c,null," Exercice 1.3 : lectures sp√©cifiques, cr√©ation & REST Client ")),"\n",r.createElement(n.p,null,"Veuillez continuer le d√©veloppement de la RESTful API de ",r.createElement(n.strong,null,"myMovies"),", sous Express, afin de mettre √† disposition de nouvelles op√©rations sur des films et utiliser ",r.createElement(n.strong,null,"REST Client"),"."),"\n",r.createElement(n.p,null,"Veuillez repartir du code de la solution de votre ",r.createElement(n.a,{href:"#exercice_1_2_middleware_sexecutant_sur_toutes_les_routes"},"Exercice 1.2")," en cr√©ant un nouveau projet dans votre repo git dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/exercises/1.3")),"."),"\n",r.createElement(n.p,null,"Veuillez rajouter ces op√©rations √† votre API :"),"\n",r.createElement(n.table,null,r.createElement(n.thead,null,r.createElement(n.tr,null,r.createElement(n.th,null,"URI"),r.createElement(n.th,null,"M√©thode HTTP"),r.createElement(n.th,null,"Op√©ration"))),r.createElement(n.tbody,null,r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"films?minimum-duration=value"))),r.createElement(n.td,null,"GET"),r.createElement(n.td,null,"READ ALL FILTERED : Lire toutes les ressources de la collection selon le filtre donn√©")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"films/{id}"))),r.createElement(n.td,null,"GET"),r.createElement(n.td,null,"READ ONE : Lire la ressource identifi√©e")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"films"))),r.createElement(n.td,null,"POST"),r.createElement(n.td,null,"CREATE ONE : Cr√©er une ressource bas√©e sur les donn√©es de la requ√™te")))),"\n",r.createElement("br"),"\n",r.createElement(n.p,null,"Pour rappel, une ressource de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"films"))," doit contenir les propri√©t√©s suivantes :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"id"))," : un entier"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"title"))," : titre du film (String)"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"director"))," : le r√©alisateur du film (String)"),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"duration"))," : dur√©e du film en minutes ; elle doit √™tre un nombre positif (pas une string !)."),"\n"),"\n",r.createElement(n.p,null,"Un film pourra avoir des propri√©t√©s suppl√©mentaires (elles sont optionnelles) :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"budget"))," : pour informer du co√ªt qu'a co√ªt√© la production du film, en millions ; le budget doit √™tre un nombre positif (pas une string !)."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"description"))," : pour donner une URL vers une image du film."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"imageUrl"))," : pour donner une URL vers une image du film."),"\n"),"\n",r.createElement(n.p,null,"Les ressources ne doivent toujours pas persister : d√®s lors, ajoutez les donn√©es associ√©es aux films dans un array."),"\n",r.createElement(n.p,null,"Veuillez bien valider les param√®tres re√ßu par les op√©rations de vos API ; v√©rifiez par exemple que ",r.createElement(n.strong,null,r.createElement(n.code,null,"budget"))," et ",r.createElement(n.strong,null,r.createElement(n.code,null,"duration"))," sont des ",r.createElement(n.strong,null,"nombres positifs"),". Si √ßa n'est pas le cas, renvoyer un message d'erreur (comme par exemple \"Wrong minimum duration\") au format JSON (via ",r.createElement(n.strong,null,r.createElement(n.code,null,"res.json")),"). Ceci n'est pas une bonne pratique, mais pour l'instant, c'est suffisant."),"\n",r.createElement(n.p,null,"Veuillez ",r.createElement(n.strong,null,"tester toutes les fonctions de la RESTful API")," pour la collection de films √† l'aide du ",r.createElement(n.strong,null,"REST Client")," dans VS Code. Veuillez ajouter vos requ√™tes au sein du fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,"films.http"))," dans le r√©pertoire ",r.createElement(n.strong,null,"REST Client")," du dossier associ√© √† cet exercice."),"\n",r.createElement(n.p,null,"Veuillez tester pas √† pas chaque ligne de votre op√©ration de cr√©ation de film. Pour ce faire, vous devez utiliser le debugger !"),"\n",r.createElement(n.p,null,"Une fois tout fonctionnel, veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"new: ex1.3")),"."),"\n",r.createElement(n.h4,null,"ü§ù Tips"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"D√©veloppez les op√©rations de votre API de mani√®re incr√©mentale : testez une op√©ration via REST Client avant de passer √† une nouvelle op√©ration."),"\n",r.createElement(n.li,null,"Pour le filtre sur les films, vous allez r√©cup√©rer un param√®tre de requ√™te.",r.createElement(n.br),"\n","‚ö° Attention, le signe ",r.createElement(n.strong,null,r.createElement(n.code,null,"-"))," est un op√©rateur en TS/JS, vous ne pouvez pas r√©cup√©rer le param√®tre de requ√™te via ",r.createElement(n.strong,null,r.createElement(n.code,null,"req.query.minimum-duration")),"...",r.createElement(n.br),"\n","üí≠ Mais alors comment faire ?",r.createElement(n.br),"\n","On acc√®de aussi au propri√©t√© d'un objet √† l'aide d'un array, ici √ßa serait via ",r.createElement(n.strong,null,r.createElement(n.code,null,"req.query['minimum-duration']")),"."),"\n",r.createElement(n.li,null,"Pour transformer une string en nombre, vous pouvez utiliser la fonction ",r.createElement(n.strong,null,r.createElement(n.code,null,"Number"))," : ",r.createElement(n.strong,null,r.createElement(n.code,null,"Number(req.query['minimum-duration'])")),"..."),"\n"),"\n",r.createElement(n.h4,null,"üç¨ Challenge optionnel"),"\n",r.createElement(n.p,null,"Si vous avez encore du temps, pour l'op√©ration de cr√©ation, vous pourriez ajouter une validation des donn√©es plus robuste en assurant qu'aucune propri√©t√© inattendue n'est pr√©sente dans la repr√©sentation de la ressource √† cr√©er."),"\n",r.createElement(n.p,null,"Une fois tout fonctionnel, veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"new: ex1.3++")),"."),"\n",r.createElement(n.h1,null,r.createElement(c,null," üç¨ Exercice 1.4 : Gestion de la pagination, du tri et du filtrage ")),"\n",r.createElement(n.p,null,"N'h√©sitez pas, c'est optionnel, de g√©rer de nouvelles op√©rations au sein de votre RESTful API de ",r.createElement(n.strong,null,"myMovies")," :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"Filtrez tous les films qui commencent par une certaines cha√Ænes de caract√®res."),"\n",r.createElement(n.li,null,"Permettez de trier les films."),"\n"),"\n",r.createElement(n.p,null,"Le code de votre application est √† ajouter dans votre repo git dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/exercises/1.4")),".",r.createElement(n.br),"\n","Veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"1.4 : API : ordering & filtering client")),"."),"\n",r.createElement(n.p,null,"üç¨ Et si vraiment vous avez encore du temps et souhaitez d√©j√† approfondir les RESTful APIs, n'h√©sitez pas aussi √† impl√©menter la gestion de la pagination. Pour cette partie, veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"new: ex1.4")),"."),"\n",r.createElement(n.h4,null,"ü§ù Tips"),"\n",r.createElement(n.p,null,"Besoin d'inspiration pour l'aspect filtrage et la gestion du tri des ressources ? ",r.createElement(n.a,{href:"https://dev.to/drminnaar/rest-api-guide-14n2"},"REST API Guide")," ",r.createElement(n.a,{href:"/js2/references/#r58"},"[R.58]"),"."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Codes de statut HTTP associ√©s aux r√©ponses ")),"\n",r.createElement(n.p,null,"On ne peut pas toujours renvoyer du JSON suite √† une requ√™te client ainsi qu'un code HTTP correspondant au fait que tout est OK (",r.createElement(n.strong,null,r.createElement(n.code,null,"200 OK")),")."),"\n",r.createElement(n.p,null,"Quand vous ex√©cutez cette requ√™te :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},"### Read all drinks with File variable\r\nGET {{baseUrl}}/drinks\n")),"\n",r.createElement(n.p,null,"Vous faites appel √† l'op√©ration de lecture de toutes les boissons. La derni√®re ligne de cette op√©ration est la suivante :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},"return res.json(filteredDrinks);\n")),"\n",r.createElement(n.p,null,"La fonction ",r.createElement(n.strong,null,r.createElement(n.code,null,"json"))," renvoie une r√©ponse au format JSON, mais de plus, elle renvoie un ",r.createElement(n.strong,null,"status code")," ",r.createElement(n.strong,null,r.createElement(n.code,null,"200"))," indiquant au client que tout s'est bien pass√©."),"\n",r.createElement(n.p,null,"Au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"drinks.http")),", veuillez ajouter cette requ√™te pour tenter de cr√©er une boisson en oubliant un param√®tre :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},'### Try to create a drink with incomplete data\r\nPOST {{baseUrl}}/drinks\r\nContent-Type: application/json\r\n\r\n{\r\n    "title":"Missing Data Drink",\r\n    "volume":0.25,\r\n    "price":4.5    \r\n}\n')),"\n",r.createElement(n.p,null,"Veuillez ex√©cuter cette requ√™te. Que se passe-t-il ?",r.createElement(n.br),"\n","On r√©cup√®re un code d'erreur ",r.createElement(n.strong,null,r.createElement(n.code,null,"400 Bad Request")),"."),"\n",r.createElement(n.p,null,"En effet, lorsqu'on omet un param√®tre dans la repr√©sentation de la ressource √† cr√©er, voici les lignes de code amenant au renvoi du code d'erreur ",r.createElement(n.strong,null,r.createElement(n.code,null,"400"))," au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"drinks.ts"))," :"),"\n",r.createElement(n.pre,{numbered:!0,highlighting:"3-20"},r.createElement(n.code,{className:"language-ts"},'router.post("/", (req, res) => {\r\n  const body: unknown = req.body;\r\n  if (\r\n    !body ||\r\n    typeof body !== "object" ||\r\n    !("title" in body) ||\r\n    !("image" in body) ||\r\n    !("volume" in body) ||\r\n    !("price" in body) ||\r\n    typeof body.title !== "string" ||\r\n    typeof body.image !== "string" ||\r\n    typeof body.volume !== "number" ||\r\n    typeof body.price !== "number" ||\r\n    !body.title.trim() ||\r\n    !body.image.trim() ||\r\n    body.volume <= 0 ||\r\n    body.price <= 0\r\n  ) {\r\n    return res.sendStatus(400);\r\n  }\r\n\r\n  const { title, image, volume, price } = body as NewDrink;\r\n\r\n  const nextId =\r\n    drinks.reduce((maxId, drink) => (drink.id > maxId ? drink.id : maxId), 0) +\r\n    1;\r\n\r\n  const newDrink: Drink = {\r\n    id: nextId,\r\n    title,\r\n    image,\r\n    volume,\r\n    price,\r\n  };\r\n\r\n  drinks.push(newDrink);\r\n  return res.json(newDrink);\r\n});\n')),"\n",r.createElement(n.p,null,"Le client est donc bien inform√© qu'il y a eu un probl√®me lors de l'ex√©cution de l'op√©ration.",r.createElement(n.br),"\n","Il pourrait par exemple utiliser cette information pour pr√©senter un message d'erreur au niveau d'une IHM."),"\n",r.createElement(n.p,null,'Voici les grandes cat√©gories de "status codes" :'),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"R√©ponses informatives : ",r.createElement(n.strong,null,r.createElement(n.code,null,"100-199"))),"\n",r.createElement(n.li,null,"R√©ponses en cas de succ√®s : ",r.createElement(n.strong,null,r.createElement(n.code,null,"200-299"))),"\n",r.createElement(n.li,null,"Redirections : ",r.createElement(n.strong,null,r.createElement(n.code,null,"300-399"))),"\n",r.createElement(n.li,null,"Erreurs du client : ",r.createElement(n.strong,null,r.createElement(n.code,null,"400-499"))),"\n",r.createElement(n.li,null,"Erreurs du serveur : ",r.createElement(n.strong,null,r.createElement(n.code,null,"500-599"))),"\n"),"\n",r.createElement(n.p,null,'Voici les "status codes" que nous allons g√©n√©ralement utiliser :'),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"200 OK"))," : tout s'est bien pass√©, Express ajoute ce code automatiquement pour nous quand nous utilisons une m√©thode comme ",r.createElement(n.strong,null,r.createElement(n.code,null,"res.json()")),"."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"400 Bad Request"))," : pour indiquer au client que la requ√™te contient des param√®tres non valides ou n'est pas compl√®te."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"401 Unauthorized"))," : pour indiquer au client qu'il doit s'authentifier pour acc√©der √† cette op√©ration. On renvoie aussi ce code d'erreur quand un client fournit un mauvais username ou password."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"403 Forbidden"))," : le client est connu du serveur, mais il n'a pas les privil√®ges pour acc√©der √† cette op√©ration (par exemple, le client n'est pas admin et tente d'acc√©der √† une op√©ration seulement accessible √† un admin)."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"404 Not Found"))," : la ressource demand√©e n'existe pas, bien que l'URL semble valide."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"409 Conflict"))," : l'√©tat du serveur entre en conflit avec la requ√™te. Par exemple, la requ√™te demande de cr√©er un utilisateur qui existe d√©j√†."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,r.createElement(n.code,null,"500 Internal Server Error"))," : le serveur a rencontr√© une erreur qu'il ne peut pas r√©gler. Par exemple, le serveur de base de donn√©es ne r√©pond pas et ne permet donc pas d'acc√©der aux ressources."),"\n"),"\n",r.createElement(n.h1,null,r.createElement(c,null," Exercice 1.5 : codes de statut HTTP ")),"\n",r.createElement(n.p,null,"Veuillez continuer le d√©veloppement de la RESTful API de ",r.createElement(n.strong,null,"myMovies"),", sous Express, afin de mieux g√©rer la la lecture et la cr√©ation de films et les r√©ponses √† donner aux clients."),"\n",r.createElement(n.p,null,"Veuillez cr√©er un nouveau projet dans votre repo git dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/exercises/1.5"))," en partant du code de la solution de votre ",r.createElement(n.a,{href:"#exercice_1_3_lectures_specifiques_creation_rest_client"},"Exercice 1.3")," ou de votre ",r.createElement(n.a,{href:"#%F0%9F%8D%AC_exercice_1_4_gestion_de_la_pagination_du_tri_et_du_filtrage"},"Exercice 1.4 optionnel"),"."),"\n",r.createElement(n.p,null,"Veuillez am√©liorer les deux op√©rations de lecture (",r.createElement(n.strong,null,r.createElement(n.code,null,"GET /films"))," & ",r.createElement(n.strong,null,r.createElement(n.code,null,"GET /films/:id")),") et l'op√©ration de cr√©ation de films (",r.createElement(n.strong,null,r.createElement(n.code,null,"POST /films")),"):"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"En cas d'√©chec de la validation des param√®tres re√ßus par une op√©ration (non respect du contrat de l'API), veuillez renvoyer le status code appropri√©."),"\n",r.createElement(n.li,null,"Lors de l'√©chec de la lecture d'un film en particulier, veuillez renvoyer le status code appropri√©."),"\n",r.createElement(n.li,null,"Lors de l'ajout d'un film, si la ressource existe d√©j√†, c'est-√†-dire s'il y a d√©j√† un film pr√©sent avec le ",r.createElement(n.strong,null,r.createElement(n.code,null,"title"))," et le ",r.createElement(n.strong,null,r.createElement(n.code,null,"director"))," donn√©, veuillez renvoyer le status code appropri√©."),"\n"),"\n",r.createElement(n.p,null,"Veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"new: ex1.5")),"."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Op√©rations de suppression & de modification ")),"\n",r.createElement(n.h2,null,"Op√©ration de suppression"),"\n",r.createElement(n.p,null,'Nous souhaitons d√©velopper une op√©ration permettant de supprimer une ressource de type "boisson" √† l\'aide de son identifiant.'),"\n",r.createElement(n.p,null,"Selon les conventions REST, une ",r.createElement(n.strong,null,"op√©ration de suppression"),":"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"est associ√©e √† une requ√™te de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"DELETE /drinks/{id}"))," contenant l'",r.createElement(n.strong,null,"identifiant")," de la ressource √† supprimer au sein de l'URI comme ",r.createElement(n.strong,null,"param√®tre de route"),"."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,"ne contient pas de donn√©es dans le body")," et est de ",r.createElement(n.strong,null,"type DELETE"),"."),"\n"),"\n",r.createElement(n.p,null,"Voici le code du router ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," pour la nouvelle op√©ration, veuillez la rajouter dans le r√©pertoire de votre tutoriel en cours :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},'router.delete("/:id", (req, res) => {\r\n  const id = Number(req.params.id);\r\n  const index = drinks.findIndex((drink) => drink.id === id);\r\n  if (index === -1) {\r\n    return res.sendStatus(404);\r\n  }\r\n  const deletedElements = drinks.splice(index, 1); // splice() returns an array of the deleted elements\r\n  return res.json(deletedElements[0]);\r\n});\n')),"\n",r.createElement(n.p,null,"Au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"drinks.http")),', veuillez ajouter cette requ√™te pour supprimer la boisson poss√©dant l\'identifiant "2" :'),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},"### Delete a drink\r\nDELETE {{baseUrl}}/drinks/2\n")),"\n",r.createElement(n.p,null,"Veuillez ex√©cuter cette requ√™te et v√©rifier que la boisson a bien √©t√© supprim√©e."),"\n",r.createElement(n.h2,null,"Op√©ration de modification"),"\n",r.createElement(n.p,null,'Nous souhaitons d√©velopper une op√©ration permettant de modifier une ressource de type "drinks" √† l\'aide de son identifiant et de nouvelles valeurs pour ses propri√©t√©s.'),"\n",r.createElement(n.p,null,"Selon les conventions REST, une ",r.createElement(n.strong,null,"op√©ration de modification")," :"),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"si l'on accepte de modifier que certaines des propri√©t√©s d'une boisson (que l'on ne doit donc pas fournir toutes les propri√©t√©s d'une boisson), est associ√©e √† une requ√™te de type ",r.createElement(n.strong,null,r.createElement(n.code,null,"PATCH /drinks/{id}"))," contenant l'",r.createElement(n.strong,null,"identifiant")," de la ressource √† supprimer au sein de l'URL comme ",r.createElement(n.strong,null,"param√®tre de route"),"."),"\n",r.createElement(n.li,null,r.createElement(n.strong,null,"contient les nouvelles donn√©es au sein du body")," et est de ",r.createElement(n.strong,null,"type PATCH ou PUT"),"."),"\n"),"\n",r.createElement(n.p,null,"Lors de l'ajout d'une boisson, si nous souhaitons modifier une ressource identifi√©e par ",r.createElement(n.strong,null,r.createElement(n.code,null,"5")),' en fournissant un nouveau titre "Citronnade", la repr√©sentation des donn√©es de la ressource √† modifier sera la suivante :'),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-json"},'{\r\n    "title":"Citronnade"\r\n}\n')),"\n",r.createElement(n.p,null,"Selon les conventions REST, la requ√™te de modification est de type PATCH et contient ses param√®tres au sein du body de la requ√™te."),"\n",r.createElement(n.p,null,"Voici le code du router ",r.createElement(n.strong,null,r.createElement(n.code,null,"/routes/drinks.ts"))," pour la nouvelle op√©ration √† rajouter dans votre tutoriel en cours :"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-ts"},'router.patch("/:id", (req, res) => {\r\n  const id = Number(req.params.id);\r\n  const drink = drinks.find((drink) => drink.id === id);\r\n  if (!drink) {\r\n    return res.sendStatus(404);\r\n  }\r\n\r\n  const body: unknown = req.body;\r\n\r\n  if (\r\n    !body ||\r\n    typeof body !== "object" ||\r\n    ("title" in body &&\r\n      (typeof body.title !== "string" || !body.title.trim())) ||\r\n    ("image" in body &&\r\n      (typeof body.image !== "string" || !body.image.trim())) ||\r\n    ("volume" in body &&\r\n      (typeof body.volume !== "number" || body.volume <= 0)) ||\r\n    ("price" in body && (typeof body.price !== "number" || body.price <= 0))\r\n  ) {\r\n    return res.sendStatus(400);\r\n  }\r\n\r\n  const { title, image, volume, price }: Partial<NewDrink> = body;\r\n\r\n  if (title) {\r\n    drink.title = title;\r\n  }\r\n  if (image) {\r\n    drink.image = image;\r\n  }\r\n  if (volume) {\r\n    drink.volume = volume;\r\n  }\r\n  if (price) {\r\n    drink.price = price;\r\n  }\r\n\r\n  return res.json(drink);\r\n});\n')),"\n",r.createElement(n.p,null,"Au sein de ",r.createElement(n.strong,null,r.createElement(n.code,null,"drinks.http")),', veuillez ajouter cette requ√™te pour modifier la boisson poss√©dant l\'identifiant "5" :'),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-http"},'### Update the pizza identified by 6\r\nPATCH {{baseUrl}}/pizzas/6\r\nContent-Type: application/json\r\n\r\n{\r\n    "title":"Magic Green 2"\r\n}\n')),"\n",r.createElement(n.p,null,"Veuillez ex√©cuter cette requ√™te et v√©rifier que la boisson a bien √©t√© modifi√©e."),"\n",r.createElement(n.p,null,"En cas de souci, vous pouvez acc√©der au code du tutoriel ici : ",r.createElement(n.a,{href:"https://github.com/e-vinci/ts-demos/tree/main/back/api/basic"},"basic"),"."),"\n",r.createElement(n.h1,null,r.createElement(c,null," Exercice 1.6 : suppression & modification de ressources ")),"\n",r.createElement(n.p,null,"Veuillez continuer le d√©veloppement de la RESTful API de ",r.createElement(n.strong,null,"myMovies"),", sous Express, afin d'ajouter les op√©rations de suppression et de modification de ressources."),"\n",r.createElement(n.p,null,"Veuillez cr√©er un nouveau projet dans votre repo git dans ",r.createElement(n.strong,null,r.createElement(n.code,null,"/exercises/1.6"))," en repartant du code de la solution de votre ",r.createElement(n.a,{href:"#exercice_1_5_codes_de_statut_http"},"Exercice 1.5"),"."),"\n",r.createElement(n.p,null,"Veuillez ajouter ces trois nouvelles op√©rations :"),"\n",r.createElement(n.table,null,r.createElement(n.thead,null,r.createElement(n.tr,null,r.createElement(n.th,null,"URI"),r.createElement(n.th,null,"M√©thode HTTP"),r.createElement(n.th,null,"Op√©ration"))),r.createElement(n.tbody,null,r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"films/{id}"))),r.createElement(n.td,null,"DELETE"),r.createElement(n.td,null,"DELETE ONE : Effacer la ressource identifi√©e")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"films/{id}"))),r.createElement(n.td,null,"PATCH"),r.createElement(n.td,null,"UPDATE ONE : Mettre √† jour les propri√©t√©s de la ressource par les valeurs donn√©es dans la requ√™te, pour une ou plusieurs propri√©t√©s")),r.createElement(n.tr,null,r.createElement(n.td,null,r.createElement(n.strong,null,r.createElement(n.code,null,"films/{id}"))),r.createElement(n.td,null,"PUT"),r.createElement(n.td,null,"UPDATE ONE or CREATE ONE : Remplacer la ressource par une ressource reprenant les valeurs donn√©es dans la requ√™te, seulement si toutes les propri√©t√©s non optionnelles de la ressource sont donn√©es ! Si la ressource n'existe pas, cr√©er cette ressource seulement si l'",r.createElement(n.strong,null,r.createElement(n.code,null,"id"))," donn√© n'est pas d√©j√† existant.")))),"\n",r.createElement(n.p,null,"Veuillez bien valider les param√®tres re√ßus par les op√©rations de vos API ; v√©rifiez par exemple que ",r.createElement(n.strong,null,r.createElement(n.code,null,"budget"))," et ",r.createElement(n.strong,null,r.createElement(n.code,null,"duration"))," sont des ",r.createElement(n.strong,null,"nombres positifs"),"."),"\n",r.createElement(n.p,null,"Veuillez ",r.createElement(n.strong,null,"tester toutes les fonctions de la RESTful API")," pour la collection de films √† l'aide du ",r.createElement(n.strong,null,"REST Client")," dans VS Code. Veuillez ajouter vos requ√™tes au sein du fichier ",r.createElement(n.strong,null,r.createElement(n.code,null,"films.http"))," dans le r√©pertoire ",r.createElement(n.strong,null,"REST Client")," du dossier associ√© √† cet exercice."),"\n",r.createElement(n.p,null,"Et n'h√©sitez pas √† utiliser le debugger pour tester pas √† pas chaque ligne de vos op√©rations qui ne fournissent pas le r√©sultat attendu."),"\n",r.createElement(n.p,null,"Veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"new: ex1.6")),"."),"\n",r.createElement(n.h4,null,"üç¨ Challenge optionnel"),"\n",r.createElement(n.p,null,"Si vous avez encore du temps, pour les op√©rations de modification, vous pourriez ajouter une validation des donn√©es plus robuste en assurant qu'aucune propri√©t√© inattendue n'est pr√©sente dans la repr√©sentation de la ressource √† modifier (ou √† cr√©er si c'est un ",r.createElement(n.strong,null,r.createElement(n.code,null,"put")),")."),"\n",r.createElement(n.p,null,"De plus, pour l'op√©ration ",r.createElement(n.code,null,"PUT"),", lorsqu'il s'agit d'une cr√©ation, vous pourriez ajouter une validation pour v√©rifier que le film n'existe pas d√©j√† (sur base du ",r.createElement(n.strong,null,r.createElement(n.code,null,"title"))," et du ",r.createElement(n.strong,null,r.createElement(n.code,null,"director")),")."),"\n",r.createElement(n.p,null,"Une fois tout fonctionnel, veuillez faire un ",r.createElement(n.strong,null,r.createElement(n.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(n.strong,null,r.createElement(n.code,null,"new: ex1.6++")),"."))}var u=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.RP)(),e.components);return n?r.createElement(n,e,r.createElement(a,e)):a(e)};function o(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}var s=t(4810),c=t(2662),i=t(9640),d=t(5938),m=t(9460),p=t(7929),E=t(794),g=t(4092),f=t(4262),v=t(3528),b=t(9942),h=t(4698),q=t(2214),x=t(9838),y=(t(1262),t(1731)),T=t(7050),z=t(2483),k=t(4902),S=t(9294),j=t(7828),P=t(2035),w=t(5590);const R={Link:s.Link,Image:i.A,Section:d.A,Content:m.A,Background:p.A,SectionHeader:E.A,SectionFooter:g.A,PageHeader:f.A,CodeBlock:b.A,LinkFile:h.A,ScrollableImage:q.A,PublicProjectsView:x.A,AuthenticatedBlock:y.A,UnAuthenticatedBlock:T.A,NestedMdxBlock:z.A,YoutubeImage:k.A,InternalPageMenu:S.A,InternalPageMenuItem:j.A,InternalPageTitle:P.A,PathViewer:w.E,PathViewerItem:w.F};function A(e){var n,t,a,u,o;let{data:{mdx:s,allImages:i},children:d}=e;return R.PageHeader=(0,v.R)(f.A,null==s?void 0:s.frontmatter),r.createElement(c.A,Object.assign({},null!=s&&s.frontmatter?{frontmatter:s.frontmatter}:{},null!=s&&null!==(n=s.frontmatter)&&void 0!==n&&n.navbarExtraStyles?{navbarExtraStyles:s.frontmatter.navbarExtraStyles}:{},null!=s&&null!==(t=s.frontmatter)&&void 0!==t&&t.headerImage?{headerImage:s.frontmatter.headerImage}:{},null!=s&&null!==(a=s.frontmatter)&&void 0!==a&&a.featuredImage?{featuredImage:s.frontmatter.featuredImage}:{},null!=s&&null!==(u=s.frontmatter)&&void 0!==u&&u.title?{pageTitle:s.frontmatter.title}:{},i&&i.length>0?{allImages:i}:{}),r.createElement(l.xA,{components:R},r.createElement("div",{className:null!=s&&null!==(o=s.frontmatter)&&void 0!==o&&o.autoMargin?"page page--auto-margin ":"page"},d)))}function I(e){return r.createElement(A,e,r.createElement(u,e))}}}]);
//# sourceMappingURL=component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-express-api-fr-mdx-0c44afa1605f69f59798.js.map