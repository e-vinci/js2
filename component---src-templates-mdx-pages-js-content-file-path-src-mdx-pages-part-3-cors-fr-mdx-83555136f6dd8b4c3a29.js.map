{"version":3,"file":"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-3-cors-fr-mdx-83555136f6dd8b4c3a29.js","mappings":"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","sources":["webpack://myjscourse/./src/mdx-pages/part3/cors.fr.mdx","webpack://myjscourse/./src/templates/mdx-pages.js"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    strong: \"strong\",\n    code: \"code\",\n    a: \"a\",\n    pre: \"pre\",\n    ul: \"ul\",\n    li: \"li\",\n    br: \"br\",\n    em: \"em\"\n  }, _provideComponents(), props.components), {InternalPageMenu, PathViewer, PathViewerItem} = _components;\n  if (!InternalPageMenu) _missingMdxReference(\"InternalPageMenu\", true);\n  if (!PathViewer) _missingMdxReference(\"PathViewer\", true);\n  if (!PathViewerItem) _missingMdxReference(\"PathViewerItem\", true);\n  return React.createElement(React.Fragment, null, React.createElement(_components.h1, null, \"d) Autoriser des origines pour une API\"), \"\\n\", React.createElement(InternalPageMenu, null, React.createElement(PathViewer, null, React.createElement(PathViewerItem, {\n    to: \"/\"\n  }, \" web2course \"), React.createElement(PathViewerItem, {\n    to: \"/part3\"\n  }, \" Partie 3 \"), React.createElement(PathViewerItem, {\n    selected: true\n  }, \" d) Autoriser des origines \"))), \"\\n\", React.createElement(_components.h1, null, \"Autorisation d'origines & les CORS\"), \"\\n\", React.createElement(_components.p, null, \"A cette partie-ci, nous allons voir comment mettre Ã  jour une API afin que dans chaque rÃ©ponse faite Ã  un client, on ajoute un header permettant d'autoriser une ou plusieurs origines.\"), \"\\n\", React.createElement(_components.p, null, \"C'est un moyen de relÃ¢cher la sÃ©curitÃ© d'une API tout en restant vigilant sur les origines autorisÃ©es.\"), \"\\n\", React.createElement(_components.p, null, \"Pour ce nouveau tutoriel, nous allons partir de la derniÃ¨re version de la RESTful API de pizzas.\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez crÃ©er un nouveau projet nommÃ© \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"/web2/tutorials/back/api/cors\")), \" sur base d'un copiÃ© collÃ© de \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/ts-demos/tree/main/back/api/services\"\n  }, \"services\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Dans ce projet, veuillez installer le package \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"cors\")), \" et les types associÃ©s :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-bash\"\n  }, \"npm i cors\\nnpm i @types/cors -D\\n\")), \"\\n\", React.createElement(_components.p, null, \"Nous allons configurer les headers de la RESTful API Ã  l'aide du middleware \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"cors\")), \" offert par la librairie \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"cors\")), \".\"), \"\\n\", React.createElement(_components.p, null, \"Pour configurer et utiliser les \", React.createElement(_components.strong, null, \"CORS\"), \", veuillez mettre Ã  jour le fichier \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"/app.ts\")), \" :\"), \"\\n\", React.createElement(_components.pre, {\n    numbered: true,\n    highlighting: \"2,10-12,14\"\n  }, React.createElement(_components.code, {\n    className: \"language-ts\"\n  }, \"import express, { ErrorRequestHandler } from \\\"express\\\";\\nimport cors from \\\"cors\\\";\\n\\nimport usersRouter from \\\"./routes/users\\\";\\nimport pizzaRouter from \\\"./routes/pizzas\\\";\\nimport drinkRouter from \\\"./routes/drinks\\\";\\n\\nconst app = express();\\n\\nconst corsOptions = {\\n  origin: [/^http:\\\\/\\\\/localhost/, \\\"http://amazing.you.com\\\"],\\n};\\n\\napp.use(cors(corsOptions));\\n\\napp.use((_req, _res, next) => {\\n  console.log(\\n    \\\"Time:\\\",\\n    new Date().toLocaleString(\\\"fr-FR\\\", { timeZone: \\\"Europe/Brussels\\\" })\\n  );\\n  next();\\n});\\n\\napp.use(express.json());\\napp.use(express.urlencoded({ extended: false }));\\n\\napp.use(\\\"/users\\\", usersRouter);\\napp.use(\\\"/pizzas\\\", pizzaRouter);\\napp.use(\\\"/drinks\\\", drinkRouter);\\n\\nconst errorHandler: ErrorRequestHandler = (err, _req, res, _next) => {\\n  console.error(err.stack);\\n  return res.status(500).send(\\\"Something broke!\\\");\\n};\\n\\napp.use(errorHandler);\\nexport default app;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Via \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"/^http:\\\\/\\\\/localhost/\")), \", nous prÃ©cisons que l'API doit autoriser toutes les origines locales (REGEX qui accepte toutes les URL qui commencent par \", React.createElement(_components.code, null, \"http://localhost\"), \").\"), \"\\n\", React.createElement(_components.p, null, \"Il reste Ã  s'assurer que votre frontend (\", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"/web2/tutorials/pizzeria/front/fetch-no-proxy\")), \") est lui aussi bien dÃ©marrÃ© et peut rÃ©aliser ses \\\"fetch\\\" vers l'API.\"), \"\\n\", React.createElement(_components.p, null, \"Tout fonctionne correctement ?\"), \"\\n\", React.createElement(_components.p, null, \"Normalement oui, vous devriez avoir le site de la pizzeria qui affiche le menu des pizzas suite Ã  un appel Ã  l'API.\"), \"\\n\", React.createElement(_components.p, null, \"En cas de souci, vous pouvez accÃ©der au code du tutoriel ici :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"pour l'API : \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/ts-demos/tree/main/back/api/cors\"\n  }, \"cors\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"pour le frontend :\\n\", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/ts-demos/tree/main/front/fetch-no-proxy\"\n  }, \"fetch-no-proxy\"), \".\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"ðŸ’­ OK, Ã§a fonctionne bien... Mais cela est possible seulement si nous sommes les propriÃ©taires de la RESTful API. Maintenant, que faire si une API tierce doit Ãªtre intÃ©grÃ©e dans notre frontend ?\", React.createElement(_components.br), \"\\n\", \"Imaginez que vous souhaitez intÃ©grer une opÃ©ration d'une API offerte par Google...\", React.createElement(_components.br), \"\\n\", \"Pensez-vous que vous pouvez leur donner un coup de fil et dire : \", React.createElement(_components.em, null, \"\\\"Google, peux-tu STP autoriser l'origine associÃ©e Ã  mon site web ?\\\"...\")), \"\\n\", React.createElement(_components.p, null, \"Il y a une solution pour cela : le \", React.createElement(_components.strong, null, \"proxy\"), \" qui est vu ailleurs dans ce cours.\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","import GATSBY_COMPILED_MDX from \"/Users/raphaelbaroni/code/web2/ts-repos/web2/src/mdx-pages/part3/cors.fr.mdx\";\nimport React from 'react';\nimport {graphql} from 'gatsby';\nimport {MDXProvider} from '@mdx-js/react';\nimport {Link} from 'gatsby';\nimport MainLayout from '../components/main-layout.js';\nimport Image from '../components/image.js';\nimport Section from '../components/section.js';\nimport Content from '../components/content.js';\nimport Background from '../components/background.js';\nimport SectionHeader from '../components/section-header.js';\nimport SectionFooter from '../components/section-footer.js';\nimport PageHeader from '../components/page-header.js';\nimport {withFrontmatter} from '../components/hoc/hoc.js';\nimport CodeBlock from '../components/codeblock/codeblock.js';\nimport LinkFile from '../components/file/link-file.js';\nimport ScrollableImage from '../components/image/scrollable-image';\nimport PublicProjectsView from '../components/public-projects/public-projects-view';\nimport {AuthenticatedTemplate, UnauthenticatedTemplate} from '@azure/msal-react';\nimport AuthenticatedBlock from '../components/auth/authenticated-block.js';\nimport UnAuthenticatedBlock from '../components/auth/unauthenticated-block.js';\nimport NestedMdxBlock from '../components/mdx/nested-mdx-block.js';\nimport YoutubeImage from '../components/image/youtube-image.js';\nimport InternalPageMenu from '../components/internal-page-menu/internal-page-menu.js';\nimport InternalPageMenuItem from '../components/internal-page-menu/internal-page-menu-item.js';\nimport InternalPageTitle from '../components/internal-page-menu/menu-title.js';\nimport {PathViewer, PathViewerItem} from '../components/path-viewer/path-viewer.js';\nconst shortcodes = {\n  Link,\n  Image,\n  Section,\n  Content,\n  Background,\n  SectionHeader,\n  SectionFooter,\n  PageHeader,\n  CodeBlock,\n  LinkFile,\n  ScrollableImage,\n  PublicProjectsView,\n  AuthenticatedBlock,\n  UnAuthenticatedBlock,\n  NestedMdxBlock,\n  YoutubeImage,\n  InternalPageMenu,\n  InternalPageMenuItem,\n  InternalPageTitle,\n  PathViewer,\n  PathViewerItem\n};\nfunction PageTemplate({data: {mdx, allImages}, children}) {\n  shortcodes.PageHeader = withFrontmatter(PageHeader, mdx?.frontmatter);\n  return React.createElement(MainLayout, Object.assign({}, mdx?.frontmatter ? {\n    frontmatter: mdx.frontmatter\n  } : {}, mdx?.frontmatter?.navbarExtraStyles ? {\n    navbarExtraStyles: mdx.frontmatter.navbarExtraStyles\n  } : {}, mdx?.frontmatter?.headerImage ? {\n    headerImage: mdx.frontmatter.headerImage\n  } : {}, mdx?.frontmatter?.featuredImage ? {\n    featuredImage: mdx.frontmatter.featuredImage\n  } : {}, mdx?.frontmatter?.title ? {\n    pageTitle: mdx.frontmatter.title\n  } : {}, allImages && allImages.length > 0 ? {\n    allImages: allImages\n  } : {}), React.createElement(MDXProvider, {\n    components: shortcodes\n  }, React.createElement(\"div\", {\n    className: mdx?.frontmatter?.autoMargin ? 'page page--auto-margin ' : 'page'\n  }, children)));\n}\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(PageTemplate, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\nexport const pageQuery = graphql`\n  query pagesAndImages($slug: String) {\n    mdx(fields: { slug: { eq: $slug } }) {\n      id\n      body\n      fields {\n        slug\n      }\n\n      frontmatter {\n        title\n        date\n        navbarExtraStyles\n        headerImage\n        featuredImage\n        description\n        autoMargin\n      }\n    }\n    allImages: allFile(\n      filter: {\n        sourceInstanceName: { eq: \"images\" }\n        extension: { nin: [\"ico\", \"svg\"] }\n      }\n    ) {\n      edges {\n        node {\n          childImageSharp {\n            gatsbyImageData(\n              quality: 90\n              layout: FULL_WIDTH\n              placeholder: TRACED_SVG\n              tracedSVGOptions: { color: \"green\", background: \"grey\" }\n            )\n          }\n          base\n        }\n      }\n    }\n  }\n`;\n"],"names":["_createMdxContent","props","_components","Object","assign","h1","p","strong","code","a","pre","ul","li","br","em","_provideComponents","components","InternalPageMenu","PathViewer","PathViewerItem","_missingMdxReference","React","to","selected","href","className","numbered","highlighting","wrapper","MDXLayout","id","component","Error","shortcodes","Link","Image","Section","Content","Background","SectionHeader","SectionFooter","PageHeader","CodeBlock","LinkFile","ScrollableImage","PublicProjectsView","AuthenticatedBlock","UnAuthenticatedBlock","NestedMdxBlock","YoutubeImage","InternalPageMenuItem","InternalPageTitle","PageTemplate","data","mdx","allImages","children","withFrontmatter","frontmatter","MainLayout","navbarExtraStyles","headerImage","featuredImage","title","pageTitle","length","MDXProvider","autoMargin","GatsbyMDXWrapper","GATSBY_COMPILED_MDX"],"sourceRoot":""}