"use strict";(self.webpackChunkmyjscourse=self.webpackChunkmyjscourse||[]).push([[8615],{1928:function(e,n,t){t.r(n),t.d(n,{default:function(){return A}});var r=t(5680),l=t(6540);function a(e){const n=Object.assign({h1:"h1",h2:"h2",p:"p",code:"code",a:"a",ul:"ul",li:"li",pre:"pre",strong:"strong",br:"br",h3:"h3"},(0,r.RP)(),e.components),{InternalPageMenu:t,PathViewer:a,PathViewerItem:o,InternalPageMenuItem:u,InternalPageTitle:s}=n;return t||i("InternalPageMenu",!0),u||i("InternalPageMenuItem",!0),s||i("InternalPageTitle",!0),a||i("PathViewer",!0),o||i("PathViewerItem",!0),l.createElement(l.Fragment,null,l.createElement(n.h1,null,"d) L'état plus avancé"),"\n",l.createElement(t,null,l.createElement(a,null,l.createElement(o,{to:"/"}," web2course "),l.createElement(o,{to:"/part2"}," Partie 2 "),l.createElement(o,{selected:!0}," d) L'état plus avancé ")),l.createElement(u,null," Comment gérer un formulaire en React ?  "),l.createElement(u,null," Formulaire non contrôlé par React "),l.createElement(u,null,' L\' objet "event" '),l.createElement(u,null," Formulaire contrôlé par React "),l.createElement(u,null," Gérer une collection comme état de l'application "),l.createElement(u,null," Mise à jour de l'état en React "),l.createElement(u,null," Exercice 2.7 : Gestion d'une collection pour l'état "),l.createElement(u,null," Gestion d'un état partagé par plusieurs composants "),l.createElement(u,null," Debugging d'une application React "),l.createElement(u,null," 🍬 Challenge optionnel 2.8 : gestion d'un état partagé ")),"\n",l.createElement(n.h1,null,l.createElement(s,null," Comment gérer un formulaire en React ?   ")),"\n",l.createElement(n.h2,null,"Introduction"),"\n",l.createElement(n.p,null,"Il y a beaucoup d'applications web où nous allons souhaiter gérer un formulaire."),"\n",l.createElement(n.p,null,"En React, pour afficher ce qui est visible dans un formulaire, nous allons devoir jouer avec l'état de l'application."),"\n",l.createElement(n.p,null,"Pour ce tutoriel, veuillez créer une copie du tutoriel ",l.createElement(n.code,null,"start-state"),", si nécessaire voici le code du tutoriel ",l.createElement(n.a,{href:"https://github.com/e-vinci/ts-demos/tree/main/front/start-state"},"start-state"),", et l'appeler ",l.createElement(n.code,null,"medium-state"),". Changez le nom du projet dans ",l.createElement(n.code,null,"package.json"),"."),"\n",l.createElement(n.p,null,"Il existe deux façons de gérer des formulaires en React :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,'les formulaires non contrôlés par React : les valeurs des inputs sont gérées par le DOM (Document Object Model) ; c\'est la manière qui correspond à la manière de faire en JS pur, quand on fait de la programmation "old-school" ;'),"\n",l.createElement(n.li,null,"les formulaires contrôlés par React : les valeurs des inputs sont gérées par React, via un état."),"\n"),"\n",l.createElement(n.h1,null,l.createElement(s,null," Formulaire non contrôlé par React  ")),"\n",l.createElement(n.p,null,"Dans le composant ",l.createElement(n.code,null,"Main")," (",l.createElement(n.code,null,"/src/components/Main/index.tsx"),"), à la suite de ",l.createElement(n.code,null,"PizzaMenu"),", nous allons ajouter un formulaire :"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-tsx"},'const Main = () => {\r\n  const handleSubmit = (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n    const form = e.target as HTMLFormElement;\r\n    console.log("submit:", form.pizza.value, form.description.value);\r\n  };\r\n\r\n  return (\r\n    <main>\r\n      <p>My HomePage</p>\r\n      <p>\r\n        Because we love JS, you can also click on the header to stop / start the\r\n        music ; )\r\n      </p>\r\n      <audio id="audioPlayer" controls autoPlay>\r\n        <source src={sound} type="audio/mpeg" />\r\n        Your browser does not support the audio element.\r\n      </audio>\r\n      <PizzaMenu />\r\n\r\n      <div>\r\n        <br />\r\n        <form onSubmit={handleSubmit}>\r\n          <label htmlFor="pizza">Pizza</label>\r\n          <input type="text" id="pizza" name="pizza" />\r\n          <label htmlFor="description">Description</label>\r\n          <input type="text" id="description" name="description" />\r\n          <button type="submit">Ajouter</button>\r\n        </form>\r\n      </div>\n')),"\n",l.createElement(n.p,null,"Ce code va être expliqué en découvrant ce qu'est l'objet \"event\" et comment l'utiliser."),"\n",l.createElement(n.h1,null,l.createElement(s,null,' L\' objet "event" ')),"\n",l.createElement(n.p,null,"L'objet ",l.createElement(n.strong,null,l.createElement(n.code,null,"event"))," a été nommé ",l.createElement(n.strong,null,l.createElement(n.code,null,"e"))," ci-dessus, mais nous aurions pu lui donner le nom que l'on souhaitait."),"\n",l.createElement(n.p,null,"👍 Pour éviter la confusion, il est recommandé de l'appeler ",l.createElement(n.strong,null,l.createElement(n.code,null,"e"))," (ou éventuellement ",l.createElement(n.strong,null,l.createElement(n.code,null,"event")),")."),"\n",l.createElement(n.p,null,"L'objet ",l.createElement(n.strong,null,l.createElement(n.code,null,"event"))," est automatiquement passé à la callback d'un gestionnaire d'événements."),"\n",l.createElement(n.p,null,"Il est très utile, pour deux raisons principalement :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Stopper l'action par défaut associée à un événement."),"\n",l.createElement(n.li,null,"Lorsqu'on attache une même callback à une multitude d'éléments, pour retrouver la cible de l'événement."),"\n"),"\n",l.createElement(n.p,null,l.createElement(n.strong,null,l.createElement(n.code,null,"e.target"))," est l'élément HTML qui lance la propagation de l'événement dans l'arbre des composants."),"\n",l.createElement(n.p,null,"Parfois on préfère utiliser ",l.createElement(n.strong,null,l.createElement(n.code,null,"e.currentTarget"))," qui est l'élément HTML sur lequel est attaché le gestionnaire d'événements."),"\n",l.createElement(n.p,null,"Dans le code ci-dessus, on utilise l'objet ",l.createElement(n.strong,null,l.createElement(n.code,null,"event"))," pour stopper l'action par défaut d'un formulaire qui est d'envoyer les données au serveur (indiqué par la propriété ",l.createElement(n.strong,null,l.createElement(n.code,null,"action"))," du formulaire) et de recharger la page."),"\n",l.createElement(n.p,null,"Veuillez :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"exécuter l'application et vérifiez que tout fonctionne ;"),"\n",l.createElement(n.li,null,"commenter ",l.createElement(n.code,null,"e.preventDefault()")," :"),"\n"),"\n",l.createElement(n.pre,{highlighting:"2"},l.createElement(n.code,{className:"language-ts"},' const handleSubmit = (e: SyntheticEvent) => {\r\n    // e.preventDefault();\r\n    const form = e.target as HTMLFormElement;\r\n    console.log("submit:", form.pizza.value, form.description.value);\r\n  };\n')),"\n",l.createElement(n.p,null,"Qu'est-ce qui se passe ?",l.createElement(n.br),"\n","Il y a un rechargement de page qui est interdit dans le type d'application que nous développons. Nous reviendrons plus tard sur pourquoi il n'est pas acceptable de recharger la page..."),"\n",l.createElement(n.h1,null,l.createElement(s,null," Formulaire contrôlé par React  ")),"\n",l.createElement(n.p,null,"Dans le formulaire développé jusque là, il n'est pas contrôlé par React. Nous avons accès à la valeur des inputs, néanmoins, ça n'est pas une pratique recommandée."),"\n",l.createElement(n.p,null,"👍 Il est recommandé d'utiliser des composants contrôlés par React. Les valeurs des inputs doivent être contrôlées par React à travers un état, et les changements seront gérés via les gestionnaires d'événements (",l.createElement(n.code,null,"onChange")," pour les inputs)."),"\n",l.createElement(n.p,null,"Comme nous avons deux inputs ici, nous allons créer deux variables d'états et les mettre à jour dans la callback associée aux gestionnaires d'événements ",l.createElement(n.code,null,"onChange")," :"),"\n",l.createElement(n.pre,{numbered:!0,highlighting:"2-3,10-14,16-20,39,43,48,52"},l.createElement(n.code,{className:"language-tsx"},'const Main = () => {\r\n  const [pizza, setPizza] = useState("");\r\n  const [description, setDescription] = useState("");\r\n\r\n  const handleSubmit = (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n    console.log("submit:", pizza, description);\r\n  };\r\n\r\n  const handlePizzaChange = (e: SyntheticEvent) => {\r\n    const pizzaInput = e.target as HTMLInputElement;\r\n    console.log("change in pizzaInput:", pizzaInput.value);\r\n    setPizza(pizzaInput.value);\r\n  };\r\n\r\n  const handleDescriptionChange = (e: SyntheticEvent) => {\r\n    const descriptionInput = e.target as HTMLInputElement;\r\n    console.log("change in descriptionInput:", descriptionInput.value);\r\n    setDescription(descriptionInput.value);\r\n  };\r\n\r\n  return (\r\n    <main>\r\n      <p>My HomePage</p>\r\n      <p>\r\n        Because we love JS, you can also click on the header to stop / start the\r\n        music ; )\r\n      </p>\r\n      <audio id="audioPlayer" controls autoPlay>\r\n        <source src={sound} type="audio/mpeg" />\r\n        Your browser does not support the audio element.\r\n      </audio>\r\n      <PizzaMenu />\r\n      <div>\r\n        <br />\r\n        <form onSubmit={handleSubmit}>\r\n          <label htmlFor="pizza">Pizza</label>\r\n          <input\r\n            value={pizza}\r\n            type="text"\r\n            id="pizza"\r\n            name="pizza"\r\n            onChange={handlePizzaChange}\r\n            required\r\n          />\r\n          <label htmlFor="description">Description</label>\r\n          <input\r\n            value={description}\r\n            type="text"\r\n            id="description"\r\n            name="description"\r\n            onChange={handleDescriptionChange}\r\n            required\r\n          />\r\n          <button type="submit">Ajouter</button>\r\n        </form>\r\n      </div>\n')),"\n",l.createElement(n.p,null,"Nous voyons maintenant que :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"chaque valeur d'une input est contrôlée par une variable d'état qui est mise à jour à chaque changement opéré (dans l'input) ;"),"\n",l.createElement(n.li,null,'que grâce à l\'objet "event", nous avons accès à la valeur de chaque input via ',l.createElement(n.code,null,"e.target.value"),". Néanmoins, comme TS est typé, nous devons d'abord faire une assertion de type pour ",l.createElement(n.code,null,"e.target")," en indiquant que c'est un ",l.createElement(n.code,null,"HTMLInputElement")," afin d'avoir accès à ",l.createElement(n.code,null,"value"),"."),"\n"),"\n",l.createElement(n.p,null,"Veuillez exécuter l'application, ouvrir la console, et observer ce qui se passe :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"quand vous écrivez dans les inputs,"),"\n",l.createElement(n.li,null,"lorsque vous cliquez sur le bouton ",l.createElement(n.code,null,"Ajouter"),"."),"\n"),"\n",l.createElement(n.p,null,"Ca y est, nous avons appris comment maîtriser les formulaires en Flutter."),"\n",l.createElement(n.p,null,"Il nous reste maintenant à voir comment utiliser les données du formulaire au sein d'une collection de données qui va permettre de mettre à jour nos écrans."),"\n",l.createElement(n.h1,null,l.createElement(s,null," Gérer une collection comme état de l'application  ")),"\n",l.createElement(n.h2,null,"Introduction"),"\n",l.createElement(n.p,null,"Très souvent, c'est une collection de données qui sera utilisée comme état de l'application."),"\n",l.createElement(n.p,null,"Par exemple, dans notre tutoriel, nous souhaiterions qu'une collection de pizzas permette :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"d'afficher toutes les pizzas du menu ;"),"\n",l.createElement(n.li,null,"d'ajouter automatiquement une nouvelle pizzas au menu après soumission des données du formulaire."),"\n"),"\n",l.createElement(n.p,null,"💭 Quand nous devons mettre en place une variable d'état, ici un array de ",l.createElement(n.code,null,"Pizza"),', il faut toujours se poser la question : "Mais où est-ce que je dois gérer cet état ?".'),"\n",l.createElement(n.p,null,"Actuellement, la collection de ",l.createElement(n.code,null,"Pizza")," est gérée dans le composant ",l.createElement(n.code,null,"PizzaMenu"),", qui est un \"sibling\" (un frère ou une sœur) du formulaire. Ainsi, si nous devons y accéder dans ces différents éléments, il faut faire monter l'état vers leur ancêtre commun le plus proche, leur parent. Ici, c'est le composant ",l.createElement(n.code,null,"Main"),"."),"\n",l.createElement(n.p,null,"Nous allons donc mettre à jour ",l.createElement(n.code,null,"PizzaMenu")," pour qu'il reçoive dans ses props la collection de pizza. Voici ",l.createElement(n.code,null,"PizzaMenu")," mis à jour :"),"\n",l.createElement(n.pre,{numbered:!0,highlighting:"1,4-6,8,18-23"},l.createElement(n.code,{className:"language-tsx"},'import { Pizza } from "../../types";\r\nimport "./PizzaMenu.css";\r\n\r\ninterface PizzaMenuProps {\r\n  pizzas: Pizza[];\r\n}\r\n\r\nconst PizzaMenu = ({ pizzas }: PizzaMenuProps) => {\r\n  return (\r\n    <table className="pizza-menu">\r\n      <thead>\r\n        <tr>\r\n          <th>Pizza</th>\r\n          <th>Description</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {pizzas.map((pizza) => (\r\n          <tr key={pizza.id}>\r\n            <td>{pizza.title}</td>\r\n            <td>{pizza.content}</td>\r\n          </tr>\r\n        ))}\r\n      </tbody>\r\n    </table>\r\n  );\r\n};\r\n\r\nexport default PizzaMenu;\n')),"\n",l.createElement(n.p,null,"Nous avons créé l'interface ",l.createElement(n.code,null,"Pizza")," dans un nouveau fichier ",l.createElement(n.code,null,"/src/types.ts")," :"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-ts"},"interface Pizza {\r\n  id: number;\r\n  title: string;\r\n  content: string;\r\n}\r\n\r\nexport type { Pizza };\n")),"\n",l.createElement(n.p,null,"Pour simplifier le développement, nous vous conseillons d'enlever l'",l.createElement(n.code,null,"autoPlay")," pour l'audio... Ca fera moins de bruit ; )"),"\n",l.createElement(n.p,null,"Voici la mise à jour du composant ",l.createElement(n.code,null,"Main")," afin de passer une variable d'état initialisée par les pizzas par défaut du menu (et enlever l'",l.createElement(n.code,null,"autoPlay")," de l'audio):"),"\n",l.createElement(n.pre,{numbered:!0,highlighting:"1-27,32,58,62"},l.createElement(n.code,{className:"language-tsx"},'const defaultPizzas = [\r\n  {\r\n    id: 1,\r\n    title: "4 fromages",\r\n    content: "Gruyère, Sérac, Appenzel, Gorgonzola, Tomates",\r\n  },\r\n  {\r\n    id: 2,\r\n    title: "Vegan",\r\n    content: "Tomates, Courgettes, Oignons, Aubergines, Poivrons",\r\n  },\r\n  {\r\n    id: 3,\r\n    title: "Vegetarian",\r\n    content: "Mozarella, Tomates, Oignons, Poivrons, Champignons, Olives",\r\n  },\r\n  {\r\n    id: 4,\r\n    title: "Alpage",\r\n    content: "Gruyère, Mozarella, Lardons, Tomates",\r\n  },\r\n  {\r\n    id: 5,\r\n    title: "Diable",\r\n    content: "Tomates, Mozarella, Chorizo piquant, Jalapenos",\r\n  },\r\n];\r\n\r\nconst Main = () => {\r\n  const [pizza, setPizza] = useState("");\r\n  const [description, setDescription] = useState("");\r\n  const [pizzas] = useState(defaultPizzas);\r\n\r\n  const handleSubmit = (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n    console.log("submit:", pizza, description);\r\n  };\r\n\r\n  const handlePizzaChange = (e: SyntheticEvent) => {\r\n    const pizzaInput = e.target as HTMLInputElement;\r\n    console.log("change in pizzaInput:", pizzaInput.value);\r\n    setPizza(pizzaInput.value);\r\n  };\r\n\r\n  const handleDescriptionChange = (e: SyntheticEvent) => {\r\n    const descriptionInput = e.target as HTMLInputElement;\r\n    console.log("change in descriptionInput:", descriptionInput.value);\r\n    setDescription(descriptionInput.value);\r\n  };\r\n\r\n  return (\r\n    <main>\r\n      <p>My HomePage</p>\r\n      <p>\r\n        Because we love JS, you can also click on the header to stop / start the\r\n        music ; )\r\n      </p>\r\n      <audio id="audioPlayer" controls >\r\n        <source src={sound} type="audio/mpeg" />\r\n        Your browser does not support the audio element.\r\n      </audio>\r\n      <PizzaMenu pizzas={pizzas} />\r\n      // Reste du code\n')),"\n",l.createElement(n.p,null,"L'application s'affiche comme auparavant."),"\n",l.createElement(n.p,null,"Nous allons maintenant faire en sorte que lors du submit, on mette à jour la variable d'état ",l.createElement(n.code,null,"pizzas"),"."),"\n",l.createElement(n.h1,null,l.createElement(s,null," Mise à jour de l'état en React ")),"\n",l.createElement(n.p,null,"En React, nous ne devons jamais mettre à jour l'état directement.\r\nLors du submit, nous pourrions être tenté de faire quelque chose du genre :"),"\n",l.createElement(n.pre,{highlighting:"6-7"},l.createElement(n.code,{className:"language-ts"},"const newPizza = {\r\n      id: nextPizzaId(pizzas),\r\n      title: pizza,\r\n      content: description,\r\n    };\r\npizzas.push(newPizza);  \r\nsetPizzas(pizzas);\n")),"\n",l.createElement(n.p,null,"👎 Si vous faites cela, ça pourrait marcher, et vous pourriez vous en sortir malgré tout.",l.createElement(n.br),"\n","Néanmoins, vous risquez d'avoir des soucis de debugging (vous ne pouvez pas suivre les changements d'états), d'optimisation, et même de comportement erratique..."),"\n",l.createElement(n.p,null,"👍 Retenez qu'en React, l'état est ",l.createElement(n.strong,null,"immuable"),". Si vous souhaitez le changer, vous devez chaque fois passer un nouvel objet à votre fonction mettant à jour l'état."),"\n",l.createElement(n.p,null,"Par exemple, pour mettre à jour un array, vous avez deux options. Soit vous utilisez la fonction ",l.createElement(n.code,null,"concat")," qui crée un nouvel array, ajoute l'élément, et renvoie le nouvel array :"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-ts"},"setPizzas(pizzas.concat(newPizza));\n")),"\n",l.createElement(n.p,null,"Soit vous utilisez le spread operator pour créer un nouvel array contenant tous les éléments de pizzas, en y ajoutant le dernier élément :"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-ts"},"setPizzas([...pizzas, newPizza]);\n")),"\n",l.createElement(n.p,null,"Voici le code final du  ",l.createElement(n.code,null,"Main")," dans lequel nous avons ajouté une fonction toute à la fin permettant de générer un identifiant :"),"\n",l.createElement(n.pre,{numbered:!0,highlighting:"43-53,132-134"},l.createElement(n.code,{className:"language-tsx"},'import {  SyntheticEvent, useState } from "react";\r\nimport sound from "../../assets/sounds/Infecticide-11-Pizza-Spinoza.mp3";\r\nimport DrinkCard from "./DrinkCard";\r\nimport DrinkMenu from "./DrinkMenu";\r\nimport "./Main.css";\r\nimport PizzaMenu from "./PizzaMenu";\r\nimport { Pizza } from "../../types";\r\n\r\n\r\nconst defaultPizzas = [\r\n  {\r\n    id: 1,\r\n    title: "4 fromages",\r\n    content: "Gruyère, Sérac, Appenzel, Gorgonzola, Tomates",\r\n  },\r\n  {\r\n    id: 2,\r\n    title: "Vegan",\r\n    content: "Tomates, Courgettes, Oignons, Aubergines, Poivrons",\r\n  },\r\n  {\r\n    id: 3,\r\n    title: "Vegetarian",\r\n    content: "Mozarella, Tomates, Oignons, Poivrons, Champignons, Olives",\r\n  },\r\n  {\r\n    id: 4,\r\n    title: "Alpage",\r\n    content: "Gruyère, Mozarella, Lardons, Tomates",\r\n  },\r\n  {\r\n    id: 5,\r\n    title: "Diable",\r\n    content: "Tomates, Mozarella, Chorizo piquant, Jalapenos",\r\n  },\r\n] ;\r\n\r\nconst Main = () => {\r\n  const [pizza, setPizza] = useState("");\r\n  const [description, setDescription] = useState("");\r\n  const [pizzas, setPizzas] = useState(defaultPizzas);\r\n\r\n  const handleSubmit = (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n    console.log("submit:", pizza, description);\r\n    const newPizza = {\r\n      id: nextPizzaId(pizzas),\r\n      title: pizza,\r\n      content: description,\r\n    };\r\n    \r\n    setPizzas([...pizzas, newPizza]);\r\n  };\r\n\r\n  const handlePizzaChange = (e: SyntheticEvent) => {\r\n    const pizzaInput = e.target as HTMLInputElement;\r\n    console.log("change in pizzaInput:", pizzaInput.value);\r\n    setPizza(pizzaInput.value);\r\n  };\r\n\r\n  const handleDescriptionChange = (e: SyntheticEvent) => {\r\n    const descriptionInput = e.target as HTMLInputElement;\r\n    console.log("change in descriptionInput:", descriptionInput.value);\r\n    setDescription(descriptionInput.value);\r\n  };\r\n\r\n  return (\r\n    <main>\r\n      <p>My HomePage</p>\r\n      <p>\r\n        Because we love JS, you can also click on the header to stop / start the\r\n        music ; )\r\n      </p>\r\n      <audio id="audioPlayer" controls >\r\n        <source src={sound} type="audio/mpeg" />\r\n        Your browser does not support the audio element.\r\n      </audio>\r\n      <PizzaMenu pizzas={pizzas} />\r\n\r\n      <div>\r\n        <br />\r\n        <form onSubmit={handleSubmit}>\r\n          <label htmlFor="pizza">Pizza</label>\r\n          <input\r\n            value={pizza}\r\n            type="text"\r\n            id="pizza"\r\n            name="pizza"\r\n            onChange={handlePizzaChange}\r\n            required\r\n          />\r\n          <label htmlFor="description">Description</label>\r\n          <input\r\n            value={description}\r\n            type="text"\r\n            id="description"\r\n            name="description"\r\n            onChange={handleDescriptionChange}\r\n            required\r\n          />\r\n          <button type="submit">Ajouter</button>\r\n        </form>\r\n      </div>\r\n\r\n      <DrinkMenu title="Notre Menu de Boissons">\r\n        <DrinkCard\r\n          title="Coca-Cola"\r\n          image="https://media.istockphoto.com/id/1289738725/fr/photo/bouteille-en-plastique-de-coke-avec-la-conception-et-le-chapeau-rouges-d%C3%A9tiquette.jpg?s=1024x1024&w=is&k=20&c=HBWfROrGDTIgD6fuvTlUq6SrwWqIC35-gceDSJ8TTP8="\r\n        >\r\n          <p>Volume: 33cl</p>\r\n          <p>Prix: 2,50 €</p>\r\n        </DrinkCard>\r\n        <DrinkCard\r\n          title="Pepsi"\r\n          image="https://media.istockphoto.com/id/185268840/fr/photo/bouteille-de-cola-sur-un-fond-blanc.jpg?s=1024x1024&w=is&k=20&c=xdsxwb4bLjzuQbkT_XvVLyBZyW36GD97T1PCW0MZ4vg="\r\n        >\r\n          <p>Volume: 33cl</p>\r\n          <p>Prix: 2,50 €</p>\r\n        </DrinkCard>\r\n        <DrinkCard\r\n          title="Eau Minérale"\r\n          image="https://media.istockphoto.com/id/1397515626/fr/photo/verre-deau-gazeuse-%C3%A0-boire-isol%C3%A9.jpg?s=1024x1024&w=is&k=20&c=iEjq6OL86Li4eDG5YGO59d1O3Ga1iMVc_Kj5oeIfAqk="\r\n        >\r\n          <p>Volume: 50cl</p>\r\n          <p>Prix: 1,50 €</p>\r\n        </DrinkCard>\r\n      </DrinkMenu>\r\n    </main>\r\n  );\r\n};\r\n\r\nconst nextPizzaId = (pizzas: Pizza[]) => {\r\n  return pizzas.reduce((maxId, pizza) => Math.max(maxId, pizza.id), 0) + 1;\r\n};\r\n\r\nexport default Main;\n')),"\n",l.createElement(n.p,null,"Notons que la fonction ",l.createElement(n.code,null,"reduce")," est très intéressante :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"c'est de la programmation fonctionnelle, ",l.createElement(n.code,null,"reduce")," reçoit une fonction en paramètre (on appelle ça une callback)"),"\n",l.createElement(n.li,null,"elle permet d'itérer sur tous les éléments d'une collection, en appelant la callback sur chaque élément de la collection ; chaque élément est reçu dans le deuxième argument de la callback appelé ",l.createElement(n.code,null,"pizza")," ici ;"),"\n",l.createElement(n.li,null,"à chaque appel de la callback, le résultat de l'itération précédente est récupéré dans le 1er argument de la callback appelé ",l.createElement(n.code,null,"maxId")," ici ;"),"\n",l.createElement(n.li,null,"à la 1ère itération, on considère la valeur ",l.createElement(n.code,null,"0")," comme valeur précédente ; c'est d'ailleurs la valeur ",l.createElement(n.code,null,"0")," qui serait renvoyée s'il n'y a pas d'éléments dans la collection."),"\n"),"\n",l.createElement(n.h1,null,l.createElement(s,null," Exercice 2.7 : Gestion d'une collection pour l'état  ")),"\n",l.createElement(n.p,null,"Veuillez créer un nouveau projet en utilisant les technos Vite + React + TS + SWC nommé ",l.createElement(n.code,null,"/exercises/2.7")," dans votre git repo."),"\n",l.createElement(n.p,null,"Veuillez créer une nouvelle application qui vous permette, dans la même page :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"d'afficher 5 de vos films préférés."),"\n",l.createElement(n.li,null,"d'ajouter un film via un formulaire."),"\n"),"\n",l.createElement(n.p,null,"Un film devra avoir :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"un titre"),"\n",l.createElement(n.li,null,"un director"),"\n",l.createElement(n.li,null,"une durée en minutes"),"\n"),"\n",l.createElement(n.p,null,"Un film pourra avoir :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"un lien vers une image"),"\n",l.createElement(n.li,null,"une description"),"\n",l.createElement(n.li,null,"un budget (en million)"),"\n"),"\n",l.createElement(n.p,null,"Une fois tout fonctionnel, veuillez faire un commit avec le message suivant : ",l.createElement(n.strong,null,l.createElement(n.code,null,"new:ex2.7"))),"\n",l.createElement(n.h1,null,l.createElement(s,null," Gestion d'un état partagé par plusieurs composants  ")),"\n",l.createElement(n.p,null,"Quand un état est partagé par plusieurs composants, sa gestion peut se compliquer."),"\n",l.createElement(n.p,null,"Pour notre tutoriel, afin de bien structurer notre code, nous allons créer un nouveau composant ",l.createElement(n.code,null,"AddPizza")," dans ",l.createElement(n.code,null,"/src/components/Main/AddPizza.tsx")," :"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-tsx"},'import { useState, SyntheticEvent } from "react";\r\n\r\nimport { NewPizza } from "../../types";\r\n\r\ninterface AddPizzaProps {\r\n  addPizza: (pizza: NewPizza) => void;\r\n}\r\n\r\nconst AddPizza = ({ addPizza }: AddPizzaProps) => {\r\n  const [pizza, setPizza] = useState("");\r\n  const [description, setDescription] = useState("");\r\n\r\n  const handleSubmit = (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n    console.log("submitting pizza:", pizza, description);\r\n    addPizza({ title: pizza, content: description });\r\n  };\r\n\r\n  const handlePizzaChange = (e: SyntheticEvent) => {\r\n    const pizzaInput = e.target as HTMLInputElement;\r\n    console.log("change in pizzaInput:", pizzaInput.value);\r\n    setPizza(pizzaInput.value);\r\n  };\r\n\r\n  const handleDescriptionChange = (e: SyntheticEvent) => {\r\n    const descriptionInput = e.target as HTMLInputElement;\r\n    console.log("change in descriptionInput:", descriptionInput.value);\r\n    setDescription(descriptionInput.value);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <form onSubmit={handleSubmit}>\r\n        <label htmlFor="pizza">Pizza</label>\r\n        <input\r\n          value={pizza}\r\n          type="text"\r\n          id="pizza"\r\n          name="pizza"\r\n          onChange={handlePizzaChange}\r\n          required\r\n        />\r\n        <label htmlFor="description">Description</label>\r\n        <input\r\n          value={description}\r\n          type="text"\r\n          id="description"\r\n          name="description"\r\n          onChange={handleDescriptionChange}\r\n          required\r\n        />\r\n        <button type="submit">Ajouter</button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AddPizza;\n')),"\n",l.createElement(n.p,null,"Nous avons créé un nouveau type ",l.createElement(n.code,null,"NewPizza")," qui est quasi identique au type ",l.createElement(n.code,null,"Pizza"),", à la différence qu'il ne contient pas d'id :"),"\n",l.createElement(n.pre,{numbered:!0,highlighting:"7,9"},l.createElement(n.code,{className:"language-ts"},'interface Pizza {\r\n  id: number;\r\n  title: string;\r\n  content: string;\r\n}\r\n\r\ntype NewPizza = Omit<Pizza, "id">;\r\n\r\nexport type { Pizza, NewPizza };\n')),"\n",l.createElement(n.p,null,"Le composant ",l.createElement(n.code,null,"AddPizza")," reçoit de son parent la callback qui permet de mettre à jour l'état géré par le parent !"),"\n",l.createElement(n.p,null,"💭 Nous pouvons maintenant bien assimiler comment un composant \"enfant\" peut renvoyer de l'information à son parent. C'est via la callback que l'enfant reçoit, lorsqu'il l'appelle, qu'il passera en paramètre ses données. Ici, l'enfant passe comme info au parent une nouvelle pizza : ",l.createElement(n.code,null,"addPizza({ title: pizza, content: description });")),"\n",l.createElement(n.p,null,"Il est à noter que comme l'enfant n'a pas accès à toutes les pizzas et leur identifiants, c'est le parent qui devra générer un identifiant."),"\n",l.createElement(n.p,null,"Ainsi, le composant ",l.createElement(n.code,null,"Main")," est simplifié en faisant appel à ",l.createElement(n.code,null,"AddPizza")," :"),"\n",l.createElement(n.pre,{numbered:!0,highlighting:"8,44-47,65"},l.createElement(n.code,{className:"language-tsx"},'import {  useState } from "react";\r\nimport sound from "../../assets/sounds/Infecticide-11-Pizza-Spinoza.mp3";\r\nimport DrinkCard from "./DrinkCard";\r\nimport DrinkMenu from "./DrinkMenu";\r\nimport "./Main.css";\r\nimport PizzaMenu from "./PizzaMenu";\r\nimport { NewPizza, Pizza } from "../../types";\r\nimport AddPizza from "./AddPizza";\r\n\r\n\r\nconst defaultPizzas = [\r\n  {\r\n    id: 1,\r\n    title: "4 fromages",\r\n    content: "Gruyère, Sérac, Appenzel, Gorgonzola, Tomates",\r\n  },\r\n  {\r\n    id: 2,\r\n    title: "Vegan",\r\n    content: "Tomates, Courgettes, Oignons, Aubergines, Poivrons",\r\n  },\r\n  {\r\n    id: 3,\r\n    title: "Vegetarian",\r\n    content: "Mozarella, Tomates, Oignons, Poivrons, Champignons, Olives",\r\n  },\r\n  {\r\n    id: 4,\r\n    title: "Alpage",\r\n    content: "Gruyère, Mozarella, Lardons, Tomates",\r\n  },\r\n  {\r\n    id: 5,\r\n    title: "Diable",\r\n    content: "Tomates, Mozarella, Chorizo piquant, Jalapenos",\r\n  },\r\n] ;\r\n\r\nconst Main = () => {\r\n\r\n  const [pizzas, setPizzas] = useState(defaultPizzas);\r\n\r\n\r\n  const addPizza = (newPizza:NewPizza) => {   \r\n    const pizzaAdded = { ...newPizza, id: nextPizzaId(pizzas) };\r\n    setPizzas([...pizzas, pizzaAdded]);\r\n  };\r\n\r\n\r\n  return (\r\n    <main>\r\n      <p>My HomePage</p>\r\n      <p>\r\n        Because we love JS, you can also click on the header to stop / start the\r\n        music ; )\r\n      </p>\r\n      <audio id="audioPlayer" controls >\r\n        <source src={sound} type="audio/mpeg" />\r\n        Your browser does not support the audio element.\r\n      </audio>\r\n      <PizzaMenu pizzas={pizzas} />\r\n\r\n      <div>\r\n        <br />\r\n        <AddPizza addPizza={addPizza} />\r\n      </div>\r\n\r\n      <DrinkMenu title="Notre Menu de Boissons">\r\n        <DrinkCard\r\n          title="Coca-Cola"\r\n          image="https://media.istockphoto.com/id/1289738725/fr/photo/bouteille-en-plastique-de-coke-avec-la-conception-et-le-chapeau-rouges-d%C3%A9tiquette.jpg?s=1024x1024&w=is&k=20&c=HBWfROrGDTIgD6fuvTlUq6SrwWqIC35-gceDSJ8TTP8="\r\n        >\r\n          <p>Volume: 33cl</p>\r\n          <p>Prix: 2,50 €</p>\r\n        </DrinkCard>\r\n        <DrinkCard\r\n          title="Pepsi"\r\n          image="https://media.istockphoto.com/id/185268840/fr/photo/bouteille-de-cola-sur-un-fond-blanc.jpg?s=1024x1024&w=is&k=20&c=xdsxwb4bLjzuQbkT_XvVLyBZyW36GD97T1PCW0MZ4vg="\r\n        >\r\n          <p>Volume: 33cl</p>\r\n          <p>Prix: 2,50 €</p>\r\n        </DrinkCard>\r\n        <DrinkCard\r\n          title="Eau Minérale"\r\n          image="https://media.istockphoto.com/id/1397515626/fr/photo/verre-deau-gazeuse-%C3%A0-boire-isol%C3%A9.jpg?s=1024x1024&w=is&k=20&c=iEjq6OL86Li4eDG5YGO59d1O3Ga1iMVc_Kj5oeIfAqk="\r\n        >\r\n          <p>Volume: 50cl</p>\r\n          <p>Prix: 1,50 €</p>\r\n        </DrinkCard>\r\n      </DrinkMenu>\r\n    </main>\r\n  );\r\n};\r\n\r\nconst nextPizzaId = (pizzas: Pizza[]) => {\r\n  return pizzas.reduce((maxId, pizza) => Math.max(maxId, pizza.id), 0) + 1;\r\n};\r\n\r\nexport default Main;\n')),"\n",l.createElement(n.p,null,"💭 Vous devriez à présent avoir les réponses à ces questions :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Comment passer de l'info d'un parent vers ses enfants ?"),"\n",l.createElement(n.li,null,"Comment passer de l'info d'un enfant vers un ancêtre ?"),"\n",l.createElement(n.li,null,"Comment passer de l'info d'un sibling (frère ou sœur) vers un autre sibling ?"),"\n"),"\n",l.createElement(n.p,null,"Si nécessaire, vous pouvez trouver le code associé à ce tutoriel ici : ",l.createElement(n.a,{href:"https://github.com/e-vinci/ts-demos/tree/main/front/medium-state"},"medium-state"),"."),"\n",l.createElement(n.h1,null,l.createElement(s,null," Debugging d'une application React  ")),"\n",l.createElement(n.h2,null,"Introduction"),"\n",l.createElement(n.p,null,"💭 Qui est votre meilleur ami ?"),"\n",l.createElement(n.p,null,"Il est possible qu'à ce stade-ci, vous ignorez une des bonnes réponses, car pour les développeurs, le debugger est leur meilleur ami !"),"\n",l.createElement(n.p,null,"Le debugger est toujours là pour vous, prêt à vous faire voyager pas à pas dans votre code, à vous donner des pistes dans les moments difficiles, sans imposer de solutions, il vous offre une liberté totale ! Et il acceptera toujours votre code tel qu'il est, sous réserve bien sûr que celui-ci compile.\r\nC'est exactement ce que l'on attend d'un ami 😁."),"\n",l.createElement(n.h2,null,"Debugging sous Chrome"),"\n",l.createElement(n.p,null,"Pour accéder aux outils de debugging sous Chrome :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Soit clic droit sur votre page Web, ",l.createElement(n.code,null,"Inspect"),"."),"\n",l.createElement(n.li,null,"Soit ",l.createElement(n.code,null,"F12"),"."),"\n",l.createElement(n.li,null,"Clic sur le tab ",l.createElement(n.code,null,"Sources"),"."),"\n",l.createElement(n.li,null,"Dans ",l.createElement(n.code,null,"localhost:5173")," (ou un autre port en fonction du port associé à votre app, ",l.createElement(n.code,null,"5173")," est le port par défaut d'une application exécutée par ",l.createElement(n.code,null,"Vite"),"), dans ",l.createElement(n.code,null,"src"),", vous trouverez vos fichiers ",l.createElement(n.code,null,".tsx"),". Il y a chaque fois deux versions d'un même fichier ; celle qui vous intéresse est celle dont le nom de fichier est écrit en italique : c'est un map de vos sources contenant le code TSX / TS."),"\n"),"\n",l.createElement(n.p,null,"Pour déboguer un fichier ",l.createElement(n.code,null,".tsx")," ou ",l.createElement(n.code,null,".ts")," :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"Ajout de breakpoint : clic sur le numéro de la ligne à gauche du code."),"\n"),"\n",l.createElement(n.li,null,"\n",l.createElement(n.p,null,"Utilisation des flèches pour exécuter et naviguer dans le code :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.code,null,"Step over")," : pour aller à la ligne de code suivante."),"\n",l.createElement(n.li,null,l.createElement(n.code,null,"Step into")," : pour entrer dans une fonction."),"\n",l.createElement(n.li,null,l.createElement(n.code,null,"Resume")," : pour aller au prochain breakpoint, est souvent utilisé quand on veut avancer plus vite dans du code contenant de nombreuses lignes."),"\n"),"\n",l.createElement(n.h2,null,"Debugging dans VS code"),"\n",l.createElement(n.p,null,"Veuillez ouvrir votre application dans VS Code en tant que Workspace. Pour ce faire : ",l.createElement(n.code,null,"File"),", ",l.createElement(n.code,null,"Open Folder...")," et sélectionnez le répertoire de votre application Vite + React + TS."),"\n",l.createElement(n.p,null,"La toute première fois, vous devez créer une configuration pour votre debugger :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Cliquez sur `Run and Debug."),"\n",l.createElement(n.li,null,"Cliquez sur ",l.createElement(n.code,null,"create a launch.json file"),"."),"\n",l.createElement(n.li,null,"Sélectionnez ",l.createElement(n.code,null,"Web App (Chrome)"),"."),"\n"),"\n",l.createElement(n.p,null,"Vous obtenez une configuration dans ",l.createElement(n.code,null,".vscode/launch.json"),". Veuillez changer le port de l'url vers le port par défaut de ",l.createElement(n.code,null,"Vite")," (",l.createElement(n.code,null,"5173"),"):"),"\n"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-json"},'  {\r\n    // Use IntelliSense to learn about possible attributes.\r\n    // Hover to view descriptions of existing attributes.\r\n    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\r\n    "version": "0.2.0",\r\n    "configurations": [\r\n        {\r\n            "type": "chrome",\r\n            "request": "launch",\r\n            "name": "Launch Chrome against localhost",\r\n            "url": "http://localhost:5173",\r\n            "webRoot": "${workspaceFolder}"\r\n        }\r\n    ]\r\n}\n')),"\n",l.createElement(n.p,null,"D'abord lancez votre application à l'aide de la commande habituelle : ",l.createElement(n.code,null,"npm run dev"),"."),"\n",l.createElement(n.p,null,"Maintenant que votre application tourne, vous allez lui attacher le debugger.  Il suffit de cliquer sur ",l.createElement(n.code,null,"F5")," pour lancer le debugger."),"\n",l.createElement(n.h1,null,l.createElement(s,null," 🍬 Challenge optionnel 2.8 : gestion d'un état partagé  ")),"\n",l.createElement(n.p,null,"Si vous le souhaitez, et que vous vous sentez avancé dans ce cours, vous pourriez découvrir des concepts par vous-même à travers ce challenge. Vous pouvez créer un nouveau projet en copiant le code du tutoriel nommé ",l.createElement(n.code,null,"medium-state")," en tant que répertoire ",l.createElement(n.code,null,"/exercises/2.8")," dans votre git repo."),"\n",l.createElement(n.p,null,"Vous avez remarqué que dans le composant ",l.createElement(n.code,null,"Main"),', il est écrit : "Because we love JS, you can also click on the header to stop / start the music ; )"'),"\n",l.createElement(n.p,null,"Vous pourriez choisir cette mission : à l'aide de JS/TS, veuillez faire en sorte que l'on puisse cliquer sur le ",l.createElement(n.code,null,"Header")," et que cela démarre ou stop la musique de l'élément ",l.createElement(n.code,null,"<audio>")," présent dans le main."),"\n",l.createElement(n.h3,null,"🤝 Tips"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Utilisation du Hook ",l.createElement(n.code,null,"useRef")," pour obtenir une référence directe et persistante à l'élément ",l.createElement(n.code,null,"<audio>"),", qui peut être mutée, ce qui permet d'interagir avec cet élément DOM de manière impérative, par exemple pour appeler la méthode ",l.createElement(n.code,null,"play")," ou ",l.createElement(n.code,null,"pause"),". L'avantage de cette méthode c'est qu'elle ne provoque pas de re-render du composant quand il est mis à jour (à l'inverse de si l'on faisait de la programmation old-school avec ",l.createElement(n.code,null,"document.getElementById")," pour récupérer une référence à ",l.createElement(n.code,null,"<audio>"),")."),"\n",l.createElement(n.li,null,"Utilisation du Hook ",l.createElement(n.code,null,"useEffect")," pour réaliser une action à chaque fois que l'on a une action à réaliser parce qu'il y aurait eu un clic dans le Header. Dans ce cas-ci, il faudrait bien comprendre le ",l.createElement(n.code,null,"useEffect")," pour l'associer au changement d'une variable d'état (qui représente s'il y a besoin d'une action à faire à cause d'un clic dans le header)."),"\n"),"\n",l.createElement(n.p,null,"Une fois tout fonctionnel, veuillez faire un commit avec le message suivant : ",l.createElement(n.strong,null,l.createElement(n.code,null,"new:ex2.8+")),"."))}var o=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,r.RP)(),e.components);return n?l.createElement(n,e,l.createElement(a,e)):a(e)};function i(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}var u=t(4810),s=t(2662),c=t(9640),m=t(5938),p=t(9460),d=t(7929),z=t(794),E=t(4092),g=t(4262),v=t(3528),h=t(9942),f=t(4698),b=t(2214),P=t(9838),q=(t(1262),t(1731)),y=t(7050),I=t(2483),M=t(4902),S=t(9294),C=t(7828),x=t(2035),k=t(5590);const D={Link:u.Link,Image:c.A,Section:m.A,Content:p.A,Background:d.A,SectionHeader:z.A,SectionFooter:E.A,PageHeader:g.A,CodeBlock:h.A,LinkFile:f.A,ScrollableImage:b.A,PublicProjectsView:P.A,AuthenticatedBlock:q.A,UnAuthenticatedBlock:y.A,NestedMdxBlock:I.A,YoutubeImage:M.A,InternalPageMenu:S.A,InternalPageMenuItem:C.A,InternalPageTitle:x.A,PathViewer:k.E,PathViewerItem:k.F};function j(e){var n,t,a,o,i;let{data:{mdx:u,allImages:c},children:m}=e;return D.PageHeader=(0,v.R)(g.A,null==u?void 0:u.frontmatter),l.createElement(s.A,Object.assign({},null!=u&&u.frontmatter?{frontmatter:u.frontmatter}:{},null!=u&&null!==(n=u.frontmatter)&&void 0!==n&&n.navbarExtraStyles?{navbarExtraStyles:u.frontmatter.navbarExtraStyles}:{},null!=u&&null!==(t=u.frontmatter)&&void 0!==t&&t.headerImage?{headerImage:u.frontmatter.headerImage}:{},null!=u&&null!==(a=u.frontmatter)&&void 0!==a&&a.featuredImage?{featuredImage:u.frontmatter.featuredImage}:{},null!=u&&null!==(o=u.frontmatter)&&void 0!==o&&o.title?{pageTitle:u.frontmatter.title}:{},c&&c.length>0?{allImages:c}:{}),l.createElement(r.xA,{components:D},l.createElement("div",{className:null!=u&&null!==(i=u.frontmatter)&&void 0!==i&&i.autoMargin?"page page--auto-margin ":"page"},m)))}function A(e){return l.createElement(j,e,l.createElement(o,e))}}}]);
//# sourceMappingURL=component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-medium-state-fr-mdx-4efd78aa1e1fbae12786.js.map