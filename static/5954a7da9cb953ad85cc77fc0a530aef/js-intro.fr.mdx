---
title: "JS & browser"
description: "JS dans un browser"
---

# a) JS dans un browser

<InternalPageMenu>
  <PathViewer>
    <PathViewerItem to="/"> web2course </PathViewerItem>
    <PathViewerItem to="/part2"> Partie 2 </PathViewerItem>
    <PathViewerItem selected> a) JS & Browser </PathViewerItem>
  </PathViewer>
  <InternalPageMenuItem> O√π mettre du code JS ? </InternalPageMenuItem>
  <InternalPageMenuItem> Comment fonctionne un browser pour afficher une page ? </InternalPageMenuItem>
  <InternalPageMenuItem> Comment interagir avec son browser ? </InternalPageMenuItem>
  <InternalPageMenuItem> JS & la norme ECMAScript </InternalPageMenuItem>
  <InternalPageMenuItem> Exercice 2.1 : 1er script externe </InternalPageMenuItem>
</InternalPageMenu>


Pour d√©marrer avec les UI (User Interfaces), nous allons d√©velopper des applications web classiques, fa√ßon "old school".

Nous n'allons pas utiliser d'outils pour g√©rer les d√©pendances de nos applications, nous allons int√©grer ces d√©pendances directement √† l'aide de balises **`<script>`**.

<div className="card card__simple-youtube-container">
    <YoutubeImage src="https://youtu.be/JsOn4wV5Prk" />
</div>

# <InternalPageTitle> O√π mettre du code JS ? </InternalPageTitle>

## Introduction

Le JavaScript a √©t√© cr√©√© en 1995 par Brendan Eich pour rendre les pages web interactives et ainsi am√©liorer l'exp√©rience utilisateur.

Le JS permet de cr√©er des interactions avec l'HTML et le CSS d'un browser.

Il s'ex√©cute apr√®s la g√©n√©ration d'une page web comprenant du HTML et potentiellement du CSS.

Les bases du langage JS sont reprises dans l'introduction de ce cours, au points [c) Introduction au langage JS](../../part0/js-language).

Si vous ne connaissez pas encore bien la syntaxe du langage JS, il est important de (re)lire cette introduction avant d'aller plus loin.

Il existe plusieurs fa√ßon de mettre du code JS pour interagir avec une page web.

## Directement dans le browser

üëç Pour ce cours, nous vous recommandons d'installer et d'utiliser **Chrome** comme browser.

Ce browser moderne facilite grandement le d√©veloppement d'applications web. Toutes les indications donn√©es dans ce cours concernant les fonctionnalit√©s de d√©veloppement offertes par un browser seront illustr√©e par **Chrome** uniquement.

Si vous choisissez un autre browser, il vous faudra donc trouver l'√©quivalent par vous-m√™me.

Pour acc√©der √† un environnement vous permettant d'introduire du JS directement dans votre browser, vous allez acc√©der √† la **console** de votre browser. Pour ce faire, lorsque votre browser est ouvert, tapez : 
- soit **`F12`** ;
- soit **`CTRL + SHIFT + i`** ;
- soit clic droit sur la fen√™tre de votre browser, puis **`Inspecter`**.

Il faut ensuite s√©lectionner l'onglet **`Console`** du browser.

<ScrollableImage name="console.PNG" minWidth="400px" maxWidth="600px" />

<figcaption>Utilisation de la console pour faire un calcul</figcaption>

Veuillez copier/coller ce code dans la console de votre browser et observer le r√©sultat.

```js
let message = "Hello world!";
console.log(message);
```

## Dans une page HTML

### Introduction

Il existe plusieurs fa√ßons d'associer du JS √† une page HTML.

Pour √©crire du code JS, de l'HTML ou du CSS, vous aurez besoin d'un √©diteur de code. Il existe beaucoup d'√©diteurs.

üëç Pour √©crire du code, dans ce cours, nous vous recommandons d'installer, d√®s maintenant si ce n'est pas d√©j√† fait, **Visual Studio Code** : https://code.visualstudio.com/download [[R.18]](/references/#r18).

Lors de l'installation, nous vous recommandons de s√©lectionner l'option **`Open with code`**. Cela vous permettra d'ouvrir un projet directement en faisant un clic droit sur un dossier.

Toutes les indications donn√©es dans ce cours concernant les fonctionnalit√©s de d√©veloppement offertes par un √©diteur de code seront illustr√©e par **VS Code** uniquement. Notons que cet outil est Open Source et est support√© par une large communaut√© de d√©veloppeurs.

Il est possible que vous pr√©f√©riez utiliser un autre √©diteur de code ou IDE, comme un des outils de la suite JetBrains (IntelliJ ou WebStorm).

Si vous choisissez un de ces √©diteurs, il vous faudra donc trouver l'√©quivalent des outils de d√©veloppement pr√©sent√©s dans ce cours par vous-m√™me.

### Dans un fichier externe

üëç La fa√ßon recommand√©e pour associer du JS √† une page HTML, c'est de mettre le code JS dans un script externe, un fichier **`.js`**, et de faire appel √† ce code au sein de la page HTML, √† l'aide de **`<script src="file_name.js">`** juste avant la balise de fermeture **`</body>`**.

Nous verrons plus tard comment l'HTML est rendu au sein du browser. N√©anmoins, la raison pour laquelle il est recommand√© d'inclure le script JS √† la fin de la balise **`</body>`**, c'est pour nous assurer que si le JS doit interagir avec des √©l√©ments HTML, ceux-ci aient d√©j√† √©t√© rendu par le browser.

Afin d'avoir une visibilit√© de tout le code associ√© √† votre cours de JS, veuillez ouvrir votre r√©pertoire **`web2`** (cr√©√© dans le cadre de l'[Exercice 0.1](../part0/git/#exercice_0_1_creer_un_repository_local_et_distant_pour_gerer_vos_exercices_tutoriels)) √† l'aide de votre √©diteur de code. 

Dans VS Code, pour ce tutoriel, veuillez cr√©er le r√©pertoire **`/web2/tutorials/external-script`**.

NB : Pour ce faire, vous pouvez cliquer sur le r√©pertoire **`tutorials`** dans VS Code et ensuite sur l'ic√¥ne **`New Folder`**, et donner le nom voulu √† ce r√©pertoire (**`external-script`**).

Dans ce r√©pertoire, veuillez cr√©er un fichier HTML **`index.html`**.

NB : Si vous l'ignorez, vous pouvez cliquer sur **`external-script`** et ensuite sur l'ic√¥ne **`New File`**, et donnez le nom voulu √† ce fichier (**`index.html`**).

A ce stade-ci, votre r√©pertoire **`web2`** & VS Code devrait ressembler √† cela :

<ScrollableImage name="start.PNG" minWidth="400px" maxWidth="600px" />

Veuillez ajouter ce contenu √† **`index.html`** :

```html
<html>
  <head>
    <title>Demo : external JS script</title>
  </head>
  <body>
    <script src="external-script.js"></script>
    Hello everybody !
  </body>
</html>
```

On voit que ce fichier HTML est pr√™t √† accueillir un script externe.

Veuillez cr√©er le fichier **`external-script.js`** au sein du r√©pertoire **`external-script`** et y ajouter ce code ci :

```js
alert("Pop-up thanks to an external JS file.");
```

Il nous reste maintenant √† ex√©cuter cette application.

Comme c'est une application web, nous avons besoin d'un serveur web pour afficher cette page web dans les r√®gles de l'art.

Il existe une multitude de serveurs web : Apache, IIS (Microsoft Web Server)...

Lorsque nous d√©veloppons des applications web "old school", sans outil moderne pour g√©rer les
d√©pendances de notre application, nous allons utiliser un serveur web int√©gr√© √† VS Code.

Pour ce faire, veuillez installer l'extension **Live Server** de VS Code :

- Dans le menu de gauche de VS Code, cliquez sur l'ic√¥ne **`Extensions`** (4 petits carr√©s).
- Ecrivez **`Live Server`**.
- Cliquez sur **`Install`**.

Une fois install√©, vous pouvez lancer votre page web en faisant :

- Clic droit sur **`index.html`**,
- **`Open with Live Server`**

üéâ Votre browser par d√©faut s'ouvrira, affichant votre toute premi√®re page web contenant du JS c√¥t√© client !

Si  n'est pas Chrome qui s'ouvre, nous vous recommandons de changer les pr√©f√©rences de votre OS. Sous Windows, dans la barre de recherche, vous trouverez facilement l'utilitaire pour le faire. Par exemple, pour un OS Windows en anglais : **`Default apps`**, **`Web browser`**.

Si tout fonctionne bien, faites un **`commit`** de votre repo (**`web2`**) avec comme message : **`hmi first external script tutorial`**.

En cas de souci, vous pouvez acc√©der au code de cette d√©mo ici :
[hmi-external-script](https://github.com/e-vinci/js-demos/tree/main/frontend/js-location/external-script).

üëç Il est recommand√© de cr√©er des fichiers s√©par√©s pour chaque cat√©gorie de code : **`.html`**, **`.js`**, **`.css`**. Cela permet d'augmenter la lisibilit√© et la maintenabilit√© de votre code. 

Nous allons voir qu'il existe n√©anmoins d'autres fa√ßon d'int√©grer du JS, notamment en int√©grer celui directement aux fichiers HTML.

### Dans une fonction au sein d'une page HTML

üëé Il est possible d'ajouter du JS dans une fonction ou √©v√©nement associ√© √† un √©l√©ment HTML, n√©anmoins cela n'est pas recommand√© lorsqu'on √©crit du Vanilla JS. On appelle cette fa√ßon de faire du "Inline JavaScript".

L'application d√©velopp√©e au point pr√©c√©dent fournirait le m√™me genre de r√©sultat, avec un seul fichier HTML (**`index.html`**) :

```html numbered highlighting="6-7"
<html>
  <head>
    <title>Demo : internal JS in a function</title>
  </head>
  <body
    onload="alert('Pop-up thanks to an HTML attribute & a function.' 
    +'\nIt\'s not advised to add your scripts directly within the HTML.')"
  >
    <h1>Hello everyone ; )</h1>
  </body>
</html>
```

**`onload`** est un √©v√©nement qui se produira une fois que l'√©l√©ment **`body`** aura charg√© tout son contenu ; une fois charg√©, le code JS s'ex√©cutera et affichera donc un pop-up.

N'h√©sitez pas √† visualiser cette page √† l'aide de Live Server au sein de VS Code.

En Vanilla JS, ce genre de code est d√©conseill√©. Vous trouverez n√©anmoins beaucoup de code √©crit de cette fa√ßon sur le web.

Si plus tard, suite √† ce cours, vous veniez √† utiliser des frameworks comme React, vous d√©couvrirez que parfois on pr√©f√®re encapsuler l'HTML et le JS au sein de m√™mes fichiers.

### Dans une balise script au sein d'une page HTML

üëé Il est possible d'ajouter du JS dans une balise **script** au sein d'un page HTML, n√©anmoins cela n'est pas recommand√© lorsqu'on √©crit du Vanilla JS.

Avec un seul fichier HTML (**`index.html`**), voici comment il est possible d'afficher un pop-up :

```html numbered highlighting="6-11"
<html>
  <head>
    <title>Demo : internal script tag</title>
  </head>
  <body>
    <script>
      alert(
        "Pop-up thanks to a script tag." +
          "\nIt's not advised to add your scripts directly within the HTML."
      );
    </script>
    Hello world ; )
  </body>
</html>
```

# <InternalPageTitle> Comment fonctionne un browser pour afficher une page ? </InternalPageTitle>
## R√©ception des donn√©es

Dans une premi√®re √©tape, lorsque vous acc√©der √† l'URL d'un site web √† l'aide de votre browser, celui-ci va principalement recevoir des fichiers HTML, CSS & JS en retour, sous forme d'octets.

<ScrollableImage name="bytes.png" minWidth="600px" maxWidth="730px" />

[R√©ception des donn√©es par le browser [R.19]](/references/#r19)

## Cr√©ation des structures de donn√©es utiles

Une fois les donn√©es re√ßue, le browser doit pouvoir interpr√©ter les octets re√ßus. Gr√¢ce au "character encoding", √† notre √©poque nous devrions tous utiliser **utf-8**, le browser peut faire la transformation de ces octets vers des caract√®res.

A partir des caract√®res, le browser peut commencer le parsing de chaque fichier, en identifiant les tokens, des structures de donn√©es identifiant les diff√©rents tags HTML & leurs attributs.

A partir de ces tokens, le browser va cr√©er des nodes et les lier entre eux sous forme d'un arbre. C'est cette structure de donn√©es que nous appelons le Document Object Model (DOM).

<ScrollableImage name="dom.png" minWidth="600px" maxWidth="730px" />

[Construction du DOM par le browser [R.19]](/references/#r19)

Au fur et √† mesure que le browser re√ßoit des donn√©es et construit le DOM, il peut tomber sur une balise incluant du CSS, comme par exemple :

```html
<head>
  <link rel="stylesheet" type="text/css" href="main.css" />
</head>
```

Dans ce cas, le browser va initialiser un process √©quivalent au DOM, mais pour cr√©er une structure de donn√©es traitant des √©l√©ments de style, le CSS Object Model (CSSOM) :

<ScrollableImage name="cssom.png" minWidth="600px" maxWidth="730px" />

[Construction du CSSOM par le browser [R.19]](/references/#r19)

## Cr√©ation du render tree

Les structures du DOM & du CSSOM sont ind√©pendantes.

Le browser va combiner ces deux structures en un "render tree".

<ScrollableImage name="render.png" minWidth="600px" maxWidth="730px" />

[Construction du render tree par le browser [R.19]](/references/#r19)

<br />

S'il y a des √©l√©ments cach√©s par le biais du CSS, ceux-ci seront pr√©sents dans le DOM, mais pas dans le render tree.

## Cr√©ation du layout

L'√©tape qui suit est de cr√©er le layout, √©tape parfois nomm√©e "reflow". Le browser va calculer la taille et la position exacte de chaque √©l√©ment √† rendre (de l'anglais "render"), c'est-√†-dire √† afficher sur la page.

## Affichage des √©l√©ments

Sur base du render tree & du layout, le browser peut finalement "peindre" les diff√©rents nodes √† l'√©cran et donc rendre la page !

## Et le JS ?

Lors de la cr√©ation du DOM, s'il y a une balise script, et bien le script JS sera t√©l√©charg√©. La construction du DOM sera "bloqu√©e" jusqu'√† la fin de l'ex√©cution du script.

De la m√™me fa√ßon, l'ex√©cution du CSSOM sera stopp√©e si le JS acc√®dent au style d'un √©l√©ment HTML.

Il est donc important de faire attention o√π l'on met ses scripts JS. C'est pourquoi, lorsqu'on souhaite interagir avec des √©l√©ments pr√©sents dans l'HTML, il faut mettre la balise script incluant le JS √† la fin de la balise **body**.

Le JS va donc pouvoir √™tre utilis√© tant pour cr√©er des √©l√©ments du DOM & du CSSOM que pour interagir avec ceux-ci et rendre nos pages web int√©ressantes et "user friendly".

# <InternalPageTitle> Comment interagir avec son browser ? </InternalPageTitle>

Les browser mettent √† disposition des API (Application Programming Interface), des librairies permettant d'interagir avec les pages web.

<ScrollableImage name="browser.png" minWidth="600px" maxWidth="730px" />

[Relation entre API & le browser [R.20]](/references/#r20)

Les "Third party APIs" sont localis√©es sur des serveurs externes : lien vers une libraire JS, appel vers des web services comme Twitter, Google Maps‚Ä¶

Les "Browser APIs" sont int√©gr√©es au browser et permettent d'interagir avec celui-ci.

Voici quelques exemples d'API du browser pour :

- Manipuler des pages web : **DOM API** ; c'est l'API la plus importante quand on fait du d√©veloppement d'IHM.
- Dessiner / animer : **Canvas** & **WebGL** ;
- Communiquer des donn√©es avec un serveur : **Fetch API**, et anciennement **XMLHttpRequest** ;
- G√©rer des flux audio & vid√©o : **Audio & Video APIs**
- G√©rer la persistance de donn√©es : **Web Storage APIs** (**cookies**, **localStorage**, **sessionStorage**‚Ä¶)

Via des objets JS, ce sont ces API que nous allons utiliser dans nos scripts JS, afin de cr√©er des pages web interactives.

Il n'existe pas de standard pour le Browser Object Model.

Voici une vue des diff√©rents objets JS qui permettent d'accc√©der au Browser Object Model :

<ScrollableImage name="bom.png" minWidth="360px" maxWidth="360px" />

[Les objets JS offerts par le browser [R.21]](/references/#r21)

Voici quelques explications concernant le r√¥le de certains de ces objets :

- **`window`** : objet manipulant la fen√™tre du browser m√™me, il offre des fonctions comme : **`alert()`**, **`prompt()`**‚Ä¶
- **`navigator`** (**`===window.navigator`**) : objet contenant de l'information sur le browser, comme par exemple :
  **`navigator.appName`**, **`navigator.appVersion`**.
- **`location`** : (**`===window.location`**) objet repr√©sentant l'URL de la page ; il offre des propri√©t√©s & m√©thodes comme :
  - **`location.href`** :l'URL de la page affich√©e.
  - **`location.reload()`** : recharge la page.
  - **`location.replace('https://URL_INDIQUEE')`** : navigue vers l'URL indiqu√©e.
- **`document`** : (**`===window.document`**) objet manipulant le corps de l'HTML & du CSS de la page. Nous allons tout prochainement approfondir les propri√©t√©s & m√©thodes mises √† disposition par cet objet JS.

# <InternalPageTitle> JS & la norme ECMAScript </InternalPageTitle>

La norme ECMAScript, le standard pour le JS c√¥t√© client, a d√©bouch√© sur de multiples impl√©mentations du JS (ActionScript, JScript, JavaScript, CommonJS...).

ECMAScript est utilis√© g√©n√©ralement pour des scripts c√¥t√© client, mais de plus en plus est aussi utilis√© c√¥t√© serveur avec Node.js.

A la mi-juin 2023, la version en cours approuv√©e de ECMAScript est ECMAScript 2022 [[R.24]](/references/#r24).

Par exemple, ECMAScript 2015 (aussi appel√©e ES6) √† mis en place de nouveaux √©l√©ments importants au sein du JS : **`arrow functions`**, **`let`** & **`const`**, **`Promise`**, **`class`**‚Ä¶

ECMAScript 2015 (ES6) est support√© par la majorit√© des browsers modernes, mais pas par IE !

üëç Nous vous recommandons d'√©crire du code moderne conforme √† ES6 ou une version plus r√©cente.
Si vos applications doivent supporter de vieux browsers, vous devriez utiliser des outils comme Babel qui automatiquement convertiront votre code ES6+ vers des versions de JS plus anciennes.

Si l'aspect normatif vous passionne et que vous souhaitez suivre les propositions d'inclusion dans la norme : https://tc39.es/ [[R.25]](/references/#r25).

# <InternalPageTitle> Exercice 2.1 : 1er script externe </InternalPageTitle>

Via un script JS externe, veuillez cr√©er une application web affichant, au chargement d'une page HTML, un pop-up dont le message reprend la date et l'heure au moment de l'affichage de ce pop-up.

Ce m√™me message doit √™tre affich√© dans la console.

Pour ce faire, vous allez cr√©er, puis appeler, une fonction **`addDateTime(message)`** qui renvoie une string concat√©nant :

- la date et l'heure √† l'appel de la fonction ; 
- le **`message`** pass√© en argument de la fonction.

Par exemple, si le **`message`** est *"This is the best moment to have a look at this website !"*, le pop-up affichera quelque chose du genre *"06/09/2022 14:59 : This is the best moment to have a look at this website !"*.

Veuillez cr√©er un nouveau projet dans votre repository local et votre web repository (normalement appel√© **`web2`**) nomm√© **`/exercises/2.1`**.  Quand votre application est finalis√©e, veuillez faire un **`commit`** de votre code avec le message suivant : **`2.1 : HMI : first external script`**.

#### ü§ù Tips
Vous pouvez vous aider du code donn√© ci-dessous :

```js
const dateTimeNow = new Date();
console.log(dateTimeNow.toLocaleDateString()); // 17/08/2020
console.log(dateTimeNow.toLocaleTimeString()); // 13:26:15
```

Autre r√©f√©rence pouvant vous aider :
[mdn web docs - Date](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date).