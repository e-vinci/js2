{"componentChunkName":"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-3-auths-api-fr-mdx","path":"/part3/auths-api/","result":{"data":{"mdx":{"id":"f77ec81f-c117-5ded-b5b7-d8677f72c735","body":"\n# b) S√©curisation d'une RESTful API\n\n<InternalPageMenu>\n  <PathViewer>\n    <PathViewerItem to=\"/\"> web2course </PathViewerItem>\n    <PathViewerItem to=\"/part3\"> Partie 3 </PathViewerItem>\n    <PathViewerItem selected> b) API & JWT & bcrypt </PathViewerItem>\n  </PathViewer>\n  <InternalPageMenuItem> C'est quoi l'authentification et l'autorisation ? </InternalPageMenuItem>\n  <InternalPageMenuItem> Stateful VS stateless authentication </InternalPageMenuItem>\n  <InternalPageMenuItem> C'est quoi les tokens JWT ? </InternalPageMenuItem>\n  <InternalPageMenuItem> Authentification et cr√©ation de token </InternalPageMenuItem>\n  <InternalPageMenuItem> Autorisation et v√©rification de token </InternalPageMenuItem>\n  <InternalPageMenuItem> Client REST avec JWT </InternalPageMenuItem>\n  <InternalPageMenuItem> Protection des op√©rations d'√©criture d'une API </InternalPageMenuItem> \n  <InternalPageMenuItem> S√©curisation des passwords </InternalPageMenuItem>\n  <InternalPageMenuItem> Exercice 3.1 : Authentification & autorisation d'op√©rations </InternalPageMenuItem>\n  <InternalPageMenuItem> üç¨ Exercice 3.2 : une autre API s√©curis√©e </InternalPageMenuItem> \n  <InternalPageMenuItem> üç¨ Authentification & autorisation JWT √† l'aide de cookies </InternalPageMenuItem> \n  <InternalPageMenuItem> üç¨ Test via REST Client d'une RESTful API attendant des cookies </InternalPageMenuItem>\n</InternalPageMenu>\n\n<div className=\"card card__simple-youtube-container\">\n    <YoutubeImage src=\"https://youtu.be/jCUyii3hcwY\" />\n</div>\n\n# <InternalPageTitle> C'est quoi l'authentification et l'autorisation ? </InternalPageTitle>\n\n## Authentification, c'est quoi ?\nL'authentification, c'est le processus de **v√©rifier qui est l'utilisateur** d'une application.\n\nPour authentifier un utilisateur, on va g√©n√©ralement passer via un formulaire de connexion, lui demandant un username et un password.\n\n## Autorisation, c'est quoi ?\nL'autorisation, c'est le processus de **v√©rifier ce √† quoi un utilisateur √† acc√®s**.\n\nUne API va autoriser les acc√®s √† certaines op√©rations en fonction des privil√®ges associ√©s aux utilisateurs. Il y aura des op√©rations qui seront autoris√©es : \n- **pour tous les utilisateurs**, tant anonymes qu'authentifi√©s ;  \n*imaginez par exemple les op√©rations de lecture de produits sur un site \"vitrine\". Il ne faut pas devoir cr√©er de compte utilisateur pour pouvoir afficher les produits du site.*\n- **pour tous les utilisateurs authentifi√©s**, peu importe leurs privil√®ges ;  \n*imaginez le fait de pouvoir poster des messages dans un forum ; il faut avoir un compte pour pouvoir le faire, mais il ne faut pas de privil√®ges sp√©cifiques (pas besoin d'√™tre admin).*\n- **pour seulement un ou plusieurs utilisateur(s) authentifi√©(s)** ayant les privil√®ges requis ;  \n*imaginez une op√©ration de lecture de tous les profils des utilisateurs d'une banque ; il faut avoir un compte admin de la banque pour pouvoir le faire. Ca serait catastrophique si n'importe quel utilisateur authentifi√© pourrait acc√©der aux profils de tous les utilisateurs !*\n\n## Diff√©rents moyens d'authentification\n\n### Authentification stateful\n\nTraditionnellement, ou anciennement, nous avons l'authentification qui est support√©e √† l'aide de cookies. L'utilisateur envoie via un formulaire son username et password, le serveur v√©rifie ceux-ci et cr√©e un id de session et le renvoie √† l'utilisateur via un cookie.  \nApr√®s l'authentification, √† chaque requ√™te du client sur ce serveur, le cookie est envoy√©, et le serveur, qui a sauvegard√© la session, va la retrouver sur base de l'id de session pr√©sent dans le cookie et va autoriser ou non l'acc√®s √† l'op√©ration demand√©e par le client.  \nC'est ce qu'on appelle une authentification **stateful**.\n\nUn m√©canisme d'authentification **stateful** indique que le serveur est responsable de sauvegarder les donn√©es de session des utilisateurs. \n\nOn parle de **session** d'un utilisateur comme √©tant toute la dur√©e o√π le client s'authentifie √† l'application web jusqu'√† ce qu'il quitte cette application, lorsqu'il ferme son browser.\n\n### Authentification stateless \n\nDe mani√®re plus moderne, nous avons des m√©canismes d'authentification qui sont dits **stateless**. Dans ce genre de m√©canisme, c'est le client qui doit sauvegarder les donn√©es de session, et donc le browser. L'authentification √† l'aide de **tokens** devient tr√®s populaire.  \nIl existe diff√©rents moyen de l'impl√©menter. Dans le cadre de ce cours, nous focaliserons sur la fa√ßon la plus habituelle, les **JSON Web Tokens**, ou **JWT**.\n\nIl existe d'autres m√©canismes tr√®s modernes qui utilisent des tokens, et qui sont mis en place par des tiers : **OAuth**, **OpenId**... Ces m√©canismes sont offerts par Microsoft, Google, Facebook... Nous ne les verrons pas dans le cadre de cours. N√©anmoins, √† la fin de ce cours, vous devriez √™tre apte √† pouvoir les utiliser, sous r√©serve de bien lire la documentation üòâ.\n\n# <InternalPageTitle> Stateful VS stateless authentication  </InternalPageTitle>\n\nQuels sont les avantages & inconv√©nients d'une authentification stateful ? et d'une authentification stateless ?\n\n#### Authentification stateful\n**Inconv√©nients** :\n- La session utilise de la m√©moire pour chaque utilisateur.\n- Le backend n'a aucune mani√®re de d√©terminer si le frontend s'est d√©connect√© du site ou non : gestion de l'expiration d'une session plus compliqu√©e, notamment si le frontend revient apr√®s une longue dur√©e.\n- Toutes les sessions sont perdues en cas de red√©marrage du serveur (r√©-authentification).\n- Load balancing compliqu√© ; en effet, si un client fait une requ√™te, pendant toute la dur√©e de la session, s'il y a plusieurs serveurs qui peuvent y r√©pondre, comment est g√©r√©e la session de ce client ? Par quel(s) serveur(s) ? Comment se partagent-ils les donn√©es de session ? Est-ce que √ßa doit toujours √™tre le m√™me serveur qui r√©ponde au m√™me client ?\n\n**Avantages** :\n- Peu gourmand en ressource point de vue processing et tr√®s rapide ; en effet, une fois qu'une session est en place, la v√©rification que le cookie contient le bon id de session se fait vite.\n\n#### Authentification stateless\n**Inconv√©nients** : \nComme le serveur ne retient plus l'utilisateur en m√©moire, il doit utiliser de la cryptographie pour cr√©er et valider les token ; c'est donc consommateur en ressource point de vue processing.\n\n**Avantages** : \n- Pas de session √† g√©rer, m√™me apr√®s red√©marrage du serveur, il n'y a pas de r√©-authentification n√©cessaire.\n- √âvolutif, utilisation facile de plusieurs serveurs si du load balancing est n√©cessaire ; en effet, comme chaque requ√™te du client contient toutes les infos pour se faire autoriser, il n'est pas n√©cessaire de savoir quel serveur va prendre en charge la requ√™te.\n\nNotons que la \"scalability\" horizontale, la possibilit√© de permettre √† une application d'augmenter sa capacit√© de r√©pondre √† une charge grandissante simplement en ajoutant des machines, est quelque chose de tr√®s important √† notre √©poque.  \nCertaines applications web ont des centaines de millions d'utilisateurs ; pour celles-ci, on ne peut pas compter sur la \"scalability\" verticale, c'est-√†-dire le fait d'augmenter les ressources d'une machine, en augmentant sa RAM, son processeur, son espace de stockage...\n\nD√®s lors, dans le cadre de ce cours, nous allons pr√©f√©rer les applications web qui peuvent tourner sur des serveurs **stateless**.\n\n# <InternalPageTitle> C'est quoi les tokens JWT ? </InternalPageTitle>\n\nLes **JSON Web token**, ou **JWT**, appartiennent √† un standard internet permettant l'√©change s√©curis√© de tokens entre plusieurs parties.\n\nUn **JWT** contient **trois parties encod√©es en base64** et ressemble √† qqch du style :  \n**`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.`**  \n**`eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.`**   \n**`SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`**\n\nVoici les 3 parties d'un JWT et leurs caract√©ristiques :\n- l'**ent√™te** (ou header) : un objet JSON identifiant le type de token (JWT) et l'algorithme utilis√© pour g√©n√©rer la signature du token (HS256), un algorithme de hachage. \n- le **payload** : un objet JSON permettant de sp√©cifier le **claim** ; ce sont des param√®tres optionnels pr√©cisant les affirmations associ√©es au token, comme la date d'expiration du token, son cr√©ateur, le fait que l'utilisateur est admin... g√©n√©ralement, on y met pas trop d'info, principalement l'identifiant de l'utilisateur ; si l'API a besoin de plus d'info concernant l'utilisateur, elle ira g√©n√©ralement les chercher dans ses donn√©es.\n- la **signature** : c'est une signature num√©rique construite √† partir d'un secret priv√© ou d'une cl√© publique/priv√©e, via l'algorithme pr√©cis√© dans la signature.\n\nüí≠ C'est bien joli tout √ßa, mais comment √ßa permet de s√©curiser la session d'un utilisateur ?  \nG√©n√©ralement, l'API, et elle uniquement, conna√Æt le secret priv√©. Elle va donc cr√©er le token d'un utilisateur authentifi√©, en y ajoutant le claim (ou les affirmations) qu'elle juge utile.  \nLorsque le client re√ßoit son token, il va le sauvegarder dans son browser.  \nPour chaque requ√™te n√©cessitant une autorisation de l'API, le client enverra son token au sein du header de la requ√™te.  \nL'API utilisera le secret priv√©, connu d'elle-m√™me uniquement, pour v√©rifier la signature du token. Si tout est OK, c'est que l'utilisateur est bien authentifi√© et que son claim est OK.\n\nImaginez maintenant qu'un hacker tente de modifier le token, pour modifier le claim, notamment en changeant l'id de l'utilisateur pr√©sent dans le payload du token.\nEt bien la signature ne correspondra plus √† ce token l√† ! L'API le d√©tectera.  \nPour que le hacker r√©ussisse son acte malicieux, il est oblig√© de conna√Ætre le secret priv√© qui ne doit √™tre connu que de l'API. Ca ne serait que sur base du secret priv√© que les hackers pourraient g√©n√©rer un nouveau token qui serait valid√© par l'API. Pas √©vident √† faire...\n\nAinsi, on peut imaginer un token comme une enveloppe s√©curis√© par un cadenas tr√®s sp√©cial : ce cadenas, qui est mis sur l'enveloppe contenant, par exemple, l'identifiant d'un utilisateur, est ferm√© par la cl√© üîë que seulement conna√Æt l'API.\nSi quelqu'un touche √† l'enveloppe, le cadenas ne s'ouvrira plus avec la üîë de l'API : la tentative de hack sera d√©tect√©e ! \nSi quelqu'un tente de cr√©er une enveloppe s√©curis√©, il le fera avec une autre cl√©, **üóù** par exemple, car il ne conna√Æt pas üîë. L'API, tentant d'ouvrir l'enveloppe s√©curis√©e √† l'aide de üîë, elle ne s'ouvrira pas : la tentative de hacking sera d√©tect√©e ! \n\nüí≠ Est-ce que cette m√©taphore d'enveloppe s√©curis√©e vous parle ?\nAttention que dans la r√©alit√©, le payload classique d'un token sera decodable, que l'on connaisse ou pas le secret priv√©. Il est encod√© en base64 ! Ne mettez donc jamais de secrets dans le payload d'un token !  \nSi vraiment un jour vous deviez mettre un secret dans un payload, bien que d√©conseill√©, vous pourriez toujours le faire en cryptant le payload.\n\nüëç Le m√©canisme de token assure que l'on aie une tr√®s haute probabilit√© de d√©tecter les alt√©rations faites sur les tokens, les tentatives de forgeage, gr√¢ce √† la signature de ceux-ci.  \n\n‚ö° Par contre, si nous laissions tra√Æner des informations dans le payload d'un token, comme un password d'un utilisateur et son username, alors l√†, c'est juste un beau cadeau que l'on offre aux hackers ; ils n'auraient plus qu'√† trouver un moyen de voler √† distance nos donn√©es de session ; ils pourraient ensuite utiliser le formulaire de connexion et prendre possession de notre identit√© üò®.\n\nIl existe un site fort int√©ressant qui montre la structure d'un token et qui permet de les d√©coder : [jwt.io](https://jwt.io/) [[R.63]](/references/#r63). Nous l'utiliserons plus tard pour d√©coder les tokens g√©n√©r√©s par nos RESTful API.\n\n# <InternalPageTitle> Authentification et cr√©ation de token </InternalPageTitle>\n\n## Introduction\n\nVia un exemple concret associ√© √† notre RESTful API qui g√®re les ressources de type \"pizzas\" et de type \"boisson\", nous allons mettre en place un processus d'authentification et d'autorisation JWT.\n\nLa librairie que nous allons utiliser dans le cadre de ce cours pour g√©rer des tokens JWT est [jsonwebtoken](https://www.npmjs.com/package/jsonwebtoken).\n\nDans ce nouveau tutoriel, nous allons continuer le d√©veloppement de l'API [services](https://github.com/e-vinci/ts-demos/tree/main/back/api/services) pour ajouter des op√©rations permettant l'authentification et l'autorisation d'utilisateurs.\n\nVeuillez cr√©er un nouveau projet nomm√© **`auths`** (dans votre repo git **`/web2/tutorials/pizzeria/api/auths`**) sur base d'un copi√©/coll√© du tutoriel [services](https://github.com/e-vinci/ts-demos/tree/main/back/api/services).\n\nVeuillez installer la librairie **`jsonwebtoken`** au sein de votre nouveau projet **`auths`** :\n```bash\nnpm i jsonwebtoken\n```\n\nComme nous utilisons TS, nous devons aussi installer les types de cette librairie :\n```bash\nnpm i -D @types/jsonwebtoken\n```\n\n## M√©canisme d'authentification et cr√©ation du token\n\nToujours √† l'aide d'Express, nous allons cr√©er un router **`auths`** qui mettra √† disposition les op√©rations de **`login`** et de **`register`**. \nVoici le contrat associ√© √† ces nouvelles op√©rations :\n\n##### Op√©rations sur les ressources de type \"auths\"\n| URI | M√©thode HTTP | Op√©ration |\n|---|---|---|\n| **`auths/login`** | **POST** | V√©rifier les credentials d'une ressource de type \"users\" et renvoyer le username et un token JWT si les credentials sont OK |\n| **`auths/register`** | **POST** | Cr√©er une ressource de type \"users\" et renvoyer le username et un token JWT |\n\n<br/>\n\nLe service **`users`** s'occupera de cr√©er les utilisateur, de v√©rifier leurs credentials ainsi que de cr√©er des tokens.\n\nVoici le workflow attendu pour une op√©ration de **`login`** ou de **`register`** :\n\n<ScrollableImage name=\"login.png\" minWidth=\"879px\" maxWidth=\"879x\" />\n<figcaption>Appel √† une RESTful API pour s'authentifier et obtenir un JWT</figcaption>\n\nCe que l'on voit dans l'image ci-dessus : \n- si le service consid√®re que l'utilisateur est authentifiable, que ses credentials sont OK, alors il va utiliser la m√©thode **`sign`** de l'objet **`jwt`** pour cr√©er un token. \n- le token est envoy√© dans le body de la r√©ponse √† l'utilisateur. \n\nCe que l'on ne voit pas dans l'image ci-dessus :\n- c'est le job du client de sauvegarder le token. Si l'application cliente est un browser, alors celui-ci pourra √™tre sauvegard√© dans le web storage du browser.\n- l'application cliente peut √™tre faite avec n'importe quelle technologie. Par exemple, nous pourrons utiliser REST Client pour faire une requ√™te √† l'API...\n\nDans notre RESTful API, nous avons d√©cid√© que lorsqu'un client s'enregistre, quand il fait appel √† l'op√©ration **`register`** pour cr√©er un compte, l'API consid√®re automatiquement que cet utilisateur est authentifi√©. Tout comme la m√©thode **`login`**, la m√©thode **`register`** cr√©era et renverra un token JWT √† l'utilisateur.\n\nNB : Il est possible d'envisager un workflow diff√©rent : apr√®s le **`register`**, l'application demanderait √† l'utilisateur un **`login`**, **`register`** ne renvoyant jamais de token √† l'utilisateur.\n\n## Impl√©mentation de login & register\n\nNous allons √† pr√©sent mettre en place le code permettant d'impl√©menter le workflow que l'on vient de d√©couvrir.\n\nVeuillez cr√©er le service **`users`** en cr√©ant le fichier **`/services/users.ts`** et y inclure ce code :\n```ts numbered highlighting=\"1,5-6,27-31,33-36,50-54,56-59\"\nimport jwt from \"jsonwebtoken\";\nimport path from \"node:path\";\nimport { parse, serialize } from \"../utils/json\";\nimport { AuthenticatedUser, User } from \"../types\";\n\nconst jwtSecret = \"ilovemypizza!\";\nconst lifetimeJwt = 24 * 60 * 60 * 1000; // in ms : 24 * 60 * 60 * 1000 = 24h\n\nconst jsonDbPath = path.join(__dirname, \"/../data/users.json\");\n\nconst defaultUsers: User[] = [\n  {\n    id: 1,\n    username: \"admin\",\n    password: \"admin\",\n  },\n];\n\nfunction login(\n  username: string,\n  password: string\n): AuthenticatedUser | undefined {\n  const userFound = readOneUserFromUsername(username);\n  if (!userFound) return undefined;\n  if (userFound.password !== password) return undefined;\n\n  const token = jwt.sign(\n    { username }, // session data added to the payload (payload : part 2 of a JWT)\n    jwtSecret, // secret used for the signature (signature part 3 of a JWT)\n    { expiresIn: lifetimeJwt } // lifetime of the JWT (added to the JWT payload)\n  );\n\n  const authenticatedUser: AuthenticatedUser = {\n    username,\n    token,\n  };\n\n  return authenticatedUser;\n}\n\nfunction register(\n  username: string,\n  password: string\n): AuthenticatedUser | undefined {\n  const userFound = readOneUserFromUsername(username);\n  if (userFound) return undefined;\n\n  createOneUser(username, password);\n\n  const token = jwt.sign(\n    { username }, // session data added to the payload (payload : part 2 of a JWT)\n    jwtSecret, // secret used for the signature (signature part 3 of a JWT)\n    { expiresIn: lifetimeJwt } // lifetime of the JWT (added to the JWT payload)\n  );\n\n  const authenticatedUser: AuthenticatedUser = {\n    username,\n    token,\n  };\n\n  return authenticatedUser;\n}\n\nfunction readOneUserFromUsername(username: string) {\n  const users = parse(jsonDbPath, defaultUsers);\n  const userFound = users.find((user) => user.username === username);\n  if (!userFound) return undefined;\n\n  return userFound;\n}\n\nfunction createOneUser(username: string, password: string) {\n  const users = parse(jsonDbPath, defaultUsers);\n\n  const nextId =\n    users.reduce((acc, user) => (user.id > acc ? user.id : acc), 0) + 1;\n\n  const createdUser: User = {\n    id: nextId,\n    username,\n    password,\n  };\n\n  users.push(createdUser);\n\n  serialize(jsonDbPath, users);\n\n  return createdUser;\n}\n\nexport { login, register, readOneUserFromUsername };\n```\n\nDans le code ci-dessus, **`jwtSecret`** est le secret priv√© connu uniquement du serveur. C'est la m√™me secret qu'il faudra utiliser pour v√©rifier un token.  \n\n**`jwt.sign()`** permet de cr√©er le token et ses 3 parties :\n- le payload du token, la 2√®me partie du token, est compl√©t√© principalement via le permier argument de **`sign()`** ; ici, le token affirme que l'utilisateur poss√©dant le **`username`** donn√© est authentifi√©.\n- le payload du token sera aussi modifi√© sur base de la dur√©e d'expiration du token, selon l'argument **`expiresIn`**.\n- **`jwtSecret`** est utilis√© pour cr√©er la 3√®me partie du token, sa signature.\n\nPour le service **`users`**, nous avons du cr√©er deux nouveaux types : **`AuthenticatedUser`** et **`User`**. Veuillez mettre √† jour le fichier **`/types.ts`** et y inclure ce code :\n```ts numbered highlighting=\"1-4,6-10,18-19\"\ninterface AuthenticatedUser {\n  username: string;\n  token: string;\n}\n\ninterface User {\n  id: number;\n  username: string;\n  password: string;\n}\n\nexport type {\n  Pizza,\n  NewPizza,\n  PizzaToUpdate,\n  Drink,\n  NewDrink,\n  AuthenticatedUser,\n  User,\n};\n```\n\nIl faut maintenant que nous cr√©ions le router **`auths`** offrant les op√©rations de **`login`** et de **`register`**, en faisant appel au service **`users`**.  \nVeuillez cr√©er le fichier **`/routes/auths.ts`** et y inclure le code suivant :\n```ts\nimport { Router } from \"express\";\nimport { PotentialUser } from \"../types\";\nimport { login, register } from \"../services/users\";\nconst router = Router();\n\n/* Register a user */\nrouter.post(\"/register\", (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    !(\"username\" in body) ||\n    !(\"password\" in body) ||\n    typeof body.username !== \"string\" ||\n    typeof body.password !== \"string\" ||\n    !body.username.trim() ||\n    !body.password.trim()\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { username, password } = body as PotentialUser;\n\n  const authenticatedUser = register(username, password);\n\n  if (!authenticatedUser) {\n    return res.sendStatus(409);\n  }\n\n  return res.json(authenticatedUser);\n});\n\n/* Login a user */\nrouter.post(\"/login\", (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    !(\"username\" in body) ||\n    !(\"password\" in body) ||\n    typeof body.username !== \"string\" ||\n    typeof body.password !== \"string\" ||\n    !body.username.trim() ||\n    !body.password.trim()\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { username, password } = body as PotentialUser;\n\n  const authenticatedUser = login(username, password);\n\n  if (!authenticatedUser) {\n    return res.sendStatus(401);\n  }\n\n  return res.json(authenticatedUser);\n});\n\nexport default router;\n```\n\nIl n'y a rien de bien sp√©cial √† ce code. On fait simplement appel aux op√©rations du service **`users`**.  \nNous avons n√©anmoins du cr√©er un nouveau type **`PotentialUser`**. Veuillez mettre √† jour le fichier **`/types.ts`** et y inclure ce code :\n```ts highlighting=\"1,11\"\ntype PotentialUser = Omit<User, \"id\">;\n\nexport type {\n  Pizza,\n  NewPizza,\n  PizzaToUpdate,\n  Drink,\n  NewDrink,\n  AuthenticatedUser,\n  User,\n  PotentialUser,\n};\n```\n\nAttention, il faut rajouter le nouveau router au sein de **`app.js`** pour que notre API puisse offrir les nouvelles op√©rations ; veuillez donc ajouter ce code dans **`/app.ts`** :\n```ts numbered highlighting=\"6,24\"\nimport express, { ErrorRequestHandler } from \"express\";\n\nimport usersRouter from \"./routes/users\";\nimport pizzaRouter from \"./routes/pizzas\";\nimport drinkRouter from \"./routes/drinks\";\nimport authsRouter from \"./routes/auths\";\n\nconst app = express();\n\napp.use((_req, _res, next) => {\n  console.log(\n    \"Time:\",\n    new Date().toLocaleString(\"fr-FR\", { timeZone: \"Europe/Brussels\" })\n  );\n  next();\n});\n\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use(\"/users\", usersRouter);\napp.use(\"/pizzas\", pizzaRouter);\napp.use(\"/drinks\", drinkRouter);\napp.use(\"/auths\", authsRouter);\n\nconst errorHandler: ErrorRequestHandler = (err, _req, res, _next) => {\n  console.error(err.stack);\n  return res.status(500).send(\"Something broke!\");\n};\n\napp.use(errorHandler);\nexport default app;\n```\n\n## Utilisation de Rest Client pour tester les nouvelles op√©rations\n\nVeuillez d√©marrer votre API **`auths`**.\n\nOn va utiliser REST Client pour tester ces nouvelles op√©rations.\n\nVeuillez cr√©er le fichier **`/REST Client/auths.http`** et y ajouter le code suivant :\n```http\n@baseUrl = http://localhost:3000\n\n### Try to login an unknown user\nPOST {{baseUrl}}/auths/login\nContent-Type: application/json\n\n{\n    \"username\":\"unknown\",\n    \"password\":\"admin\"\n}\n\n### Login the default admin\nPOST {{baseUrl}}/auths/login\nContent-Type: application/json\n\n{\n    \"username\":\"admin\",\n    \"password\":\"admin\"\n}\n\n\n### Create the manager user\nPOST {{baseUrl}}/auths/register\nContent-Type: application/json\n\n{\n    \"username\":\"manager\",\n    \"password\":\"manager\"\n}\n\n### Login the manager user\nPOST {{baseUrl}}/auths/login\nContent-Type: application/json\n\n{\n    \"username\":\"manager\",\n    \"password\":\"manager\"\n}\n```\n\nVeuillez ex√©cuter les diff√©rentes requ√™tes. Tout devrait fonctionner, vous devriez r√©cup√©rer le username et le token d'un utilisateur authentifi√©.\n\nPour le fun, nous allons d√©coder un token : \n- Veuillez copier le token de ce que renvoie votre API pour la requ√™te de login de l'utilisateur **`manager`** (qqch qui doit ressembler √† une string du genre : **`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im1hbmFnZXIiLCJpYXQiOjE2NjEyNDg1MjksImV4cCI6MTc0NzY0ODUyOX0.JvYzM0gtmVkqFr9R3f1Bf6ow_QuyHJY-vedJ39N7JKw`**).\n- Veuillez vous rendre sur le site [JWT](https://jwt.io/) et coller votre token dans le champs **`Encoded`**. Dans la colonne **`Decoded`**, vous devriez voir l'algorithme utilis√© par la m√©thode **`sign`**, ainsi que les donn√©es pr√©sentes dans le payload, dont **`\"username\": \"manager\"`** ! \n\nVous comprenez maintenant pourquoi on n'ajoute pas des secrets dans un token üòâ.\n\n# <InternalPageTitle> Autorisation et v√©rification de token </InternalPageTitle>\n\n## M√©canisme d'autorisation d'utilisateurs √† des op√©rations d'une API \n\n### Intro\n\nDans le workflow que nous avons choisi, les utilisateurs re√ßoivent un token lors du **`register`** ou du **`login`**. C'est le job de l'application cliente de trouver un moyen de sauvegarder ce token. \n\nLorsqu'une application client souhaite cr√©er une pizza, on souhaite autoriser cette op√©ration qu'√† l'administrateur du site g√©rant la pizzeria.  \nNous d√©cidons donc pour l'**op√©ration de cr√©ation de pizza que l'utilisateur doit** non seulement √™tre **authentifi√©**, mais qu'en plus, il doit √™tre l'**admin** du site.\n\n### M√©canisme d'autorisation quand le token JWT est valide\n\nPour que l'application client qui fait la requ√™te √† l'API puisse s'autoriser, elle doit ajouter un **`authorization header`** √† sa requ√™te contenant comme valeur le token re√ßu lors du **`login`** ou du **`register`** :\n\n<ScrollableImage name=\"authorizeOK.png\" minWidth=\"879px\" maxWidth=\"879x\" />\n<figcaption>Appel √† une op√©ration d'une RESTful API n√©cessitant une autorisation JWT : autorisation valide</figcaption>\n\nLe router de \"pizzas\", avant m√™me de passer la requ√™te √† la route **`POST /pizzas`**, va lancer la fonction middleware d'autorisation nomm√©e **`authorize`**. La fonction middleware **`authorize`** va s'occuper de v√©rifier le token envoy√© par le client dans un header √† l'aide de la m√©thode **`verifiy`** de l'objet **`jwt`** (de la librairie **`jsonwebtoken`**).\n\nüí≠ Si le token est valide, est-ce que √ßa signifie que l'utilisateur est bien authentifi√© ?  \n*H√© bien non, car imaginez qu'entre le moment o√π l'utilisateur se soit logu√©, il ait √©t√© supprim√© de l'application par un admin... dans ce cas-ci, on ne veut pas l'autoriser √† ajouter une pizza au menu de la pizzeria ! Il n'est p-e m√™me plus un employ√©, il souhaite p-e √©crire du contenu malicieux üò®*\n\nDonc si le token est valide, **`authorize`** fera appel au service **`users`** pour v√©rifier que l'utilisateur existe bien dans le support de donn√©es (fichiers JSON, base de donn√©es ou autres) et pour obtenir toutes les infos sur cet utilisateur. Si l'utilisateur existe, alors cela signifie que l'utilisateur est bien authentifi√©. La fonction middleware **`authorize`** va passer la main √† une autre fonction middleware pour v√©rifier que l'utilisateur est bien l'admin.\n\nüí≠ Comment est-ce que **`authorize`** peut faire appel au service pour v√©rifier que l'utilisateur existe bien ? Est-ce que cela signifie que le token doit contenir tout un tas de donn√©es sur l'utilisateur ?\n\nüëç En r√®gle g√©n√©rale, on va juste mettre un identifiant de l'utilisateur dans ce qu'on appelle le **payload** du token. C'est ensuite l'API, suite au d√©codage de l'identifiant de l'utilisateur, qui fera appel aux donn√©es pour retrouver tout ce qui concerne l'utilisateur.\n\nLa fonction middleware **`isAdmin`** va v√©rifier que l'utilisateur est bien l'admin. Si c'est OK, elle passera la main √† la fonction middleware qui g√®re la route **`POST /pizzas`** au sein du router de pizzas en faisant l'appel √† la fonction **`next`**.  \n*üç¨ NB : on pourrait aussi laisser la fonction **`creatPizza`** s'occuper de v√©rifier que l'utilisateur demandant la cr√©ation de la pizza soit bien l'admin. Ici, comme il s'agit de v√©rifier que le contrat de l'API soit respect√©, c'est-√†-dire que l'utilisateur soit bien authentifi√© & admin, alors on pr√©f√®re r√©aliser cette action en dehors du service. Dans nos choix architecturaux pour nos RESTful API, nous avons d√©cid√© que ce n'est pas le service qui s'occupe de pr√©senter les donn√©es aux clients, c'est le r√¥le des routers (et les fonctions middleware associ√©es).*\n\nMaintenant que le client a les bons privil√®ges, l'op√©ration de cr√©ation de la pizza peut donc √™tre autoris√©e. L'op√©ration de **`createPizza`** du service renverra la nouvelle pizza au router qui s'occupera de pr√©senter la nouvelle pizza au client, au format JSON.\n\n### M√©canisme d'autorisation quand le token JWT est invalide\n\nVoici le workflow d'autorisation si le token n'est pas valide :\n\n<ScrollableImage name=\"authorizeNOK.png\" minWidth=\"879px\" maxWidth=\"879x\" />\n<figcaption>Appel √† une op√©ration d'une RESTful API n√©cessitant une autorisation JWT : autorisation invalide</figcaption>\n\nDans ce cas l√†, **`authorize`** ne passe pas la main √† **`isAdmin`** ni m√™me √† la fonction middleware qui g√®re la route **`POST /pizzas`**.  \nLa fonction middleware **`authorize`** renvoie directement un code d'erreur **`401 Unauthorized`** au client. \n\n### M√©canisme d'autorisation quand l'utilisateur n'est pas admin\n\nVous pourriez aussi imaginer le workflow o√π le client envoie un token valide, mais l'utilisateur associ√© n'est pas admin. Dans ce cas-ci, **`authorize`** ferait appel √† **`isAdmin`**, mais **`isAdmin`** renverrait directement un code d'erreur **`403 Forbidden`** au client.  \nEn effet, l'API indiquerait ainsi qu'elle aurait v√©rifi√© que l'utilisateur est bien authentifi√©, mais que celui ne poss√®de pas les privil√®ges suffisant pour acc√©der √† l'op√©ration demand√©e.\n\n## Impl√©mentation du m√©canisme d'autorisation\n\nüò® Wow, le workflow d'autorisation pour la cr√©ation d'une pizza est assez long.  \nNous allons maintenant l'impl√©menter dans notre tutoriel en cours.  \nNous vous inqui√©tez pas, ce qui importe dans le code qui va suivre, ce n'est pas de savoir √©crire tout le code, mais de bien comprendre les m√©canismes associ√©s. En effet, en r√®gle g√©n√©rale, vous allez utiliser des librairies vous permettant d'autoriser les acc√®s aux op√©rations de vos API. Vous √©crirez donc rarement les m√©canismes d'autorisation, par contre, vous devrez pouvoir les utiliser.\n\nVeuillez cr√©er les nouvelles fonctions middleware **`authorize`** et **`isAdmin`** au sein d'un nouveau fichier **`/utils/auths.ts`** :\n```ts numbered highlighting=\"1,6,13,19-20,28,37\"\nimport jwt from \"jsonwebtoken\";\nimport { readOneUserFromUsername } from \"../services/users\";\nimport { NextFunction, RequestHandler, Response } from \"express\";\nimport { AuthenticatedRequest, JwtPayload, User } from \"../types\";\n\nconst jwtSecret = \"ilovemypizza!\";\n\nconst authorize = (\n  req: AuthenticatedRequest,\n  res: Response,\n  next: NextFunction\n) => {\n  const token = req.get(\"authorization\");\n  if (!token) {\n    return res.sendStatus(401);\n  }\n\n  try {\n    const decoded = jwt.verify(token, jwtSecret) as JwtPayload;\n    const { username } = decoded;\n\n    const existingUser = readOneUserFromUsername(username);\n\n    if (!existingUser) {\n      return res.sendStatus(401);\n    }\n\n    req.user = existingUser; // request.user object is available in all other middleware functions\n    return next();\n  } catch (err) {\n    console.error(\"authorize: \", err);\n    return res.sendStatus(401);\n  }\n};\n\nconst isAdmin: RequestHandler = (req: AuthenticatedRequest, res, next) => {\n  const { username } = req.user as User;\n\n  if (username !== \"admin\") {\n    return res.sendStatus(403);\n  }\n  return next();\n};\n\nexport { authorize, isAdmin };\n```\n\nVoici quelques explications sur le code de la fonction middleware **`authorize`** : \n- Gr√¢ce √† **`req.get('authorization')`** (ligne 13), on r√©cup√®re le token qui a √©t√© envoy√© par le client au sein de l'**`authorization header`** de la requ√™te sous forme de string.\n- La m√©thode **`jwt.verify(token, jwtSecret)`** (ligne 19) v√©rifie tant la signature du token que son √©ventuelle expiration. Elle utilise le secret **`jwtSecret`** qui doit √™tre le m√™me que celui pris en compte lors de la cr√©ation du token.\n- Elle charge toutes les donn√©es de l'utilisateur authentifi√© au sein de l'objet **`req`** (ligne 28), dans **`user`**. Cela est une bonne pratique, cela permet, pour toute la dur√©e du traitement de cette requ√™te, de mettre √† disposition ces donn√©es √† toutes les fonctions middleware.    \nüí≠ Mais pourquoi faire cela ?\n*Imaginez que vous faites un appel √† une base de donn√©es externes √† chaque fois que vous souhaitez obtenir les informations d'un utilisateur... Cela est tr√®s consommateur en temps... Lorsque vous allez utiliser d'autres fonctions middleware comme **`isAdmin`**, vous n'avez plus besoin de faire appel √† la base de donn√©es.*\n\nLa fonction middleware **`isAdmin`** r√©cup√®re les donn√©es de l'utilisateur authentifi√© via l'objet **`req.user`**.  \nSi l'utilisateur n'est pas **`admin`**, c'est le code **`403 Forbidden`** qui est renvoy√© √† l'application cliente, signifiant que l'utilisateur est bien authentifi√©, mais il n'a pas les privil√®ges pour acc√©der √† l'op√©ration demand√©e (cr√©ation de pizza).  \nSi tout est OK, **`isAdmin`** fait appel √† **`next()`**, ce qui consiste √† ex√©cuter la prochaine fonction middleware qui est pr√©sente apr√®s l'appel de **`isAdmin`**.\n\nPour cr√©er ces deux fonctions middleware, nous avons du cr√©er deux nouveaux types : **`AuthenticatedRequest`** et **`JwtPayload`**. Veuillez mettre √† jour le fichier **`/types.ts`** et y inclure ce code :\n```ts numbered highlighting=\"1,5-7,9-13,24-25\"\nimport { Request } from \"express\";\n\n// Reste du code\n\ninterface AuthenticatedRequest extends Request {\n  user?: User;\n}\n\ninterface JwtPayload {\n  username: string;\n  exp: number; // Expiration time (in seconds since the epoch)\n  iat: number; // Issued at time (in seconds since the epoch)\n}\n\nexport type {\n  Pizza,\n  NewPizza,\n  PizzaToUpdate,\n  Drink,\n  NewDrink,\n  AuthenticatedUser,\n  User,\n  PotentialUser,\n  AuthenticatedRequest,\n  JwtPayload,\n};\n\n```\n\nIci nous avons ajout√© un nouveau type **`AuthenticatedRequest`** qui √©tend le type **`Request`** d'Express, ceci afin de pouvoir ajouter un objet de type **`User`** √† **`req`**.\n\nNous avons aussi ajout√© un nouveau type **`JwtPayload`** qui repr√©sente le payload d'un token JWT. Ce type est utilis√© pour typer l'objet **`decoded`** retourn√© par la m√©thode **`jwt.verify`**.\n\nO√π allons-nous utiliser les nouvelles fonctions middleware **`authorize`** et **`isAdmin`** ?\n\nNous pouvons le faire au niveau que nous souhaitons, soit au niveau :\n- de l'**application**, pour toutes les routes, via **`app.use(authorize)`**.\n- d'un **router**, pour toutes les routes associ√©es ; par exemple, on pourrait dire que toutes les routes du router de pizzas sont prot√©g√©es par une autorisation JWT. On √©crirait : **`app.use(\"/pizzas\", authorize, pizzaRouter);`**.  \nCela signifierait que toutes les op√©rations sur des ressources de type \"pizzas\" ne seraient autoris√©es que si l'utilisateur √©tait authentifi√©. Cela serait probl√©matique pour deux raisons :\n    - On veut pouvoir afficher le menu des pizzas pour tous les utilisateurs, m√™me s'ils sont anonymes.\n    - On ne veut pas simplement v√©rifier qu'un utilisateur est authentifi√© pour cr√©er une pizza, on veut aussi v√©rifier qu'il est admin.\n- d'une route, pour une op√©ration de notre RESTful API. C'est ce que nous souhaitons faire ici. Veuillez mettre √† jour le code du router de \"pizzas\" au sein de **`/routes/pizzas.ts`** :\n```js highlighting=\"2,7\"\n// Code existant...\nimport { authorize, isAdmin } from \"../utils/auths\";\n\n// Code existant...\n\n// Create a pizza to be added to the menu.\nrouter.post(\"/\", authorize, isAdmin, (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    !(\"title\" in body) ||\n    !(\"content\" in body) ||\n    typeof body.title !== \"string\" ||\n    typeof body.content !== \"string\" ||\n    !body.title.trim() ||\n    !body.content.trim()\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { title, content } = body as NewPizza;\n\n  const addedPizza = createPizza({ title, content });\n\n  return res.json(addedPizza);\n});\n```\n\nAinsi, nous avons juste fait l'appel de deux fonctions middleware pour v√©rifier :\n- **que l'utilisateur est authentifi√©** via **`authorize`** ; si tout est OK au niveau du token fournit par l'application cliente, **`authorize`** fait appel via **`next()`** √† la prochaine fonction middleware. Dans ce cas-ci, c'est **`isAdmin`**. S'il y a un probl√®me, **`authorize`** termine le traitement de la requ√™te en envoyant un code d'erreur au client et les prochaines fonctions middleware (**`isAdmin`**, puis la fonction **`arrow`**) ne sont pas ex√©cut√©es.\n- **que l'utilisateur est admin** via **`isAdmin`** ; si tout est OK, que l'utilisateur authentifi√© est l'admin, **`isAdmin`** fait appel via **`next()`** √† la prochaine fonction middleware. Dans ce cas-ci, c'est la fonction **`arrow`** qui appelle l'op√©ration demand√©e pour cr√©er la pizza : **`createPizza`**. Si l'utilisateur authentifi√© n'est pas l'admin, alors **`isAdmin`** termine le traitement en envoyant un code d'erreur au client et la fonction traitant de l'op√©ration de cr√©ation n'est pas ex√©cut√©e.\n\nComment pouvons-nous tester l'op√©ration de cr√©ation d'une pizza ? Via REST Client.\nTentons le coup √† l'aide de cette requ√™te (elle est d√©j√† pr√©sente dans **`/REST Client/pizzas.http`**) :\n```http\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\n\n{\n    \"title\":\"Magic Green\",\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n```\n\nApr√®s avoir ex√©cut√© cette requ√™te, vous devriez avoir re√ßu un status code **`401 Unauthorized`**.\nC'est normal, comme nous n'avons pas envoy√© de token, nous ne pouvons donc pas √™tre autoris√©.  \nAu prochain point nous allons voir comment utiliser REST Client pour sauvegarder de l'information, comme un token, suite √† une requ√™te vers une API.\n\n# <InternalPageTitle> Client REST avec JWT </InternalPageTitle>\n\nPr√©c√©demment, nous avons appris √† utiliser REST Client, l'extension de VS Code, pour faire des requ√™tes vers des API.\n\nVoici quelques notions suppl√©mentaire pour utiliser REST Client avec des **`JWT`** :\n- Il est possible de cr√©er des **`Request Variables`** afin de **r√©cup√©rer la r√©ponse** associ√©e \n√† une requ√™te au sein d'une variable.\n- On va donc pouvoir r√©cup√©rer le token, suite √† une requ√™te d'authentification, \nau sein d'une **`Request Variable`**, pour ensuite fournir ce token dans le **`Authorization header`** de toutes les requ√™tes demandant une autorisation JWT.\n\nSi vous souhaitez plus d'infos sur les **`Request Variables`**, vous pouvez consulter la [documentation de REST Client](https://github.com/Huachao/vscode-restclient#request-variables) [[R.55]](/references/#r55).\n\nVoici comment mettre √† jour le script **`/REST Client/pizzas.http`** pour cr√©er une pizza en passant le token de l'utilisateur **`admin`** :\n\n```http\n### Create a pizza by using the admin account\n#### First login as the admin\n##### Define a request variable named admin :\n# @name admin\nPOST {{baseUrl}}/auths/login\nContent-Type: application/json\n\n{\n    \"username\":\"admin\",\n    \"password\":\"admin\"\n}\n\n#### Create a pizza with the admin token\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\nAuthorization: {{admin.response.body.token}}\n\n{\n    \"title\":\"Magic Green\",\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n```\n\nPour tester l'op√©ration de cr√©ation de pizza, veuillez d'abord ex√©cuter la premi√®re requ√™te, puis la seconde donn√©e ci-dessus.\n\nA ce stade-ci, il serait aussi int√©ressant de tester certains cas d'erreurs associ√©s aux tokens. Veuillez compl√©ter le script **`/REST Client/pizzas.http`** avec :\n```http\n### 1. Create a pizza without a token\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\n\n{\n    \"title\":\"Magic Green\",\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n\n### 2. Create a pizza without being the admin, use manager account\n#### 2.1 First login as the manager\n##### 2.1.1 Define a request variable nammed manager\n# @name manager\nPOST {{baseUrl}}/auths/login\nContent-Type: application/json\n\n{\n    \"username\":\"manager\",\n    \"password\":\"manager\"\n}\n\n##### 2.1.2 Define a file variable to simplify the access to the token of manager\n@managerToken = {{manager.response.body.token}}\n\n#### 2.2 Try to create a pizza with the manager token\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\nAuthorization: {{managerToken}}\n\n{\n    \"title\":\"Magic Green\",\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n```\n\nNous voyons qu'√† l'aide de REST Client, nous pouvons utiliser une **`File Variable`** pour allouer une partie de la r√©ponse faite √† une requ√™te.  \nDans ce cas, on peut faire appel √† l'API en passant le token via la **`File Variable`** nomm√© **`managerToken`** (code associ√© : **`Authorization: {{managerToken}}`**) au lieu d'utiliser une partie seulement de la **`Request Variable`** nomm√©e **`manager`** (code possible : **`Authorization: {{manager.response.body.token}}`**).  \nCela permet de cr√©er des requ√™tes plus concises.\n\n# <InternalPageTitle> Protection des op√©rations d'√©criture d'une API </InternalPageTitle>\n\nVeuillez mettre √† jour votre RESTful API g√©rant les pizzas afin que toutes les op√©rations d'√©criture soient prot√©g√©es par une autorisation JWT, n'autorisant que l'utilisateur **admin**.\n\nVoici le code √† mettre √† jour dans **`/routes/pizzas`** pour correctement autoriser les op√©rations de suppression et de modification sur des ressources de type \"pizzas\":\n```js highlighting=\"2,11\"\n// Delete a pizza from the menu based on its id\nrouter.delete(\"/:id\", authorize, isAdmin, (req, res) => {\n  const id = Number(req.params.id);\n  const deletedPizza = deletePizza(id);\n  if (!deletedPizza) return res.sendStatus(404);\n\n  return res.json(deletedPizza);\n});\n\n// Update a pizza based on its id and new values for its parameters\nrouter.patch(\"/:id\", authorize, isAdmin, (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    (\"title\" in body &&\n      (typeof body.title !== \"string\" || !body.title.trim())) ||\n    (\"content\" in body &&\n      (typeof body.content !== \"string\" || !body.content.trim()))\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const pizzaToUpdate: PizzaToUpdate = body;\n\n  const id = Number(req.params.id);\n  const updatedPizza = updatePizza(id, pizzaToUpdate);\n  if (!updatedPizza) return res.sendStatus(404);\n\n  return res.json(updatedPizza);\n});\n```\n\nPour vous assurer que les op√©rations de suppression et de modification sont bien fonctionnelles, veuillez mettre √† jour les requ√™tes associ√©es afin d'utiliser un token. Veuillez mettre √† jour **`/REST Client/pizzas.http`** en ajoutant ces lignes :\n\n```http numbered highlighting=\"25,30\"\n### Delete pizza identified by 2 with the admin token\nDELETE {{baseUrl}}/pizzas/2\nAuthorization: {{admin.response.body.token}}\n\n### Update the pizza identified by 6 with the admin token\nPATCH {{baseUrl}}/pizzas/6\nContent-Type: application/json\nAuthorization: {{admin.response.body.token}}\n\n{\n    \"title\":\"Magic Green 2\"\n}\n```\n\nVeuillez ex√©cutez les requ√™tes de type **DELETE** et de type **PATCH** afin de vous assurer que l'API est en ordre.\n\nEn cas de souci, vous pouvez utiliser le code du tutoriel [auths](https://github.com/e-vinci/ts-demos/tree/main/back/api/auths).\n\nSi vous le souhaitez, vous pouvez aussi faire les modifications pour les ressources de type \"drinks\".\n\nVeuillez mettre √† jour **`/routes/drinks`** pour ajouter l'appel aux fonctions middleware **`authorize`** et **`isAdmin`** pour les op√©rations de cr√©ation, suppression et de modification :\n\n```ts numbered highlighting=\"1,25,34\"\nrouter.post(\"/\", authorize, isAdmin, (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    !(\"title\" in body) ||\n    !(\"image\" in body) ||\n    !(\"volume\" in body) ||\n    !(\"price\" in body) ||\n    typeof body.title !== \"string\" ||\n    typeof body.image !== \"string\" ||\n    typeof body.volume !== \"number\" ||\n    typeof body.price !== \"number\" ||\n    !body.title.trim() ||\n    !body.image.trim() ||\n    body.volume <= 0 ||\n    body.price <= 0\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { title, image, volume, price } = body as NewDrink;\n\n  const newDrink = createOneDrink({ title, image, volume, price });\n  return res.json(newDrink);\n});\n\nrouter.delete(\"/:id\", authorize, isAdmin, (req, res) => {\n  const id = Number(req.params.id);\n  const deletedDrink = deleteOneDrink(id);\n  if (!deletedDrink) {\n    return res.sendStatus(404);\n  }\n  return res.json(deletedDrink);\n});\n\nrouter.patch(\"/:id\", authorize, isAdmin, (req, res) => {\n  const id = Number(req.params.id);\n\n  const body: unknown = req.body;\n\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    (\"title\" in body &&\n      (typeof body.title !== \"string\" || !body.title.trim())) ||\n    (\"image\" in body &&\n      (typeof body.image !== \"string\" || !body.image.trim())) ||\n    (\"volume\" in body &&\n      (typeof body.volume !== \"number\" || body.volume <= 0)) ||\n    (\"price\" in body && (typeof body.price !== \"number\" || body.price <= 0))\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { title, image, volume, price }: Partial<NewDrink> = body;\n\n  const updatedDrink = updateOneDrink(id, { title, image, volume, price });\n\n  if (!updatedDrink) {\n    return res.sendStatus(404);\n  }\n\n  return res.json(updatedDrink);\n});\n```\n\nN'oubliez pas de faire l'import de **`authorize`** et **`isAdmin`** au d√©but du fichier **`/routes/drinks.ts`**.\n\nPour tester les op√©rations de cr√©ation, de suppression et de modification sur des ressources de type \"drinks\", veuillez mettre √† jour le script **`/REST Client/drinks.http`** :\n  \n```http numbered highlighting=\"12-20,25,38,49,55\"\n### Read all drinks with File variable\n@baseUrl = http://localhost:3000\nGET {{baseUrl}}/drinks\n\n### Read a single drink\nGET {{baseUrl}}/drinks/3\n\n### Read all drinks cheaper or equal to 3 ‚Ç¨\nGET {{baseUrl}}/drinks/?budget-max=3\n\n### Create a drink\n##### Define a request variable named admin :\n# @name admin\nPOST {{baseUrl}}/auths/login\nContent-Type: application/json\n\n{\n    \"username\":\"admin\",\n    \"password\":\"admin\"\n}\n\n### Create a drink with the admin token\nPOST {{baseUrl}}/drinks\nContent-Type: application/json\nAuthorization: {{admin.response.body.token}}\n\n{\n    \"title\":\"Virgin Tonic\",\n    \"image\":\"https://plus.unsplash.com/premium_photo-1668771899398-1cdd763f745e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D\",\n    \"volume\":0.25,\n    \"price\":4.5    \n}\n\n\n### Try to create a drink with incomplete data\nPOST {{baseUrl}}/drinks\nContent-Type: application/json\nAuthorization: {{admin.response.body.token}}\n\n\n{\n    \"title\":\"Missing Data Drink\",\n    \"volume\":0.25,\n    \"price\":4.5    \n}\n\n### Delete a drink\nDELETE {{baseUrl}}/drinks/5\nAuthorization: {{admin.response.body.token}}\n\n\n### Update a drink\nPATCH {{baseUrl}}/drinks/3\nContent-Type: application/json\nAuthorization: {{admin.response.body.token}}\n\n{\n    \"title\":\"Citronnade\"\n}\n```\n\n# <InternalPageTitle> S√©curisation des passwords </InternalPageTitle>\n\nNous souhaitons maintenant assurer que les passwords enregistr√©s dans un support de donn√©es (un fichier ou une base de donn√©es) ne puissent pas √™tre r√©cup√©r√©s.\n\nüëç Pour ce faire, il est recommand√© d'hacher les passwords avant de les enregistrer au niveau d'une API.\n\nAfin de se prot√©ger contre les \"hash attacks\", on utilise du **salt** :\n- un **salt** : c'est une donn√©e al√©atoire qui est utilis√© en entr√©e d'une fonction qui hache des donn√©es. Ainsi, si un hacker utilise une base de donn√©es de passwords hach√©s, il devra en plus trouver le bon **salt** pour que son attaque puisse fonctionner.\n- **salt round** : nombre de fois que l'op√©ration de hachage est faite, rendant les attaques de force brute plus lente et donc difficile ; une valeur de **10** semble √™tre g√©n√©ralement raisonnable et recommand√©e. \n\nPour hacher sous Node.js, nous utiliserons la librairie [bcrypt](https://www.npmjs.com/package/bcrypt).\n\nVeuillez installer la librairie **`bcrypt`** et les types associ√©s √† bcrypt au sein de votre API **`auths`** :\n```bash\nnpm i bcrypt \nnpm i @types/bcrypt -D\n```\n\nEn r√©sum√©, nous allons utiliser :\n- la fonction asynchrone **`hash`** de **`bcrypt`** pour **hacher un password** ;\n- la fonction asynchrone **`compare`** de **`bcrypt`** pour **comparer un password en clair √† un password hach√©** ; si le r√©sultat est positif, cela signifie que le password fournit pour un utilisateur correspond au password initial.\n\nNous pr√©f√©rons utiliser les librairies asynchrone afin que l'API reste disponible √† g√©rer des requ√™tes clientes et ne bloque pas celles-ci jusqu'√† la fin d'une op√©ration de **`bcrypt`** !\n\nVeuillez effacer le fichier **`/data/users.json`** contenant les credentials d'utilisateurs o√π les passwords sont donn√©s en clair.\n\nNous allons maintenant mettre √† jour le service \"users\" pour utiliser **`bcrypt`**. Veuillez modifier **`/services/users.ts`** :\n```ts numbered highlighting=\"2,10,18,22,25,28-29,45,48,52,76,79,87\"\nimport jwt from \"jsonwebtoken\";\nimport bcrypt from \"bcrypt\";\nimport path from \"node:path\";\nimport { parse, serialize } from \"../utils/json\";\nimport { AuthenticatedUser, User } from \"../types\";\n\nconst jwtSecret = \"ilovemypizza!\";\nconst lifetimeJwt = 24 * 60 * 60 * 1000; // in ms : 24 * 60 * 60 * 1000 = 24h\n\nconst saltRounds = 10;\n\nconst jsonDbPath = path.join(__dirname, \"/../data/users.json\");\n\nconst defaultUsers: User[] = [\n  {\n    id: 1,\n    username: \"admin\",\n    password: bcrypt.hashSync(\"admin\", saltRounds),\n  },\n];\n\nasync function login(\n  username: string,\n  password: string\n): Promise<AuthenticatedUser | undefined> {\n  const userFound = readOneUserFromUsername(username);\n  if (!userFound) return undefined;\n  const passwordMatch = await bcrypt.compare(password, userFound.password);\n  if (!passwordMatch) return undefined;\n\n  const token = jwt.sign(\n    { username }, // session data added to the payload (payload : part 2 of a JWT)\n    jwtSecret, // secret used for the signature (signature part 3 of a JWT)\n    { expiresIn: lifetimeJwt } // lifetime of the JWT (added to the JWT payload)\n  );\n\n  const authenticatedUser: AuthenticatedUser = {\n    username,\n    token,\n  };\n\n  return authenticatedUser;\n}\n\nasync function register(\n  username: string,\n  password: string\n): Promise<AuthenticatedUser | undefined> {\n  const userFound = readOneUserFromUsername(username);\n  if (userFound) return undefined;\n\n  await createOneUser(username, password);\n\n  const token = jwt.sign(\n    { username }, // session data added to the payload (payload : part 2 of a JWT)\n    jwtSecret, // secret used for the signature (signature part 3 of a JWT)\n    { expiresIn: lifetimeJwt } // lifetime of the JWT (added to the JWT payload)\n  );\n\n  const authenticatedUser: AuthenticatedUser = {\n    username,\n    token,\n  };\n\n  return authenticatedUser;\n}\n\nfunction readOneUserFromUsername(username: string) {\n  const users = parse(jsonDbPath, defaultUsers);\n  const userFound = users.find((user) => user.username === username);\n  if (!userFound) return undefined;\n\n  return userFound;\n}\n\nasync function createOneUser(username: string, password: string) {\n  const users = parse(jsonDbPath, defaultUsers);\n\n  const hashedPassword = await bcrypt.hash(password, saltRounds);\n\n  const nextId =\n    users.reduce((acc, user) => (user.id > acc ? user.id : acc), 0) + 1;\n\n  const createdUser: User = {\n    id: nextId,\n    username,\n    password: hashedPassword,\n  };\n\n  users.push(createdUser);\n\n  serialize(jsonDbPath, users);\n\n  return createdUser;\n}\n\nexport { login, register, readOneUserFromUsername };\n```\n\nVoici les modifications apport√©es :\n- **pour cr√©er un password hach√©** : on utilise la fonction asynchrone **`hash`** pour cr√©er le password hach√©. D√®s lors, **`createOneUser`** devient asynchrone. De plus, comme **`createOneUser`** est devenue asynchrone, dans **`register`**, pour cha√Æner le traitement de cr√©ation du token, on met un **`await`** √† l'appel de **`createOneUser`**. Et comme un **`await`** est ajout√© au sein de **`register`**, il faut mettre un **`async`** √† la m√©thode **`register`**. Attention, du coup, comme **`register`** est devenue asynchrone, il faudra aussi bien cha√Æner les traitements o√π **`register`** est appel√©, dans le router **`auths`**. Notez aussi que nous avons chang√© le type de retour des fonctions asynchrones qui renvoient maintenant des **`Promise`**.\n- **pour v√©rifier qu'un password en clair \"match\" √† un password hach√©** : on utilise la fonction asynchrone **`compare`** que l'on cha√Æne √† la cr√©ation du token √† l'aide de **`await`**. D√®s lors, la fonction **`login`** doit elle aussi √™tre d√©clar√©e **`async`**. Attention, du coup, comme `login` est devenue asynchrone, il faudra bien cha√Æner les traitements o√π **`login`** est appel√©, dans le router **`auths`**.\n- **pour cr√©er l'utilisateur **`admin`** se trouvant dans les **`defaultUsers`** avec des credentials par d√©faut** : on souhaite indiquer comme **`password`** le password hach√© correspondant au password **`\"admin\"`**. Pour se simplifier la vie, on appelle la fonction synchrone **`hashSync`** (voir ligne 18). Bien √©videmment, dans une application robuste et s√©curis√©e, il est interdit de coder en dur ce genre de secrets dans les sources de notre application üòâ !\n\nAfin de traiter des deux fonctions du service **`users`** qui sont devenues asynchrones, **`login`** et **`register`**, nous allons modifier le router **`/routes/auths`** :\n```ts numbered highlighting=\"13,30,40,57\"\n/* eslint-disable @typescript-eslint/no-misused-promises */\n/* \nIn Express V4, asynchronous functions are not fully supported in TypeScript \n(only void return type for RequestHandler is allowed). \nIn Express V5, this issue has been addressed, but V5 is still in beta. \nConsequently, the ESLint rule \"no-misused-promises\" is disabled. */\nimport { Router } from \"express\";\nimport { PotentialUser } from \"../types\";\nimport { login, register } from \"../services/users\";\nconst router = Router();\n\n/* Register a user */\nrouter.post(\"/register\", async (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    !(\"username\" in body) ||\n    !(\"password\" in body) ||\n    typeof body.username !== \"string\" ||\n    typeof body.password !== \"string\" ||\n    !body.username.trim() ||\n    !body.password.trim()\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { username, password } = body as PotentialUser;\n\n  const authenticatedUser = await register(username, password);\n\n  if (!authenticatedUser) {\n    return res.sendStatus(409);\n  }\n\n  return res.json(authenticatedUser);\n});\n\n/* Login a user */\nrouter.post(\"/login\", async (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    !(\"username\" in body) ||\n    !(\"password\" in body) ||\n    typeof body.username !== \"string\" ||\n    typeof body.password !== \"string\" ||\n    !body.username.trim() ||\n    !body.password.trim()\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { username, password } = body as PotentialUser;\n\n  const authenticatedUser = await login(username, password);\n\n  if (!authenticatedUser) {\n    return res.sendStatus(401);\n  }\n\n  return res.json(authenticatedUser);\n});\n\nexport default router;\n```\n\nNous avons simplement cha√Æn√© les r√©ponses √† faire au client seulement une fois les op√©rations **`register`** et **`login`** termin√©es. Pour ce faire, nous avons pr√©c√©d√© le nom de ces m√©thodes par **`await`**. Nous avons donc du ajouter **`async`** aux fonctions middleware s'occupant des routes **`POST /auths/register`** et **`POST /auths/login`**.\n\nNotons que nous avons ajout√© un commentaire pour d√©sactiver la r√®gle **`@typescript-eslint/no-misused-promises`**. En effet, dans Express V4, les fonctions asynchrones ne sont pas pleinement support√©es en TypeScript (seul le type de retour **`void`** pour **`RequestHandler`** est autoris√©). Dans Express V5, ce probl√®me a √©t√© r√©solu, mais V5 est toujours en version b√™ta. Par cons√©quent, la r√®gle ESLint **`no-misused-promises`** est d√©sactiv√©e.\n\nVeuillez v√©rifier que votre application fonctionne correctement.  \nVia l'IHM, veuillez faire un register d'un nouvel utilisateur.  \nAu niveau de l'API, allez voir le contenu du nouveau fichier **`/data/users.json`**. Les passwords devraient maintenant √™tre hach√©s, comme par exemple :\n\n```json\n[\n  {\n    \"id\": 1,\n    \"username\": \"admin\",\n    \"password\": \"$2b$10$RioLKlPFyYFEhv/46gR7dufDkke07eDpWH9tBt/A4Z9tJh0oJnnf2\"\n  },\n  {\n    \"id\": 2,\n    \"username\": \"manager\",\n    \"password\": \"$2b$10$NZZ1zxOPdby6gl4Dw8K0Q.v4ZRWTbh1Ta7qcYzH5G4SrO5z71H0kO\"\n  }\n]\n```\n\nEn cas de souci, vous pouvez utiliser le code du tutoriel [auths](https://github.com/e-vinci/ts-demos/tree/main/back/api/auths).\n\n# <InternalPageTitle> Exercice 3.1 : Authentification & autorisation d'op√©rations </InternalPageTitle>\n\nVous allez s√©curiser la RESTful API de **myMovies**.\n\nVeuillez cr√©er un nouveau projet ans votre repo git dans **`/exercises/3.1`** en clonant le boilerplate du cours offrant l'authentification et l'autorisation JWT : [jwt-ts-api-boilerplate](https://github.com/e-vinci/jwt-ts-api-boilerplate). Dans ce boilerplate, vous trouverez d√©j√† un service **`users`** qui g√®re les utilisateurs, ainsi que des routes pour les op√©rations de **`login`** et de **`register`**.\n\nDans ce projet, dans un premier temps, sans utiliser JWT, veuillez int√©grer le code utile de vos op√©rations (router & service de **`films`**, requ√™tes HTTP pour tester les op√©rations sur les **`films`**) de votre **`/exercises/1.8`**. \n\nUne fois que vous op√©rations sur les films sont bien int√©gr√©es, veuillez planifier de nouvelles op√©rations et quelles op√©rations prot√©ger par JWT. \n\nPour les nouvelles op√©rations, vous devez pouvoir ajouter des commentaires sur un film et lire tous les commentaires associ√©s √† un film.\n\nPour la protection des op√©rations, vous ne devez pas g√©rer de r√¥les, mais simplement v√©rifier que l'utilisateur est authentifi√©.\n\nVeuillez d'abord identifier toutes les op√©rations mises √† disposition par votre API (y compris l'authentification), ainsi que si celles-ci sont prot√©g√©es par JWT, au sein du fichier **`README.md`** (fichier Markdown) de votre projet. Voici un exemple de comment nous vous recommandons de documenter votre API, sous forme de tableau : \n\n| URI | M√©thode HTTP | Auths? | Op√©ration |\n|---|---|---|---|\n| **`films`** | GET | Non | READ ALL : Lire toutes les ressources de la collection |\n| ... | ... | ... | ... |\n| **`comments`** | GET | JWT | READ ALL FILTERED : Lire toutes les ressources de la collection |\n| **`comments`** | POST | JWT | CREATE ONE : Cr√©er une ressource bas√©e sur les donn√©es de la requ√™te |\n| ... | ... | ... | ... |\n\n<br/>\n\nUne fois la documentation de votre API pr√™te, vous pouvez commencer par prot√©ger les op√©rations existantes et les tester avec Rest Client.\n\nUne fois que tout est fonctionnel, vous pouvez impl√©menter les nouvelles op√©rations de gestion de commentaires et les prot√©ger par JWT.\n\nVeuillez v√©rifier que vos op√©rations sont bien prot√©g√©es et fonctionnelles en les testant avec Rest Client.\n\nQuand un prototype d'api est finalis√© et test√©, veuillez faire un **`commit`** de votre code avec comme message : **`new: ex3.1`**.\n\n#### ü§ù Tips\nComment cr√©er un tableau dans un fichier Markdown (pour **`README.md`**) ?  \nVoici deux options :\n- Soit vous utiliser des **`|`** pour d√©limiter les cellules et des **`|---|`** pour s√©parer les headers du corps du tableau. \nVoici le Markdown de l'exemple donn√© ci-dessus :\n```text\n| URI | M√©thode HTTP | Auths? | Op√©ration |\n|---|---|---|---|\n| **`films`** | GET | Non | READ ALL : Lire toutes les ressources de la collection |\n| ... | ... | ... | ... |\n| **`comments`** | GET | JWT | READ ALL FILTERED : Lire toutes les ressources de la collection |\n| **`comments`** | POST | JWT | CREATE ONE : Cr√©er une ressource bas√©e sur les donn√©es de la requ√™te |\n| ... | ... | ... | ... |\n```\n- Soit c'est simplement un tableau HTML (`<table>`).\n\n# <InternalPageTitle> üç¨ Exercice 3.2 : une autre API s√©curis√©e </InternalPageTitle>\n\nCet exercice est optionnel, n'h√©sitez pas √† le faire si vous avez du temps.\n\nPeut-√™tre avez-vous d√©j√† entendu parler de cette mode montante dans le Web qu'est la JAMstack ?\n\nNous souhaitons d√©velopper un Headless CMS, c'est-√†-dire un outil permettant de cr√©er du contenu, tr√®s souvent utilis√© dans le cadre de sites JAMstack.\n\nUn Headless CMS fournira une interface web pour cr√©er du contenu (ou des donn√©es), ainsi qu'une RESTful API mettant √† disposition ce contenu.\n\nL'Headless CMS que nous souhaitons d√©velopper doit permettre de cr√©er le contenu associ√© √† un blog.\n\nUn blog sera structur√© en pages. Une page aura un id, un titre, un URI, un contenu, un auteur ainsi qu'un statut de publication.\n\nLe statut de publication d'une page peut actuellement prendre comme valeur :\n- ¬´ hidden ¬ª\n- ¬´ published ¬ª\n\nSeul un utilisateur authentifi√© pourra lire, cr√©er, modifier ou supprimer des pages.\n\nLa modification d'une page, tout comme la suppression d'une page ne pourra se faire que par son auteur.\n\nL'ajout ou la modification d'une page ne sera possible que si le statut de publication donn√© correspond √† un des deux statuts actuels (¬´ hidden ou ¬´ published ¬ª). Sinon un message d'erreur devra √™tre renvoy√©.\n\nLa lecture d'une page, ou de toutes les pages, pourra √™tre r√©alis√©e par n'importe quel utilisateur authentifi√© pour les pages dont le statut vaut ¬´ published ¬ª.\n\nPour les pages dont le statut vaut ¬´ hidden ¬ª, seul leur auteur authentifi√© pourra les lire.\n\nVeuillez cr√©er un nouveau projet dans votre repo git dans **`/exercises/3.2`** sur base du boilerplate : [jwt-ts-api-boilerplate](https://github.com/e-vinci/jwt-ts-api-boilerplate).\n\n‚ö° Si vous avez fait un clone du boilerplate, attention au Git dans le Git, n'oubliez pas de supprimer le dossier **`.git`** pr√©sent dans votre nouveau projet.\n\nPuis, veuillez formaliser les op√©rations associ√©es √† vos RESTful APIs sous forme d'un tableau dans un fichier **`README.md`**.\n\nVeuillez tester toutes les m√©thodes offertes par votre application √† l'aide du client HTTP de REST Client.\n\nVeuillez faire un **`commit`** de votre code avec le message suivant : **`new: ex3.2`**.\n\n## üç¨ Bonus \n- N¬∞1 : vous souhaitez rapidement d√©couvrir les principes d'une architecture Web associ√©e √† la JAMstack ? https://jamstack.wtf/\n- N¬∞2 : si vous souhaitez d√©couvrir le format Markdown, notamment tr√®s souvent utilis√© dans certains sites JAMstack (source des donn√©es pour certains Headless CMS) : https://www.markdownguide.org/basic-syntax/\n\n\n## üç¨ Challenges\n- N¬∞1 : Modifiez les autorisations au niveau des op√©rations de lecture : la lecture d'une page, ou de toutes les pages, pourra √™tre r√©alis√©e par n'importe quel utilisateur anonyme ou authentifi√© pour les pages dont le statut vaut ¬´ published ¬ª. Pour les pages dont le statut vaut ¬´ hidden ¬ª, seul leur auteur authentifi√© pourra les lire.\nN¬∞2 : lorsqu'un utilisateur tente d'effacer ou modifier une page dont il n'est pas l'auteur, renvoyez un code d'erreur appropri√© au client.\nN¬∞3 : Si √ßa n'est pas d√©j√† fait, pensez √† ne pas renvoyer les passwords des utilisateurs dans les r√©ponses de votre API.\n\n# <InternalPageTitle> üç¨ Authentification & autorisation JWT √† l'aide de cookies </InternalPageTitle>\n\n## Pourquoi utiliser l'autorisation JWT √† l'aide de cookies ?\n\nNous avons vu une fa√ßon de g√©rer des token JWT, sans g√©rer de cookies.\n\nCela impose aux client de sauvegarder les tokens et de les envoyer dans un **`authorization header`** lorsqu'ils souhaitent acc√©der √† une op√©ration prot√©g√©e.\n\nIl est aussi possible d'int√©grer les tokens au sein de cookies. Dans ce cas-l√†, les clients qui ont re√ßu un cookie de l'API renverront automatiquement ce cookie (m√©canisme des browsers). Les tokens JWT voyageront automatiquement gr√¢ce au m√©canisme de cookies.\n\nüí≠ Faut-il mieux int√©grer les token JWT dans des cookies ou pas ?  \nIl est difficile de donner une r√©ponse √† cette question. Chaque approche a des avantages et des inconv√©nients. Ce qui devrait √™tre le point d'attention, c'est la s√©curit√©. Et dans les deux cas, on atteint un niveau de s√©curit√© raisonnable.\nPour ce cours, nous avons choisi la fa√ßon la plus moderne, en laissant au client le choix de sauvegarder les token dans le web storage (nous allons voir √ßa tout prochainement pour l'aspect frontend).  \nNotons que le cas le plus s√ªr est probablement d'avoir deux types de token, ce qui est d'une complexit√© qui d√©passe les objectifs de ce cours. N√©anmoins, pour votre info, les m√©canismes d'authentification comme OAuth (authorization de MS Azure) & OpenID Connect (authentification de MS Azure) g√®re deux types de token :\n- un token √† dur√©e de vie courte qui sera enregistr√© en m√©moire vive au niveau du client (access token) ou dans le web storage.\n- un token √† dur√©e de vie longue qui sera enregistr√© par le client dans un cookie (refresh token, notamment utilis√© par l'API pour cr√©er un nouvel access token).\n\n## Un cookie, c'est quoi ?\n\nUn **cookie** repr√©sente des donn√©es qu'un serveur envoie √† un browser.  \nLe browser peut sauver ce cookie. Pour chaque requ√™te faite au serveur sur la m√™me origine (que l'origine o√π le cookie a √©t√© re√ßu), le cookie sera automatiquement envoy√© au serveur.\n\nIl fut un temps o√π les cookies √©taient utilis√©s comme un m√©canisme g√©n√©ral de stockage de donn√©es c√¥t√© client. \n\nüëç Actuellement, si les cookies sont utilis√©s pour sauvegarder les donn√©es de session, il faut se prot√©ger contre les attaques XSS et rendre les cookies inaccessibles au JavaScript : on utilise donc les cookies **`HttpOnly`** qui sont inaccessibles √† la **`Document.cookie API`**. \n\nPour la suite, on va donc voir :\n- comment utiliser Express pour cr√©er des cookies au niveau d'une API ;\n- comment rendre ces cookies inaccessibles aux attaques XSS en configurant **`HttpOnly`**.\n\n## Impl√©mentation de l'authentification & l'autorisation JWT au sein de cookies\n\n### Intro\n\nNous allons donc cr√©er une nouvelle version de l'API sauvegardant le token d'un utilisateur au sein d'un cookie, ainsi que son username, sans que ces infos soient accessible au JS c√¥t√© client.\n\nPour ce faire nous allons utiliser la librairie [cookie-session](https://github.com/expressjs/cookie-session) qui permet d'enregistrer des donn√©es de session dans des cookies.\n\nVeuillez cr√©er un nouveau projet nomm√© **`/back/api/cookies`** sur base d'un copi√©/coll√© du projet [auths](https://github.com/e-vinci/ts-demos/tree/main/back/api/auths)).\n\nVeuillez installer la librairie **`cookie-session`** au sein de votre nouveau projet **`cookies`** et les types associ√©s (pour TypeScript):\n```bash\nnpm i cookie-session\nnpm install @types/cookie-session -D\n```\n\n### Utilisation de la fonction middleware **`cookieSession`**\n\nVeuillez mettre √† jour **`/app.ts`** pour mettre en place la gestion de cookies :\n\n```ts numbered highlighting=\"2,11-20\"\nimport express, { ErrorRequestHandler } from \"express\";\nimport cookieSession from \"cookie-session\";\n\nimport usersRouter from \"./routes/users\";\nimport pizzaRouter from \"./routes/pizzas\";\nimport drinkRouter from \"./routes/drinks\";\nimport authsRouter from \"./routes/auths\";\n\nconst app = express();\n\nconst expiryDateIn3Months = new Date(Date.now() + 1000 * 60 * 60 * 24 * 30 * 3);\nconst cookieSecreteKey = 'YouWouldnot!not!like!mypizza';\napp.use(\n  cookieSession({\n    name: 'user',\n    keys: [cookieSecreteKey],  \n    httpOnly: true,\n    expires: expiryDateIn3Months,\n  }),\n);\n\napp.use((_req, _res, next) => {\n  console.log(\n    \"Time:\",\n    new Date().toLocaleString(\"fr-FR\", { timeZone: \"Europe/Brussels\" })\n  );\n  next();\n});\n\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use(\"/users\", usersRouter);\napp.use(\"/pizzas\", pizzaRouter);\napp.use(\"/drinks\", drinkRouter);\napp.use(\"/auths\", authsRouter);\n\nconst errorHandler: ErrorRequestHandler = (err, _req, res, _next) => {\n  console.error(err.stack);\n  return res.status(500).send(\"Something broke!\");\n};\n\napp.use(errorHandler);\nexport default app;\n```\n\nNous avons donc bien indiqu√© que le cookie est inaccessible au JS via : **`httpOnly: true`**.\n\nNous avons fait en sorte que le cookie soit sign√© via la cl√© **`cookieSecreteKey`**.  \nLe m√©canisme de signature correspond √† ce qui a √©t√© vu dans le cadre des tokens JWT.  \nAinsi, si un cookie venait √™tre modifi√© par un utilisateur, lors de la v√©rification du cookie, cela sera automatiquement d√©tect√© par la fonction middleware **`cookieSession`** et la session ne sera pas cr√©√©e.\n\nPour info, la fonction middleware **`cookieSession`** va cr√©er deux cookies :\n- un cookie portant comme nom la valeur de **`name`** ; il est encod√© en base64. N'h√©sitez pas √† vous amuser √† d√©coder un cookie g√©n√©r√© par **`cookieSession`** sur [base64decode](https://www.base64decode.org/).\n- un cookie portant comme nom la valeur de **`name`** + **`.sig`** : c'est la signature qui pr√©vient contre le \"tempering\" (acte intentionnel mais non autoris√© qui am√®ne √† la modification d'un syst√®me ou de donn√©es).\n\n### Lecture et ajout de donn√©es de session via `req.session`\n\nPour cr√©er des donn√©es de session, il suffit de simplement les ajouter √† l'objet **`req.session`**.\n\nDans le cadre de la RESTful API g√©rant les pizzas, cela est fait lors d'une op√©ration de type **`register`** ou **`login`**.\n\nVeuillez mettre √† jour le router **`/routes/auths.ts`** :\n\n```ts numbered highlighting=\"36,65,70-74,76-85\"\n/* eslint-disable @typescript-eslint/no-misused-promises */\n/* \nIn Express V4, asynchronous functions are not fully supported in TypeScript \n(only void return type for RequestHandler is allowed). \nIn Express V5, this issue has been addressed, but V5 is still in beta. \nConsequently, the ESLint rule \"no-misused-promises\" is disabled. */\nimport { Request, Router } from \"express\";\nimport { AuthenticatedUser, PotentialUser } from \"../types\";\nimport { login, register } from \"../services/users\";\nconst router = Router();\n\n/* Register a user */\nrouter.post(\"/register\", async (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    !(\"username\" in body) ||\n    !(\"password\" in body) ||\n    typeof body.username !== \"string\" ||\n    typeof body.password !== \"string\" ||\n    !body.username.trim() ||\n    !body.password.trim()\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { username, password } = body as PotentialUser;\n\n  const authenticatedUser = await register(username, password);\n\n  if (!authenticatedUser) {\n    return res.sendStatus(409);\n  }\n\n  createCookieSessionData(req, authenticatedUser);\n\n  return res.json({ username: authenticatedUser.username });\n});\n\n/* Login a user */\nrouter.post(\"/login\", async (req, res) => {\n  const body: unknown = req.body;\n  if (\n    !body ||\n    typeof body !== \"object\" ||\n    !(\"username\" in body) ||\n    !(\"password\" in body) ||\n    typeof body.username !== \"string\" ||\n    typeof body.password !== \"string\" ||\n    !body.username.trim() ||\n    !body.password.trim()\n  ) {\n    return res.sendStatus(400);\n  }\n\n  const { username, password } = body as PotentialUser;\n\n  const authenticatedUser = await login(username, password);\n\n  if (!authenticatedUser) {\n    return res.sendStatus(401);\n  }\n\n  createCookieSessionData(req, authenticatedUser);\n\n  return res.json({ username: authenticatedUser.username });\n});\n\n/* Logout a user */\nrouter.get(\"/logout\", (req, res) => {\n  req.session = null;\n  return res.sendStatus(200);\n});\n\nfunction createCookieSessionData(\n  req: Request,\n  authenticatedUser: AuthenticatedUser\n) {\n  if (!req.session) {\n    return;\n  }\n  req.session.username = authenticatedUser.username;\n  req.session.token = authenticatedUser.token;\n}\n\nexport default router;\n```\n\nDans le code ci-dessus, nous pr√©parons les donn√©es de session qui seront √©crites dans le cookie √† l'aide de l'objet **`req.session`**.  \nLorsque nous renvoyons du JSON aux clients, nous ne renvoyons plus le token, mais juste le username de l'utilisateur. L'application cliente, le browser, pourra utiliser cette info pour afficher le nom de l'utilisateur. Pour rappel, le browser n'a pas acc√®s, via le JS, √† l'info se trouvant dans le cookie.\n\nQuand nous g√©rons une session via des cookies, il n'est pas √©vident de bien clore une session. Nous avons cr√©√© une nouvelle op√©ration de type **`GET /auths/logout`** qui permet d'effacer les donn√©es de session d'un utilisateur.\n\nIl nous reste √† changer le m√©canisme d'autorisation.\nLes tokens ne seront plus re√ßus via un authorization header, mais via un cookie.  \nNous allons donc mettre √† jour le middleware **`/utils/authorize`** :\n\n```ts numbered highlighting=\"13-16\"\nimport jwt from \"jsonwebtoken\";\nimport { readOneUserFromUsername } from \"../services/users\";\nimport { NextFunction, RequestHandler, Response } from \"express\";\nimport { AuthenticatedRequest, JwtPayload, User } from \"../types\";\n\nconst jwtSecret = \"ilovemypizza!\";\n\nconst authorize = (\n  req: AuthenticatedRequest,\n  res: Response,\n  next: NextFunction\n) => {\n  if (!req.session) {\n    return res.sendStatus(401);\n  }\n  const { token } = req.session;\n  if (!token) {\n    return res.sendStatus(401);\n  }\n\n  try {\n    const decoded = jwt.verify(token, jwtSecret) as JwtPayload;\n    const { username } = decoded;\n\n    const existingUser = readOneUserFromUsername(username);\n\n    if (!existingUser) {\n      return res.sendStatus(401);\n    }\n\n    req.user = existingUser; // request.user object is available in all other middleware functions\n    return next();\n  } catch (err) {\n    console.error(\"authorize: \", err);\n    return res.sendStatus(401);\n  }\n};\n\nconst isAdmin: RequestHandler = (req: AuthenticatedRequest, res, next) => {\n  const { username } = req.user as User;\n\n  if (username !== \"admin\") {\n    return res.sendStatus(403);\n  }\n  return next();\n};\n\nexport { authorize, isAdmin };\n```\n\n# <InternalPageTitle> üç¨ Test via REST Client d'une RESTful API attendant des cookies </InternalPageTitle>\n\nIl nous reste √† tester nos requ√™tes via REST Client.\n\nIl n'y a pas de nouvelles notions √† apprendre pour utiliser REST Client avec des cookies : le comportement par d√©faut de REST Client, lorsqu'un cookie est renvoy√© dans une r√©ponse, est d'inclure ce cookie dans chaque requ√™te vers la m√™me origine.\n\nD√®s lors, pour tester l'API, il suffit d'enlever tous les authorization headers et de rajouter une requ√™te pour tester l'effacement d'une session.\n\nVeuillez tester les requ√™tes √† l'aide de **`/REST Client/pizzas.http`** :\n\n```http\n######### NORMAL OPERATION  ###########\n\n### Read all pizzas\nGET http://localhost:3000/pizzas\n\n### Read all pizzas with File variable\n@baseUrl = http://localhost:3000\nGET {{baseUrl}}/pizzas\n\n### Read all pizzas sorted by title (ascending)\nGET {{baseUrl}}/pizzas/?order=+title\n\n### Read all pizzas sorted by title (descending)\nGET {{baseUrl}}/pizzas/?order=-title\n\n### Read pizza identified by 2\nGET {{baseUrl}}/pizzas/2\n\n### Create a pizza by using the admin account\n#### First login as the admin\nPOST {{baseUrl}}/auths/login\nContent-Type: application/json\n\n{\n    \"username\":\"admin\",\n    \"password\":\"admin\"\n}\n\n#### Create a pizza with the admin token\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\n\n{\n    \"title\":\"Magic Green\",\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n\n### Delete pizza identified by 2 with the admin token\nDELETE {{baseUrl}}/pizzas/2\n\n### Update the pizza identified by 6 with the admin token\nPATCH {{baseUrl}}/pizzas/6\nContent-Type: application/json\n\n{\n    \"title\":\"Magic Green 2\"\n}\n\n\n######### ERROR OPERATION  ###########\n\n### 1. Create a pizza without a token\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\n\n{\n    \"title\":\"Magic Green\",\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n\n### 2. Create a pizza without being the admin, use manager account\n#### 2.1 First login as the manager\nPOST {{baseUrl}}/auths/login\nContent-Type: application/json\n\n{\n    \"username\":\"manager\",\n    \"password\":\"manager\"\n}\n\n#### 2.2 Try to create a pizza with the manager token\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\n\n{\n    \"title\":\"Magic Green\",\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n\n### Read pizza which does not exists\nGET {{baseUrl}}/pizzas/100\n\n### Create a pizza which lacks a property\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\n\n{\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n\n### Create a pizza without info for a property\nPOST {{baseUrl}}/pizzas\nContent-Type: application/json\n\n{\n    \"title\":\"\",\n    \"content\":\"Epinards, Brocolis, Olives vertes, Basilic\"\n}\n\n### Update for a pizza which does not exist\nPATCH {{baseUrl}}/pizzas/200\nContent-Type: application/json\n\n{\n    \"title\":\"Magic Green 2\"\n}\n\n### Update for a pizza which does not provide any info for a property\nPATCH {{baseUrl}}/pizzas/1\n\nContent-Type: application/json\n\n{\n    \"title\":\"Magic Green 2\",\n    \"content\":\"\"\n}\n```\n\nVeuillez mettre √† jour **`/REST Client/auths.http`** pour tester **`GET /auths/logout`** :\n```http\n### Logout any user\nGET {{baseUrl}}/auths/logout\n```\n\nPour ajouter une pizza, il suffit juste :\n1. De loguer l'admin.\n2. De cr√©er une nouvelle pizza ; le cookie est automatiquement envoy√©.\n\nAdmettons que vous souhaitez tester l'ajout d'une pizza sans envoyer de token :\n1. Lancez l'op√©ration de logout (**`GET /auths/logout`**) ; le cookie renvoy√© ne contient pas de donn√©es de session ;\n2. Tentez la cr√©ation d'une pizza qui renverra un code **`401 Unauthorized`**.\n\nEn cas de souci, vous pouvez utiliser le code du tutoriel [cookies](https://github.com/e-vinci/ts-demos/tree/main/back/api/cookies).","fields":{"slug":"/part3/auths-api/"},"frontmatter":{"title":"JWT auths API & bcrypt","date":null,"navbarExtraStyles":"","headerImage":"","featuredImage":"","description":"S√©curisation d'une RESTful API : Authentification et autorisation d'acc√®s aux op√©rations d'une RESTful API via JWT & bcrypt","autoMargin":true}},"allImages":{"edges":[{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/19c44353d690d2192603058b13677c32/050f3/ex2-16-questions.png","srcSet":"/js2/static/19c44353d690d2192603058b13677c32/050f3/ex2-16-questions.png 370w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/19c44353d690d2192603058b13677c32/89e9c/ex2-16-questions.webp 370w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.908108108108108}},"base":"ex2-16-questions.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/7746eb8f2da2b173501f76b41b709419/31045/ex2-16-score.png","srcSet":"/js2/static/7746eb8f2da2b173501f76b41b709419/31045/ex2-16-score.png 268w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/7746eb8f2da2b173501f76b41b709419/adc83/ex2-16-score.webp 268w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.49253731343283585}},"base":"ex2-16-score.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#683898","images":{"fallback":{"src":"/js2/static/53aa06cf17e4239d0dba6ffd09854e02/0cbce/icon.png","srcSet":"/js2/static/53aa06cf17e4239d0dba6ffd09854e02/0cbce/icon.png 512w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/53aa06cf17e4239d0dba6ffd09854e02/cc23f/icon.webp 512w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}},"base":"icon.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8e848","images":{"fallback":{"src":"/js2/static/94e78cdb1293988b357eb1e6074279d9/8cffc/join.png","srcSet":"/js2/static/94e78cdb1293988b357eb1e6074279d9/8cffc/join.png 26w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/94e78cdb1293988b357eb1e6074279d9/2705a/join.webp 26w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.0769230769230769}},"base":"join.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#080808","images":{"fallback":{"src":"/js2/static/309e0fb8b4416829acfed4f7a501206b/98149/logo_vinci.png","srcSet":"/js2/static/309e0fb8b4416829acfed4f7a501206b/98149/logo_vinci.png 544w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/309e0fb8b4416829acfed4f7a501206b/5eade/logo_vinci.webp 544w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9044117647058824}},"base":"logo_vinci.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8e848","images":{"fallback":{"src":"/js2/static/814c6001016da3a407035f4cfb117ea5/61ec1/quit.png","srcSet":"/js2/static/814c6001016da3a407035f4cfb117ea5/61ec1/quit.png 28w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/814c6001016da3a407035f4cfb117ea5/fad8c/quit.webp 28w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9285714285714286}},"base":"quit.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/13b65def72e9840d86bcf161d0140f2d/487a4/places.png","srcSet":"/js2/static/13b65def72e9840d86bcf161d0140f2d/8d835/places.png 750w,\n/js2/static/13b65def72e9840d86bcf161d0140f2d/9b397/places.png 1080w,\n/js2/static/13b65def72e9840d86bcf161d0140f2d/c1308/places.png 1366w,\n/js2/static/13b65def72e9840d86bcf161d0140f2d/487a4/places.png 1599w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/13b65def72e9840d86bcf161d0140f2d/25f33/places.webp 750w,\n/js2/static/13b65def72e9840d86bcf161d0140f2d/f7d3e/places.webp 1080w,\n/js2/static/13b65def72e9840d86bcf161d0140f2d/cab24/places.webp 1366w,\n/js2/static/13b65def72e9840d86bcf161d0140f2d/e838a/places.webp 1599w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.35709818636647905}},"base":"places.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#0878b8","images":{"fallback":{"src":"/js2/static/216c8f19b48a13e3af5020937c6495fe/3f056/deployment.png","srcSet":"/js2/static/216c8f19b48a13e3af5020937c6495fe/f74f0/deployment.png 750w,\n/js2/static/216c8f19b48a13e3af5020937c6495fe/3f056/deployment.png 881w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/216c8f19b48a13e3af5020937c6495fe/00e18/deployment.webp 750w,\n/js2/static/216c8f19b48a13e3af5020937c6495fe/73e10/deployment.webp 881w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5811577752553916}},"base":"deployment.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/e5078/authorizeNOK.png","srcSet":"/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/8770b/authorizeNOK.png 750w,\n/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/e5078/authorizeNOK.png 809w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/35881/authorizeNOK.webp 750w,\n/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/a88f0/authorizeNOK.webp 809w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6093943139678616}},"base":"authorizeNOK.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/7019197416b607b814455c5cde2bfd8d/8a955/authorizeOK.png","srcSet":"/js2/static/7019197416b607b814455c5cde2bfd8d/8a955/authorizeOK.png 747w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/7019197416b607b814455c5cde2bfd8d/b344d/authorizeOK.webp 747w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6666666666666666}},"base":"authorizeOK.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8d8d8","images":{"fallback":{"src":"/js2/static/02183504e2708ac3e446f29003c8d7bc/60bc5/hacked.png","srcSet":"/js2/static/02183504e2708ac3e446f29003c8d7bc/60bc5/hacked.png 744w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/02183504e2708ac3e446f29003c8d7bc/67170/hacked.webp 744w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.4206989247311828}},"base":"hacked.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/cd56be61925d779c9a23f9ecdea56e09/fb68f/login.png","srcSet":"/js2/static/cd56be61925d779c9a23f9ecdea56e09/e56fa/login.png 750w,\n/js2/static/cd56be61925d779c9a23f9ecdea56e09/fb68f/login.png 879w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/cd56be61925d779c9a23f9ecdea56e09/5510b/login.webp 750w,\n/js2/static/cd56be61925d779c9a23f9ecdea56e09/da356/login.webp 879w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5017064846416383}},"base":"login.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/df999928d139b76e4624212deb47afa1/c60dc/ajax.png","srcSet":"/js2/static/df999928d139b76e4624212deb47afa1/c60dc/ajax.png 569w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/df999928d139b76e4624212deb47afa1/9f538/ajax.webp 569w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.8927943760984183}},"base":"ajax.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/6b82e2d24f2e455ab5f6479f8f0fd34c/718a6/cors-issue.png","srcSet":"/js2/static/6b82e2d24f2e455ab5f6479f8f0fd34c/3b3b8/cors-issue.png 750w,\n/js2/static/6b82e2d24f2e455ab5f6479f8f0fd34c/718a6/cors-issue.png 1031w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/6b82e2d24f2e455ab5f6479f8f0fd34c/148ba/cors-issue.webp 750w,\n/js2/static/6b82e2d24f2e455ab5f6479f8f0fd34c/53c8e/cors-issue.webp 1031w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.29582929194956353}},"base":"cors-issue.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/11b64c3a36326f1301636f365163fa87/487a4/carousel.png","srcSet":"/js2/static/11b64c3a36326f1301636f365163fa87/8d835/carousel.png 750w,\n/js2/static/11b64c3a36326f1301636f365163fa87/9b397/carousel.png 1080w,\n/js2/static/11b64c3a36326f1301636f365163fa87/c1308/carousel.png 1366w,\n/js2/static/11b64c3a36326f1301636f365163fa87/487a4/carousel.png 1599w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/11b64c3a36326f1301636f365163fa87/25f33/carousel.webp 750w,\n/js2/static/11b64c3a36326f1301636f365163fa87/f7d3e/carousel.webp 1080w,\n/js2/static/11b64c3a36326f1301636f365163fa87/cab24/carousel.webp 1366w,\n/js2/static/11b64c3a36326f1301636f365163fa87/e838a/carousel.webp 1599w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.35709818636647905}},"base":"carousel.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8e8e8","images":{"fallback":{"src":"/js2/static/cd7a86517cd86bf67e97a9455782f61e/3a7c2/errors.png","srcSet":"/js2/static/cd7a86517cd86bf67e97a9455782f61e/3a7c2/errors.png 589w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/cd7a86517cd86bf67e97a9455782f61e/8d14e/errors.webp 589w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.43803056027164683}},"base":"errors.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#080808","images":{"fallback":{"src":"/js2/static/e795fd2fb63aea24f1a6ec7e3b46dc57/b749b/JSdude.png","srcSet":"/js2/static/e795fd2fb63aea24f1a6ec7e3b46dc57/27b15/JSdude.png 750w,\n/js2/static/e795fd2fb63aea24f1a6ec7e3b46dc57/b749b/JSdude.png 1024w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/e795fd2fb63aea24f1a6ec7e3b46dc57/cfe1c/JSdude.webp 750w,\n/js2/static/e795fd2fb63aea24f1a6ec7e3b46dc57/5e515/JSdude.webp 1024w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}},"base":"JSdude.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/368b66a6c71ce7ae5149f7fe124c67b4/dedcf/independentFrontBackSPA.png","srcSet":"/js2/static/368b66a6c71ce7ae5149f7fe124c67b4/aa4e8/independentFrontBackSPA.png 750w,\n/js2/static/368b66a6c71ce7ae5149f7fe124c67b4/dedcf/independentFrontBackSPA.png 914w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/368b66a6c71ce7ae5149f7fe124c67b4/54e6a/independentFrontBackSPA.webp 750w,\n/js2/static/368b66a6c71ce7ae5149f7fe124c67b4/d4860/independentFrontBackSPA.webp 914w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.48468271334792123}},"base":"independentFrontBackSPA.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/5033887241592124140462a48f880b31/4c60e/independentFrontBackSPA2.png","srcSet":"/js2/static/5033887241592124140462a48f880b31/57832/independentFrontBackSPA2.png 750w,\n/js2/static/5033887241592124140462a48f880b31/4c60e/independentFrontBackSPA2.png 852w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/5033887241592124140462a48f880b31/73ed4/independentFrontBackSPA2.webp 750w,\n/js2/static/5033887241592124140462a48f880b31/fa338/independentFrontBackSPA2.webp 852w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5762910798122066}},"base":"independentFrontBackSPA2.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/a0a9be40f52062756989e43e359b5c44/4ca31/liveServerFrontSPA.png","srcSet":"/js2/static/a0a9be40f52062756989e43e359b5c44/96859/liveServerFrontSPA.png 750w,\n/js2/static/a0a9be40f52062756989e43e359b5c44/4ca31/liveServerFrontSPA.png 751w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/a0a9be40f52062756989e43e359b5c44/3f918/liveServerFrontSPA.webp 750w,\n/js2/static/a0a9be40f52062756989e43e359b5c44/61905/liveServerFrontSPA.webp 751w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.4274300932090546}},"base":"liveServerFrontSPA.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/4cf8132263a3922a81198d62fa668e8c/8af70/monolithicSPA.png","srcSet":"/js2/static/4cf8132263a3922a81198d62fa668e8c/9fdee/monolithicSPA.png 750w,\n/js2/static/4cf8132263a3922a81198d62fa668e8c/8af70/monolithicSPA.png 758w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/4cf8132263a3922a81198d62fa668e8c/e02a2/monolithicSPA.webp 750w,\n/js2/static/4cf8132263a3922a81198d62fa668e8c/1677e/monolithicSPA.webp 758w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.712401055408971}},"base":"monolithicSPA.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/9482be8bcc11374b223c4bff1aaa7cef/6c4d1/movies.png","srcSet":"/js2/static/9482be8bcc11374b223c4bff1aaa7cef/44ede/movies.png 750w,\n/js2/static/9482be8bcc11374b223c4bff1aaa7cef/c97ea/movies.png 1080w,\n/js2/static/9482be8bcc11374b223c4bff1aaa7cef/6c4d1/movies.png 1268w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/9482be8bcc11374b223c4bff1aaa7cef/9378c/movies.webp 750w,\n/js2/static/9482be8bcc11374b223c4bff1aaa7cef/6e0c3/movies.webp 1080w,\n/js2/static/9482be8bcc11374b223c4bff1aaa7cef/498dd/movies.webp 1268w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.38564668769716093}},"base":"movies.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/945336ab536627610c9e7fa03999caa2/746ba/proxy.png","srcSet":"/js2/static/945336ab536627610c9e7fa03999caa2/746ba/proxy.png 691w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/945336ab536627610c9e7fa03999caa2/03d38/proxy.webp 691w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6353111432706222}},"base":"proxy.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/04662f2f0ed1b78bd5ead2c3dec85482/36714/readPizzas.png","srcSet":"/js2/static/04662f2f0ed1b78bd5ead2c3dec85482/36714/readPizzas.png 523w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/04662f2f0ed1b78bd5ead2c3dec85482/dfd8f/readPizzas.webp 523w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.7304015296367113}},"base":"readPizzas.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/8eb2b12643e10670a4e4234ccd8a844e/3d704/xss.png","srcSet":"/js2/static/8eb2b12643e10670a4e4234ccd8a844e/613e6/xss.png 750w,\n/js2/static/8eb2b12643e10670a4e4234ccd8a844e/103d4/xss.png 1080w,\n/js2/static/8eb2b12643e10670a4e4234ccd8a844e/3d704/xss.png 1108w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/8eb2b12643e10670a4e4234ccd8a844e/18c9f/xss.webp 750w,\n/js2/static/8eb2b12643e10670a4e4234ccd8a844e/51d3a/xss.webp 1080w,\n/js2/static/8eb2b12643e10670a4e4234ccd8a844e/88976/xss.webp 1108w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.2842960288808664}},"base":"xss.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#080808","images":{"fallback":{"src":"/js2/static/14110746b5f49459429c355815cd77b3/10f52/express-flow.png","srcSet":"/js2/static/14110746b5f49459429c355815cd77b3/eb8cd/express-flow.png 750w,\n/js2/static/14110746b5f49459429c355815cd77b3/10f52/express-flow.png 800w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/14110746b5f49459429c355815cd77b3/4e646/express-flow.webp 750w,\n/js2/static/14110746b5f49459429c355815cd77b3/130b6/express-flow.webp 800w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.3825}},"base":"express-flow.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/8c454120ed3743524b977a50efee14ae/75d45/architecture.png","srcSet":"/js2/static/8c454120ed3743524b977a50efee14ae/c33b9/architecture.png 750w,\n/js2/static/8c454120ed3743524b977a50efee14ae/75d45/architecture.png 859w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/8c454120ed3743524b977a50efee14ae/013ea/architecture.webp 750w,\n/js2/static/8c454120ed3743524b977a50efee14ae/3c3f0/architecture.webp 859w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6030267753201397}},"base":"architecture.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#c8e8d8","images":{"fallback":{"src":"/js2/static/5c1c4cd476b1911739976c74d5457e03/60e67/middlewares.jpg","srcSet":"/js2/static/5c1c4cd476b1911739976c74d5457e03/60e67/middlewares.jpg 638w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/5c1c4cd476b1911739976c74d5457e03/f273c/middlewares.webp 638w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.7288401253918495}},"base":"middlewares.jpg"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/ff2054d2907d5ebd494875c12fe16a3d/d40cb/middleware-function.png","srcSet":"/js2/static/ff2054d2907d5ebd494875c12fe16a3d/7cb90/middleware-function.png 750w,\n/js2/static/ff2054d2907d5ebd494875c12fe16a3d/d40cb/middleware-function.png 944w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/ff2054d2907d5ebd494875c12fe16a3d/4ffb0/middleware-function.webp 750w,\n/js2/static/ff2054d2907d5ebd494875c12fe16a3d/6c417/middleware-function.webp 944w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.298728813559322}},"base":"middleware-function.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/4af4b8ccca63d0a981c68a20bb9658e1/cc4c8/techno-course.png","srcSet":"/js2/static/4af4b8ccca63d0a981c68a20bb9658e1/cc4c8/techno-course.png 721w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/4af4b8ccca63d0a981c68a20bb9658e1/7f7c1/techno-course.webp 721w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5575589459084604}},"base":"techno-course.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/dbf7fef0d0623475d157204fd950008e/cbf92/techno.png","srcSet":"/js2/static/dbf7fef0d0623475d157204fd950008e/cbf92/techno.png 586w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/dbf7fef0d0623475d157204fd950008e/09c5a/techno.webp 586w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.8464163822525598}},"base":"techno.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/a4d45cc8f767378935f1a47c6a814bff/c4448/table.png","srcSet":"/js2/static/a4d45cc8f767378935f1a47c6a814bff/c4448/table.png 219w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/a4d45cc8f767378935f1a47c6a814bff/5ce26/table.webp 219w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.547945205479452}},"base":"table.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#282828","images":{"fallback":{"src":"/js2/static/995b19933afe2efc8abdad9e056f7eb0/c35a8/terminal-1.png","srcSet":"/js2/static/995b19933afe2efc8abdad9e056f7eb0/c35a8/terminal-1.png 481w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/995b19933afe2efc8abdad9e056f7eb0/8a064/terminal-1.webp 481w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.2390852390852392}},"base":"terminal-1.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#181818","images":{"fallback":{"src":"/js2/static/ec94e10b96163ba7dff989c8073526c9/e4d4e/terminal-2.png","srcSet":"/js2/static/ec94e10b96163ba7dff989c8073526c9/d328f/terminal-2.png 750w,\n/js2/static/ec94e10b96163ba7dff989c8073526c9/e4d4e/terminal-2.png 933w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/ec94e10b96163ba7dff989c8073526c9/dea86/terminal-2.webp 750w,\n/js2/static/ec94e10b96163ba7dff989c8073526c9/92d06/terminal-2.webp 933w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.2722400857449089}},"base":"terminal-2.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/593d65b45ead31d08b777b977530fbb0/257c8/form.png","srcSet":"/js2/static/593d65b45ead31d08b777b977530fbb0/257c8/form.png 182w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/593d65b45ead31d08b777b977530fbb0/aa09a/form.webp 182w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.1868131868131868}},"base":"form.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/d5538808d9455e309732cc72d3c16094/5a8ae/bom.png","srcSet":"/js2/static/d5538808d9455e309732cc72d3c16094/5a8ae/bom.png 361w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/d5538808d9455e309732cc72d3c16094/44051/bom.webp 361w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.8531855955678671}},"base":"bom.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#080808","images":{"fallback":{"src":"/js2/static/bb50b3e7a8b2a2cd37a9f3e8139a8d34/05d72/browser.png","srcSet":"/js2/static/bb50b3e7a8b2a2cd37a9f3e8139a8d34/e81f3/browser.png 750w,\n/js2/static/bb50b3e7a8b2a2cd37a9f3e8139a8d34/05d72/browser.png 815w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/bb50b3e7a8b2a2cd37a9f3e8139a8d34/7c1ed/browser.webp 750w,\n/js2/static/bb50b3e7a8b2a2cd37a9f3e8139a8d34/9c789/browser.webp 815w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6269938650306749}},"base":"browser.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/815bb84493b798e20f6e050fe7d4f297/8ac59/bytes.heif","srcSet":"/js2/static/815bb84493b798e20f6e050fe7d4f297/8ac59/bytes.heif 730w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/815bb84493b798e20f6e050fe7d4f297/fa94f/bytes.webp 730w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.8041095890410959}},"base":"bytes.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#181818","images":{"fallback":{"src":"/js2/static/a2704f93c050f1b8f0af184bca0784e5/bfbd8/copy.png","srcSet":"/js2/static/a2704f93c050f1b8f0af184bca0784e5/bfbd8/copy.png 41w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/a2704f93c050f1b8f0af184bca0784e5/54421/copy.webp 41w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.048780487804878}},"base":"copy.PNG"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/7c8ef3e05614d0f1331eb1622972209f/ad8b1/dom.heif","srcSet":"/js2/static/7c8ef3e05614d0f1331eb1622972209f/ad8b1/dom.heif 730w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/7c8ef3e05614d0f1331eb1622972209f/4fc4f/dom.webp 730w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.3136986301369863}},"base":"dom.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/20e0138ec54042c9ab8df2df718b51c7/ad8b1/cssom.heif","srcSet":"/js2/static/20e0138ec54042c9ab8df2df718b51c7/ad8b1/cssom.heif 730w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/20e0138ec54042c9ab8df2df718b51c7/4fc4f/cssom.webp 730w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.3136986301369863}},"base":"cssom.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/8336698fa5a4150652bf24675d81d450/b818d/console.png","srcSet":"/js2/static/8336698fa5a4150652bf24675d81d450/b818d/console.png 584w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/8336698fa5a4150652bf24675d81d450/2cd0a/console.webp 584w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5941780821917808}},"base":"console.PNG"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/2c0e805dbcef0b4210fddd87f2fdcd0b/7d9c5/dom2.gif","srcSet":"/js2/static/2c0e805dbcef0b4210fddd87f2fdcd0b/7d9c5/dom2.gif 486w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/2c0e805dbcef0b4210fddd87f2fdcd0b/3b54a/dom2.webp 486w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5473251028806584}},"base":"dom2.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8d818","images":{"fallback":{"src":"/js2/static/9816a79b1cdedb4fd200ae4b1e94ccbd/efde9/js-logo.png","srcSet":"/js2/static/9816a79b1cdedb4fd200ae4b1e94ccbd/27b15/js-logo.png 750w,\n/js2/static/9816a79b1cdedb4fd200ae4b1e94ccbd/efde9/js-logo.png 768w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/9816a79b1cdedb4fd200ae4b1e94ccbd/cfe1c/js-logo.webp 750w,\n/js2/static/9816a79b1cdedb4fd200ae4b1e94ccbd/ea3b7/js-logo.webp 768w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}},"base":"js-logo.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/283b4c657f5c4a706c3e29d0a08fd451/7edf3/render.heif","srcSet":"/js2/static/283b4c657f5c4a706c3e29d0a08fd451/7edf3/render.heif 730w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/283b4c657f5c4a706c3e29d0a08fd451/29aef/render.webp 730w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.4383561643835616}},"base":"render.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#282828","images":{"fallback":{"src":"/js2/static/302e83d40f9486ab7ea528e217821223/d5cd3/start.png","srcSet":"/js2/static/302e83d40f9486ab7ea528e217821223/d5cd3/start.png 511w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/302e83d40f9486ab7ea528e217821223/02192/start.webp 511w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.40117416829745595}},"base":"start.PNG"}},{"node":{"childImageSharp":null,"base":"red-light.gif"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#d88848","images":{"fallback":{"src":"/js2/static/c4a1984e0b0ce60b9f9f72756293a96e/50940/frontend-technos.jpg","srcSet":"/js2/static/c4a1984e0b0ce60b9f9f72756293a96e/50940/frontend-technos.jpg 461w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/c4a1984e0b0ce60b9f9f72756293a96e/9d85c/frontend-technos.webp 461w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5553145336225597}},"base":"frontend-technos.jpg"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/4231407aeb2eab1eb26748522a49f119/1daa6/js-evolution.png","srcSet":"/js2/static/4231407aeb2eab1eb26748522a49f119/1daa6/js-evolution.png 505w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/4231407aeb2eab1eb26748522a49f119/1d9c9/js-evolution.webp 505w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.3702970297029703}},"base":"js-evolution.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#a8c888","images":{"fallback":{"src":"/js2/static/62895fac28825996f4895ee798c3c5da/964cf/modules-breakdown.png","srcSet":"/js2/static/62895fac28825996f4895ee798c3c5da/ddebf/modules-breakdown.png 750w,\n/js2/static/62895fac28825996f4895ee798c3c5da/964cf/modules-breakdown.png 1056w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/62895fac28825996f4895ee798c3c5da/f59f5/modules-breakdown.webp 750w,\n/js2/static/62895fac28825996f4895ee798c3c5da/280c1/modules-breakdown.webp 1056w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.3759469696969697}},"base":"modules-breakdown.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#283848","images":{"fallback":{"src":"/js2/static/79637217dd57af31bd8a8860191ab8d8/dbdf5/most-pop-programming.png","srcSet":"/js2/static/79637217dd57af31bd8a8860191ab8d8/dbdf5/most-pop-programming.png 715w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/79637217dd57af31bd8a8860191ab8d8/349ed/most-pop-programming.webp 715w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.8139860139860139}},"base":"most-pop-programming.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#080808","images":{"fallback":{"src":"/js2/static/fa47b7868326f417638155af9c4e1131/a19b7/mpa-api.png","srcSet":"/js2/static/fa47b7868326f417638155af9c4e1131/1f5ea/mpa-api.png 750w,\n/js2/static/fa47b7868326f417638155af9c4e1131/a19b7/mpa-api.png 847w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/fa47b7868326f417638155af9c4e1131/98a4a/mpa-api.webp 750w,\n/js2/static/fa47b7868326f417638155af9c4e1131/b3688/mpa-api.webp 847w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.4628099173553719}},"base":"mpa-api.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/df3eb96d3792fedc90e824b9ff4ee666/9aa96/spa-monolithic.png","srcSet":"/js2/static/df3eb96d3792fedc90e824b9ff4ee666/9aa96/spa-monolithic.png 541w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/df3eb96d3792fedc90e824b9ff4ee666/65253/spa-monolithic.webp 541w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.7245841035120149}},"base":"spa-monolithic.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#080808","images":{"fallback":{"src":"/js2/static/0db4cabf70d03ffdaba26ad2279a1f03/36fe5/mpa.png","srcSet":"/js2/static/0db4cabf70d03ffdaba26ad2279a1f03/36fe5/mpa.png 540w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/0db4cabf70d03ffdaba26ad2279a1f03/94f16/mpa.webp 540w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.7259259259259259}},"base":"mpa.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/e927b7d4c1aab1dd521632761a53f1b6/a19b7/spa.png","srcSet":"/js2/static/e927b7d4c1aab1dd521632761a53f1b6/1f5ea/spa.png 750w,\n/js2/static/e927b7d4c1aab1dd521632761a53f1b6/a19b7/spa.png 847w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/e927b7d4c1aab1dd521632761a53f1b6/98a4a/spa.webp 750w,\n/js2/static/e927b7d4c1aab1dd521632761a53f1b6/b3688/spa.webp 847w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.4628099173553719}},"base":"spa.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#283848","images":{"fallback":{"src":"/js2/static/633de32074a1d0717540f1ac88bb3e95/dbdf5/web-frameworks.png","srcSet":"/js2/static/633de32074a1d0717540f1ac88bb3e95/dbdf5/web-frameworks.png 715w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/633de32074a1d0717540f1ac88bb3e95/349ed/web-frameworks.webp 715w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.8139860139860139}},"base":"web-frameworks.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#484848","images":{"fallback":{"src":"/js2/static/d500a235cf91fee0cec65a112a3fd9a8/a166b/backend-frameworks.png","srcSet":"/js2/static/d500a235cf91fee0cec65a112a3fd9a8/a166b/backend-frameworks.png 634w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/d500a235cf91fee0cec65a112a3fd9a8/de393/backend-frameworks.webp 634w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5394321766561514}},"base":"backend-frameworks.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/97447aabc0c3f79a34494e5fa4b0b55d/cd171/planning.png","srcSet":"/js2/static/97447aabc0c3f79a34494e5fa4b0b55d/08018/planning.png 750w,\n/js2/static/97447aabc0c3f79a34494e5fa4b0b55d/b5d65/planning.png 1080w,\n/js2/static/97447aabc0c3f79a34494e5fa4b0b55d/cd171/planning.png 1088w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/97447aabc0c3f79a34494e5fa4b0b55d/f7070/planning.webp 750w,\n/js2/static/97447aabc0c3f79a34494e5fa4b0b55d/6949f/planning.webp 1080w,\n/js2/static/97447aabc0c3f79a34494e5fa4b0b55d/9af3a/planning.webp 1088w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.59375}},"base":"planning.PNG"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/9f49136562a5d771c51d7600430566b1/38d9f/eventflow.png","srcSet":"/js2/static/9f49136562a5d771c51d7600430566b1/38d9f/eventflow.png 480w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/9f49136562a5d771c51d7600430566b1/cd74b/eventflow.webp 480w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.1666666666666667}},"base":"eventflow.png"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/js2/static/852194cf7727296de1adabc80b737b1d/52ccc/critere-eval.jpg","srcSet":"/js2/static/852194cf7727296de1adabc80b737b1d/24844/critere-eval.jpg 750w,\n/js2/static/852194cf7727296de1adabc80b737b1d/52ccc/critere-eval.jpg 844w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/852194cf7727296de1adabc80b737b1d/ba934/critere-eval.webp 750w,\n/js2/static/852194cf7727296de1adabc80b737b1d/f361e/critere-eval.webp 844w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.2890995260663507}},"base":"critere-eval.jpg"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/js2/static/d0eb9efdef86cf105b8020519b702c01/f6ece/pizza2.jpg","srcSet":"/js2/static/d0eb9efdef86cf105b8020519b702c01/e1af2/pizza2.jpg 750w,\n/js2/static/d0eb9efdef86cf105b8020519b702c01/f6ece/pizza2.jpg 800w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/d0eb9efdef86cf105b8020519b702c01/7f694/pizza2.webp 750w,\n/js2/static/d0eb9efdef86cf105b8020519b702c01/4447d/pizza2.webp 800w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6675}},"base":"pizza2.jpg"}},{"node":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#d8d8e8","images":{"fallback":{"src":"/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/87754/pizza.jpg","srcSet":"/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/b3dd7/pizza.jpg 750w,\n/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/870fe/pizza.jpg 1080w,\n/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/f640e/pizza.jpg 1366w,\n/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/87754/pizza.jpg 1920w","sizes":"100vw"},"sources":[{"srcSet":"/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/2daa0/pizza.webp 750w,\n/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/1aa4f/pizza.webp 1080w,\n/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/8647b/pizza.webp 1366w,\n/js2/static/b1265c3e6f56ce4944170b2dd149f5c7/902b5/pizza.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.5}},"base":"pizza.jpg"}}]}},"pageContext":{"slug":"/part3/auths-api/","frontmatter":{"title":"JWT auths API & bcrypt","description":"S√©curisation d'une RESTful API : Authentification et autorisation d'acc√®s aux op√©rations d'une RESTful API via JWT & bcrypt"}}},"staticQueryHashes":["1696221415","2461182183","3028011774","3458129946","501654901","575455071"],"slicesMap":{}}